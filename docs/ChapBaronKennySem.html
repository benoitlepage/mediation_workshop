<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Baron and Kenny, structural equation models | Mediation Workshop</title>
  <meta name="description" content="Expanse project - Mediation workshop. Online complementary document with practical examples in R." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Baron and Kenny, structural equation models | Mediation Workshop" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Expanse project - Mediation workshop. Online complementary document with practical examples in R." />
  <meta name="github-repo" content="mediation_workshop" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Baron and Kenny, structural equation models | Mediation Workshop" />
  
  <meta name="twitter:description" content="Expanse project - Mediation workshop. Online complementary document with practical examples in R." />
  

<meta name="author" content="BenoÃ®t Lepage" />


<meta name="date" content="2024-10-17" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-sets.html"/>
<link rel="next" href="ChapTradRegModels.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Mediation workshop</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="software.html"><a href="software.html"><i class="fa fa-check"></i><b>2</b> Software</a></li>
<li class="chapter" data-level="3" data-path="data-sets.html"><a href="data-sets.html"><i class="fa fa-check"></i><b>3</b> Data sets</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-sets.html"><a href="data-sets.html#general-presentation-of-the-data-used-in-our-examples"><i class="fa fa-check"></i><b>3.1</b> General presentation of the data used in our examples</a></li>
<li class="chapter" data-level="3.2" data-path="data-sets.html"><a href="data-sets.html#data-generating-mechanisms"><i class="fa fa-check"></i><b>3.2</b> Data generating mechanisms</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ChapBaronKennySem.html"><a href="ChapBaronKennySem.html"><i class="fa fa-check"></i><b>4</b> Baron and Kenny, structural equation models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ChapBaronKennySem.html"><a href="ChapBaronKennySem.html#baron-and-kenny-approach"><i class="fa fa-check"></i><b>4.1</b> Baron and Kenny approach</a></li>
<li class="chapter" data-level="4.2" data-path="ChapBaronKennySem.html"><a href="ChapBaronKennySem.html#path-analysis-and-structural-equation-modeling"><i class="fa fa-check"></i><b>4.2</b> Path analysis and Structural Equation Modeling</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ChapBaronKennySem.html"><a href="ChapBaronKennySem.html#first-application-without-intermediate-confouding-affected-by-the-exposure"><i class="fa fa-check"></i><b>4.2.1</b> First application, without intermediate confouding affected by the exposure</a></li>
<li class="chapter" data-level="4.2.2" data-path="ChapBaronKennySem.html"><a href="ChapBaronKennySem.html#dealing-with-categorical-endogenous-variables"><i class="fa fa-check"></i><b>4.2.2</b> Dealing with categorical endogenous variables</a></li>
<li class="chapter" data-level="4.2.3" data-path="ChapBaronKennySem.html"><a href="ChapBaronKennySem.html#application-with-intermediate-confounding-affected-by-the-exposure"><i class="fa fa-check"></i><b>4.2.3</b> Application with intermediate confounding affected by the exposure</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ChapTradRegModels.html"><a href="ChapTradRegModels.html"><i class="fa fa-check"></i><b>5</b> Traditional regression models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ChapTradRegModels.html"><a href="ChapTradRegModels.html#estimation-of-the-average-total-effect-ate"><i class="fa fa-check"></i><b>5.1</b> Estimation of the Average Total Effect (ATE)</a></li>
<li class="chapter" data-level="5.2" data-path="ChapTradRegModels.html"><a href="ChapTradRegModels.html#trad2way"><i class="fa fa-check"></i><b>5.2</b> Two-way decomposition</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="ChapTradRegModels.html"><a href="ChapTradRegModels.html#trad2waycde"><i class="fa fa-check"></i><b>5.2.1</b> Controlled Direct Effect</a></li>
<li class="chapter" data-level="5.2.2" data-path="ChapTradRegModels.html"><a href="ChapTradRegModels.html#trad2waynatural"><i class="fa fa-check"></i><b>5.2.2</b> Natural Direct and Indirect effects</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="ChapTradRegModels.html"><a href="ChapTradRegModels.html#trad3way"><i class="fa fa-check"></i><b>5.3</b> Three-way decomposition</a></li>
<li class="chapter" data-level="5.4" data-path="ChapTradRegModels.html"><a href="ChapTradRegModels.html#four-way-decomposition"><i class="fa fa-check"></i><b>5.4</b> Four-way decomposition</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ChapGcomp.html"><a href="ChapGcomp.html"><i class="fa fa-check"></i><b>6</b> G-computation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ChapGcomp.html"><a href="ChapGcomp.html#estimation-of-the-average-total-effect-ate-1"><i class="fa fa-check"></i><b>6.1</b> Estimation of the Average Total Effect (ATE)</a></li>
<li class="chapter" data-level="6.2" data-path="ChapGcomp.html"><a href="ChapGcomp.html#estimation-of-controlled-direct-effects-cde"><i class="fa fa-check"></i><b>6.2</b> Estimation of Controlled Direct Effects (CDE)</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="ChapGcomp.html"><a href="ChapGcomp.html#ChapGcomp-CDE-param"><i class="fa fa-check"></i><b>6.2.1</b> Parametric g-computation</a></li>
<li class="chapter" data-level="6.2.2" data-path="ChapGcomp.html"><a href="ChapGcomp.html#ChapGcomp-CDE-ICE"><i class="fa fa-check"></i><b>6.2.2</b> G-computation by iterative conditional expectation</a></li>
<li class="chapter" data-level="6.2.3" data-path="ChapGcomp.html"><a href="ChapGcomp.html#sequential-g-estimator"><i class="fa fa-check"></i><b>6.2.3</b> Sequential g-estimator</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ChapGcomp.html"><a href="ChapGcomp.html#estimation-of-natural-direct-nde-and-indirect-effects-nie"><i class="fa fa-check"></i><b>6.3</b> Estimation of Natural Direct (NDE) and Indirect Effects (NIE)</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="ChapGcomp.html"><a href="ChapGcomp.html#simple-plug-in-estimator"><i class="fa fa-check"></i><b>6.3.1</b> Simple âplug-inâ estimator</a></li>
<li class="chapter" data-level="6.3.2" data-path="ChapGcomp.html"><a href="ChapGcomp.html#using-the-mediation-r-package"><i class="fa fa-check"></i><b>6.3.2</b> Using the <code>mediation</code> R package</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="ChapGcomp.html"><a href="ChapGcomp.html#estimation-of-marginal-randomizedinterventional-natural-direct-mrde-and-indirect-effects-mrie"><i class="fa fa-check"></i><b>6.4</b> Estimation of âMarginalâ Randomized/Interventional Natural Direct (MRDE) and Indirect Effects (MRIE)</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="ChapGcomp.html"><a href="ChapGcomp.html#parametric-g-computation"><i class="fa fa-check"></i><b>6.4.1</b> Parametric g-computation</a></li>
<li class="chapter" data-level="6.4.2" data-path="ChapGcomp.html"><a href="ChapGcomp.html#g-computation-by-iterative-conditional-expectation"><i class="fa fa-check"></i><b>6.4.2</b> G-computation by iterative conditional expectation</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="ChapGcomp.html"><a href="ChapGcomp.html#using-the-cmaverse-package-for-2-way-3-way-and-4-way-decomposition"><i class="fa fa-check"></i><b>6.5</b> Using the <code>CMAverse</code> package for 2-way, 3-way and 4-way decomposition</a></li>
<li class="chapter" data-level="6.6" data-path="ChapGcomp.html"><a href="ChapGcomp.html#estimation-of-conditional-randomizedinterventional-natural-direct-crde-and-indirect-effects-crie"><i class="fa fa-check"></i><b>6.6</b> Estimation of âConditionalâ Randomized/Interventional Natural Direct (CRDE) and Indirect Effects (CRIE)</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="ChapGcomp.html"><a href="ChapGcomp.html#g-computation-by-iterative-conditional-expectation-simple-substitution-estimator"><i class="fa fa-check"></i><b>6.6.1</b> G-computation by iterative conditional expectation (simple substitution estimator)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ChapIptw.html"><a href="ChapIptw.html"><i class="fa fa-check"></i><b>7</b> Inverse Probability of Treatment Weighting (IPTW)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ChapIptw.html"><a href="ChapIptw.html#estimation-of-the-average-total-effect"><i class="fa fa-check"></i><b>7.1</b> Estimation of the Average total effect</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="ChapIptw.html"><a href="ChapIptw.html#iptw-for-the-ate"><i class="fa fa-check"></i><b>7.1.1</b> IPTW for the ATE</a></li>
<li class="chapter" data-level="7.1.2" data-path="ChapIptw.html"><a href="ChapIptw.html#stabilized-iptw-for-the-ate"><i class="fa fa-check"></i><b>7.1.2</b> Stabilized IPTW for the ATE</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ChapIptw.html"><a href="ChapIptw.html#estimation-of-the-controlled-direct-effect-cde"><i class="fa fa-check"></i><b>7.2</b> Estimation of the Controlled direct effect (CDE)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ChapIptw.html"><a href="ChapIptw.html#iptw-for-the-cde"><i class="fa fa-check"></i><b>7.2.1</b> IPTW for the CDE</a></li>
<li class="chapter" data-level="7.2.2" data-path="ChapIptw.html"><a href="ChapIptw.html#stabilized-iptw-for-the-cde"><i class="fa fa-check"></i><b>7.2.2</b> Stabilized IPTW for the CDE</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="ChapIptw.html"><a href="ChapIptw.html#estimation-of-conditional-randomizedinterventional-natural-direct-crde-and-indirect-effects-crie-1"><i class="fa fa-check"></i><b>7.3</b> Estimation of âConditionalâ Randomized/Interventional Natural Direct (CRDE) and Indirect Effects (CRIE)</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="ChapIptw.html"><a href="ChapIptw.html#iptw-for-the-crde-and-crie"><i class="fa fa-check"></i><b>7.3.1</b> IPTW for the CRDE and CRIE</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="msm_chapter.html"><a href="msm_chapter.html"><i class="fa fa-check"></i><b>8</b> Marginal structural models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="msm_chapter.html"><a href="msm_chapter.html#msm_ATE_paragraph"><i class="fa fa-check"></i><b>8.1</b> MSM for the Average Total Effect (ATE)</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="msm_chapter.html"><a href="msm_chapter.html#expressing-the-ate-using-coefficients-of-an-msm"><i class="fa fa-check"></i><b>8.1.1</b> Expressing the ATE using coefficients of an MSM</a></li>
<li class="chapter" data-level="8.1.2" data-path="msm_chapter.html"><a href="msm_chapter.html#estimation-of-the-msm-coefficients-by-iptw"><i class="fa fa-check"></i><b>8.1.2</b> Estimation of the MSM coefficients by IPTW</a></li>
<li class="chapter" data-level="8.1.3" data-path="msm_chapter.html"><a href="msm_chapter.html#estimation-of-the-msm-coefficients-by-g-computation-imputation"><i class="fa fa-check"></i><b>8.1.3</b> Estimation of the MSM coefficients by G-computation (imputation)</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="msm_chapter.html"><a href="msm_chapter.html#msm_CDE_paragraph"><i class="fa fa-check"></i><b>8.2</b> MSM for Controlled Direct Effects</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="msm_chapter.html"><a href="msm_chapter.html#expressing-the-cde-using-coefficients-of-an-msm"><i class="fa fa-check"></i><b>8.2.1</b> Expressing the CDE using coefficients of an MSM</a></li>
<li class="chapter" data-level="8.2.2" data-path="msm_chapter.html"><a href="msm_chapter.html#estimation-of-the-msm-coefficients-by-iptw-1"><i class="fa fa-check"></i><b>8.2.2</b> Estimation of the MSM coefficients by IPTW</a></li>
<li class="chapter" data-level="8.2.3" data-path="msm_chapter.html"><a href="msm_chapter.html#estimation-of-the-msm-coefficients-by-g-computation"><i class="fa fa-check"></i><b>8.2.3</b> Estimation of the MSM coefficients by G-computation</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="msm_chapter.html"><a href="msm_chapter.html#msm_NDE_NIE_paragraph"><i class="fa fa-check"></i><b>8.3</b> MSM for Natural Direct and Indirect Effects</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="msm_chapter.html"><a href="msm_chapter.html#expressing-the-nde-and-nie-using-coefficients-of-2-msms"><i class="fa fa-check"></i><b>8.3.1</b> Expressing the NDE and NIE using coefficients of 2 MSMs</a></li>
<li class="chapter" data-level="8.3.2" data-path="msm_chapter.html"><a href="msm_chapter.html#estimation-of-the-2-msms-coefficients-by-iptw-for-nde-and-nie"><i class="fa fa-check"></i><b>8.3.2</b> Estimation of the 2 MSMs coefficients by IPTW for NDE and NIE</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap_tmle.html"><a href="chap_tmle.html"><i class="fa fa-check"></i><b>9</b> Targeted Maximum Likelihood Estimation (TMLE)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chap_tmle.html"><a href="chap_tmle.html#tmle-for-the-ate"><i class="fa fa-check"></i><b>9.1</b> TMLE for the ATE</a></li>
<li class="chapter" data-level="9.2" data-path="chap_tmle.html"><a href="chap_tmle.html#tmle-of-the-controlled-direct-effect-cde"><i class="fa fa-check"></i><b>9.2</b> TMLE of the Controlled direct effect (CDE)</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="chap_tmle.html"><a href="chap_tmle.html#for-binary-outcomes"><i class="fa fa-check"></i><b>9.2.1</b> For binary outcomes</a></li>
<li class="chapter" data-level="9.2.2" data-path="chap_tmle.html"><a href="chap_tmle.html#for-continuous-outcomes"><i class="fa fa-check"></i><b>9.2.2</b> For continuous outcomes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="appendix_a.html"><a href="appendix_a.html"><i class="fa fa-check"></i><b>10</b> Appendix A: Data generating mechanisms</a>
<ul>
<li class="chapter" data-level="10.1" data-path="appendix_a.html"><a href="appendix_a.html#first-causal-model-data-generating-mechanism-without-mediator-outcome-confounder-affected-by-the-exposure"><i class="fa fa-check"></i><b>10.1</b> First causal model: Data generating mechanism without mediator-outcome confounder affected by the exposure</a></li>
<li class="chapter" data-level="10.2" data-path="appendix_a.html"><a href="appendix_a.html#second-causal-model-data-generating-mechanism-with-mediator-outcome-confounder-affected-by-the-exposure"><i class="fa fa-check"></i><b>10.2</b> Second causal model: Data generating mechanism with mediator-outcome confounder affected by the exposure</a></li>
<li class="chapter" data-level="10.3" data-path="appendix_a.html"><a href="appendix_a.html#simulation-of-the-four-data-sets-used-in-examples"><i class="fa fa-check"></i><b>10.3</b> Simulation of the four data sets used in examples</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="appendix_a.html"><a href="appendix_a.html#data-sets-generated-from-the-causal-model-1"><i class="fa fa-check"></i><b>10.3.1</b> Data sets generated from the causal model 1</a></li>
<li class="chapter" data-level="10.3.2" data-path="appendix_a.html"><a href="appendix_a.html#data-sets-generated-from-the-causal-model-2"><i class="fa fa-check"></i><b>10.3.2</b> Data sets generated from the causal model 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="appendix_b.html"><a href="appendix_b.html"><i class="fa fa-check"></i><b>11</b> Appendix B: Calculation of the true causal quantities</a>
<ul>
<li class="chapter" data-level="11.1" data-path="appendix_b.html"><a href="appendix_b.html#true-causal-quantities-without-mediator-ouctome-confounder-affected-by-the-exposure"><i class="fa fa-check"></i><b>11.1</b> True causal quantities without mediator-ouctome confounder affected by the exposure</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="appendix_b.html"><a href="appendix_b.html#average-total-effects-ate"><i class="fa fa-check"></i><b>11.1.1</b> Average total effects (ATE)</a></li>
<li class="chapter" data-level="11.1.2" data-path="appendix_b.html"><a href="appendix_b.html#controlled-direct-effects-cde"><i class="fa fa-check"></i><b>11.1.2</b> Controlled direct effects (CDE)</a></li>
<li class="chapter" data-level="11.1.3" data-path="appendix_b.html"><a href="appendix_b.html#pure-natural-direct-effect-and-total-natural-indirect-effect"><i class="fa fa-check"></i><b>11.1.3</b> Pure natural direct effect and Total natural indirect effect</a></li>
<li class="chapter" data-level="11.1.4" data-path="appendix_b.html"><a href="appendix_b.html#total-natural-direct-effect-and-pure-natural-indirect-effect"><i class="fa fa-check"></i><b>11.1.4</b> Total natural direct effect and Pure natural indirect effect</a></li>
<li class="chapter" data-level="11.1.5" data-path="appendix_b.html"><a href="appendix_b.html#vanderweeles-3-way-decomposition"><i class="fa fa-check"></i><b>11.1.5</b> Vanderweeleâs 3-way decomposition</a></li>
<li class="chapter" data-level="11.1.6" data-path="appendix_b.html"><a href="appendix_b.html#vanderweeles-4-way-decomposition"><i class="fa fa-check"></i><b>11.1.6</b> Vanderweeleâs 4-way decomposition</a></li>
<li class="chapter" data-level="11.1.7" data-path="appendix_b.html"><a href="appendix_b.html#marginal-randomized-direct-and-indirect-effects"><i class="fa fa-check"></i><b>11.1.7</b> Marginal randomized direct and indirect effects</a></li>
<li class="chapter" data-level="11.1.8" data-path="appendix_b.html"><a href="appendix_b.html#conditional-randomized-direct-and-indirect-effects"><i class="fa fa-check"></i><b>11.1.8</b> Conditional randomized direct and indirect effects</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="appendix_b.html"><a href="appendix_b.html#true-causal-quantities-with-mediator-outcome-confounder-affected-by-the-exposure"><i class="fa fa-check"></i><b>11.2</b> True causal quantities with mediator-outcome confounder affected by the exposure</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="appendix_b.html"><a href="appendix_b.html#average-total-effects-ate-1"><i class="fa fa-check"></i><b>11.2.1</b> Average total effects (ATE)</a></li>
<li class="chapter" data-level="11.2.2" data-path="appendix_b.html"><a href="appendix_b.html#controlled-direct-effects-cde-1"><i class="fa fa-check"></i><b>11.2.2</b> Controlled direct effects (CDE)</a></li>
<li class="chapter" data-level="11.2.3" data-path="appendix_b.html"><a href="appendix_b.html#marginal-randomized-direct-and-indirect-effects-1"><i class="fa fa-check"></i><b>11.2.3</b> Marginal randomized direct and indirect effects</a></li>
<li class="chapter" data-level="11.2.4" data-path="appendix_b.html"><a href="appendix_b.html#conditional-randomized-direct-and-indirect-effects-1"><i class="fa fa-check"></i><b>11.2.4</b> Conditional randomized direct and indirect effects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mediation Workshop</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ChapBaronKennySem" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Baron and Kenny, structural equation models<a href="ChapBaronKennySem.html#ChapBaronKennySem" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The Baron and Kenny approach can be applied if we make the assumption that no confounder of the <span class="math inline">\(M \rightarrow Y\)</span> relationship is affected by the exposure <span class="math inline">\(A\)</span>. As a consequence we will use the <code>df1.csv</code> data set simulated from the Causal model 1 (Figure <a href="data-sets.html#fig:figDAGM1">3.1</a>). We will also assume that there is no <span class="math inline">\(A \ast M\)</span> interaction effect on the outcome <span class="math inline">\(Y\)</span> in the following examples. Such interaction effects can be dealt with using traditional regression models in very similar approaches described in chapter <a href="ChapTradRegModels.html#ChapTradRegModels">5</a>.</p>
<div id="baron-and-kenny-approach" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Baron and Kenny approach<a href="ChapBaronKennySem.html#baron-and-kenny-approach" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The Baron &amp; Kenny approach relies on sequential and step-wise estimation of linear regression models:</p>
<ul>
<li>A model for the total effect of the exposure <span class="math inline">\(A\)</span> on the outcome <span class="math inline">\(Y\)</span> (conditional on baseline confounders <span class="math inline">\(L(0)\)</span>)</li>
</ul>
<p><span class="math display">\[\begin{equation*}
    \mathbb{E}(Y \mid A,L(0)) = \theta_0 + \theta_A A + \theta_{L(0)} L(0)
  \end{equation*}\]</span></p>
<ul>
<li>A model to test if the exposure <span class="math inline">\(A\)</span> has an effect on the mediator <span class="math inline">\(M\)</span> (conditional on baseline confounders <span class="math inline">\(L(0)\)</span> of the <span class="math inline">\(A-M\)</span> relationship)</li>
</ul>
<p><span class="math display">\[\begin{equation*}
    \mathbb{E}(M \mid A,L(0)) = \beta_0 + \beta_A A + \beta_{L(0)} L(0)
  \end{equation*}\]</span></p>
<ul>
<li>A model to estimate the direct effect of the exposure <span class="math inline">\(A\)</span> on the outcome <span class="math inline">\(Y\)</span> as well as the effect of the mediator <span class="math inline">\(M\)</span> on the outcome, adjusted for baseline confounders <span class="math inline">\(L(0)\)</span> and confounders of the <span class="math inline">\(M-Y\)</span> relationship <span class="math inline">\(L(1)\)</span></li>
</ul>
<p><span class="math display">\[\begin{equation*}
    \mathbb{E}(Y \mid A,M,L(1),L(0)) = \gamma_0 + \gamma_A A + \gamma_M M + \gamma_{L(0)} L(0) + \gamma_{L(1)} L(1)
  \end{equation*}\]</span></p>
<p>The total effect is given by the <span class="math inline">\(\theta_A\)</span> coefficient from the 1st model.</p>
<p>The direct effect is given by the <span class="math inline">\(\gamma_A\)</span> coefficient from the 3rd model.</p>
<p>The indirect effect can be calculated using:</p>
<ul>
<li>the âdifference in coefficientâ method based on the 1st and 3rd models: <span class="math inline">\(\theta_A - \gamma_A\)</span>,</li>
<li>or the âproduct of coefficientâ method based on the 2nd and 3rd models: <span class="math inline">\(\beta_A \times \gamma_M\)</span>.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="ChapBaronKennySem.html#cb1-1" tabindex="-1"></a><span class="do">## Import data </span></span>
<span id="cb1-2"><a href="ChapBaronKennySem.html#cb1-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span>
<span id="cb1-3"><a href="ChapBaronKennySem.html#cb1-3" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;./data/df1.csv&quot;</span>)</span>
<span id="cb1-4"><a href="ChapBaronKennySem.html#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="ChapBaronKennySem.html#cb1-5" tabindex="-1"></a><span class="do">## Model 1 to estimate the total effect:</span></span>
<span id="cb1-6"><a href="ChapBaronKennySem.html#cb1-6" tabindex="-1"></a>model.tot.A.QoL <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y_qol <span class="sc">~</span> A0_PM2<span class="fl">.5</span> <span class="sc">+</span> L0_male <span class="sc">+</span> L0_soc_env,</span>
<span id="cb1-7"><a href="ChapBaronKennySem.html#cb1-7" tabindex="-1"></a>                      <span class="at">data =</span> df1)</span>
<span id="cb1-8"><a href="ChapBaronKennySem.html#cb1-8" tabindex="-1"></a><span class="fu">summary</span>(model.tot.A.QoL)</span>
<span id="cb1-9"><a href="ChapBaronKennySem.html#cb1-9" tabindex="-1"></a><span class="co"># Coefficients:</span></span>
<span id="cb1-10"><a href="ChapBaronKennySem.html#cb1-10" tabindex="-1"></a><span class="co">#               Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb1-11"><a href="ChapBaronKennySem.html#cb1-11" tabindex="-1"></a><span class="co">#   (Intercept)  71.8820     0.2155 333.565  &lt; 2e-16 ***</span></span>
<span id="cb1-12"><a href="ChapBaronKennySem.html#cb1-12" tabindex="-1"></a><span class="co">#   A0_PM2.5     -5.0961     0.3486 -14.617  &lt; 2e-16 *** &lt;- Total effect</span></span>
<span id="cb1-13"><a href="ChapBaronKennySem.html#cb1-13" tabindex="-1"></a><span class="co">#   L0_male      -1.1486     0.2194  -5.235 1.68e-07 ***</span></span>
<span id="cb1-14"><a href="ChapBaronKennySem.html#cb1-14" tabindex="-1"></a><span class="co">#   L0_soc_env   -3.4441     0.2295 -15.005  &lt; 2e-16 ***</span></span>
<span id="cb1-15"><a href="ChapBaronKennySem.html#cb1-15" tabindex="-1"></a></span>
<span id="cb1-16"><a href="ChapBaronKennySem.html#cb1-16" tabindex="-1"></a><span class="co"># The total effect of being exposed to high levels of PM_2.5 on Quality of life</span></span>
<span id="cb1-17"><a href="ChapBaronKennySem.html#cb1-17" tabindex="-1"></a><span class="co"># is approximately equal to an average decrease of -5.1 on the QoL scale,</span></span>
<span id="cb1-18"><a href="ChapBaronKennySem.html#cb1-18" tabindex="-1"></a><span class="co"># given by the A0_PM2.5 coefficient:</span></span>
<span id="cb1-19"><a href="ChapBaronKennySem.html#cb1-19" tabindex="-1"></a>model.tot.A.QoL<span class="sc">$</span>coefficients[<span class="st">&quot;A0_PM2.5&quot;</span>]</span>
<span id="cb1-20"><a href="ChapBaronKennySem.html#cb1-20" tabindex="-1"></a><span class="co"># -5.096057</span></span>
<span id="cb1-21"><a href="ChapBaronKennySem.html#cb1-21" tabindex="-1"></a></span>
<span id="cb1-22"><a href="ChapBaronKennySem.html#cb1-22" tabindex="-1"></a><span class="do">## Model 2 to estimate the effect of the exposure on the mediator</span></span>
<span id="cb1-23"><a href="ChapBaronKennySem.html#cb1-23" tabindex="-1"></a><span class="do">## because the mediator is binary, we might want to use a logistic or probit regression</span></span>
<span id="cb1-24"><a href="ChapBaronKennySem.html#cb1-24" tabindex="-1"></a><span class="do">## for example</span></span>
<span id="cb1-25"><a href="ChapBaronKennySem.html#cb1-25" tabindex="-1"></a>logit.model.A.M <span class="ot">&lt;-</span> <span class="fu">glm</span>(M_diabetes <span class="sc">~</span> A0_PM2<span class="fl">.5</span> <span class="sc">+</span> L0_male <span class="sc">+</span> L0_soc_env,</span>
<span id="cb1-26"><a href="ChapBaronKennySem.html#cb1-26" tabindex="-1"></a>                       <span class="at">data =</span> df1, <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>)</span>
<span id="cb1-27"><a href="ChapBaronKennySem.html#cb1-27" tabindex="-1"></a><span class="fu">summary</span>(logit.model.A.M)</span>
<span id="cb1-28"><a href="ChapBaronKennySem.html#cb1-28" tabindex="-1"></a><span class="co"># effects estimated on the logit scale:</span></span>
<span id="cb1-29"><a href="ChapBaronKennySem.html#cb1-29" tabindex="-1"></a><span class="co"># Coefficients:</span></span>
<span id="cb1-30"><a href="ChapBaronKennySem.html#cb1-30" tabindex="-1"></a><span class="co">#                          Estimate Std. Error z value Pr(&gt;|z|)</span></span>
<span id="cb1-31"><a href="ChapBaronKennySem.html#cb1-31" tabindex="-1"></a><span class="co">#   (Intercept) -1.27152    0.04584 -27.736  &lt; 2e-16 ***</span></span>
<span id="cb1-32"><a href="ChapBaronKennySem.html#cb1-32" tabindex="-1"></a><span class="co">#   A0_PM2.5     0.56168    0.06537   8.592  &lt; 2e-16 *** &lt;- effect of A on M</span></span>
<span id="cb1-33"><a href="ChapBaronKennySem.html#cb1-33" tabindex="-1"></a><span class="co">#   L0_male      0.25455    0.04425   5.753 8.77e-09 ***</span></span>
<span id="cb1-34"><a href="ChapBaronKennySem.html#cb1-34" tabindex="-1"></a><span class="co">#   L0_soc_env   0.32683    0.04731   6.908 4.91e-12 ***</span></span>
<span id="cb1-35"><a href="ChapBaronKennySem.html#cb1-35" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">coefficients</span>(logit.model.A.M)[<span class="st">&quot;A0_PM2.5&quot;</span>])</span>
<span id="cb1-36"><a href="ChapBaronKennySem.html#cb1-36" tabindex="-1"></a><span class="co"># Odds ratio = 1.753609  for the effect of being exposed to high levels of PM_2.5</span></span>
<span id="cb1-37"><a href="ChapBaronKennySem.html#cb1-37" tabindex="-1"></a><span class="co"># on the mediator (probability of type 2 diabetes)</span></span>
<span id="cb1-38"><a href="ChapBaronKennySem.html#cb1-38" tabindex="-1"></a></span>
<span id="cb1-39"><a href="ChapBaronKennySem.html#cb1-39" tabindex="-1"></a><span class="do">## Model 3 to estimate the direct effect of the exposure (conditional on the outcome) and</span></span>
<span id="cb1-40"><a href="ChapBaronKennySem.html#cb1-40" tabindex="-1"></a><span class="do">## the effect of M on Y, adjusted for confounders of the A-Y and M-Y relationships</span></span>
<span id="cb1-41"><a href="ChapBaronKennySem.html#cb1-41" tabindex="-1"></a>model.A.M.QoL <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y_qol <span class="sc">~</span> A0_PM2<span class="fl">.5</span> <span class="sc">+</span> M_diabetes <span class="sc">+</span> L1 <span class="sc">+</span> L0_male <span class="sc">+</span> L0_soc_env,</span>
<span id="cb1-42"><a href="ChapBaronKennySem.html#cb1-42" tabindex="-1"></a>                    <span class="at">data =</span> df1)</span>
<span id="cb1-43"><a href="ChapBaronKennySem.html#cb1-43" tabindex="-1"></a><span class="fu">summary</span>(model.A.M.QoL)</span>
<span id="cb1-44"><a href="ChapBaronKennySem.html#cb1-44" tabindex="-1"></a><span class="co"># Coefficients:</span></span>
<span id="cb1-45"><a href="ChapBaronKennySem.html#cb1-45" tabindex="-1"></a><span class="co">#               Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb1-46"><a href="ChapBaronKennySem.html#cb1-46" tabindex="-1"></a><span class="co">#   (Intercept)  74.7858     0.2130 351.178  &lt; 2e-16 ***</span></span>
<span id="cb1-47"><a href="ChapBaronKennySem.html#cb1-47" tabindex="-1"></a><span class="co">#   A0_PM2.5     -3.9650     0.3212 -12.345  &lt; 2e-16 *** &lt;- Direct effect</span></span>
<span id="cb1-48"><a href="ChapBaronKennySem.html#cb1-48" tabindex="-1"></a><span class="co">#   M_diabetes   -8.7138     0.2221 -39.237  &lt; 2e-16 *** &lt;- effect of M on Y</span></span>
<span id="cb1-49"><a href="ChapBaronKennySem.html#cb1-49" tabindex="-1"></a><span class="co">#   L1           -3.4252     0.2212 -15.483  &lt; 2e-16 ***</span></span>
<span id="cb1-50"><a href="ChapBaronKennySem.html#cb1-50" tabindex="-1"></a><span class="co">#   L0_male      -0.7193     0.2017  -3.566 0.000364 ***</span></span>
<span id="cb1-51"><a href="ChapBaronKennySem.html#cb1-51" tabindex="-1"></a><span class="co">#   L0_soc_env   -2.8876     0.2112 -13.674  &lt; 2e-16 ***</span></span>
<span id="cb1-52"><a href="ChapBaronKennySem.html#cb1-52" tabindex="-1"></a></span>
<span id="cb1-53"><a href="ChapBaronKennySem.html#cb1-53" tabindex="-1"></a><span class="co"># The direct effect of PM_2.5 is approximately -4.0 given by the A0_PM2.5 coefficient</span></span>
<span id="cb1-54"><a href="ChapBaronKennySem.html#cb1-54" tabindex="-1"></a>model.A.M.QoL<span class="sc">$</span>coefficients[<span class="st">&quot;A0_PM2.5&quot;</span>]</span>
<span id="cb1-55"><a href="ChapBaronKennySem.html#cb1-55" tabindex="-1"></a><span class="co"># -3.965038</span></span>
<span id="cb1-56"><a href="ChapBaronKennySem.html#cb1-56" tabindex="-1"></a></span>
<span id="cb1-57"><a href="ChapBaronKennySem.html#cb1-57" tabindex="-1"></a><span class="do">## Following the Baron &amp; Kenny Steps, we would conclude that :</span></span>
<span id="cb1-58"><a href="ChapBaronKennySem.html#cb1-58" tabindex="-1"></a><span class="co"># - There is a significant total effect of PM_2.5 on Quality of Life (Model 1)</span></span>
<span id="cb1-59"><a href="ChapBaronKennySem.html#cb1-59" tabindex="-1"></a><span class="co"># - There is a significant effect of PM_2.5 on the mediator (diabetes) (Model 2)</span></span>
<span id="cb1-60"><a href="ChapBaronKennySem.html#cb1-60" tabindex="-1"></a><span class="co"># - There is a significant effect of the mediator (diabetes) on Qol (model 3)</span></span>
<span id="cb1-61"><a href="ChapBaronKennySem.html#cb1-61" tabindex="-1"></a><span class="co"># - The direct effect is significantly non-null</span></span>
<span id="cb1-62"><a href="ChapBaronKennySem.html#cb1-62" tabindex="-1"></a><span class="co"># =&gt; Conclusion: Diabetes partially mediates the relationship between PM_2.5 and QoL</span></span>
<span id="cb1-63"><a href="ChapBaronKennySem.html#cb1-63" tabindex="-1"></a></span>
<span id="cb1-64"><a href="ChapBaronKennySem.html#cb1-64" tabindex="-1"></a><span class="do">### Estimation of the indirect effect:</span></span>
<span id="cb1-65"><a href="ChapBaronKennySem.html#cb1-65" tabindex="-1"></a><span class="do">### We can apply the difference in coefficient method to estimate the indirect effect:</span></span>
<span id="cb1-66"><a href="ChapBaronKennySem.html#cb1-66" tabindex="-1"></a><span class="do">### substract the direct effect from the Total effect:</span></span>
<span id="cb1-67"><a href="ChapBaronKennySem.html#cb1-67" tabindex="-1"></a>ind.effect.dif.meth <span class="ot">&lt;-</span> (model.tot.A.QoL<span class="sc">$</span>coefficients[<span class="st">&quot;A0_PM2.5&quot;</span>] <span class="sc">-</span></span>
<span id="cb1-68"><a href="ChapBaronKennySem.html#cb1-68" tabindex="-1"></a>                          model.A.M.QoL<span class="sc">$</span>coefficients[<span class="st">&quot;A0_PM2.5&quot;</span>])</span>
<span id="cb1-69"><a href="ChapBaronKennySem.html#cb1-69" tabindex="-1"></a><span class="co"># -1.131019</span></span>
<span id="cb1-70"><a href="ChapBaronKennySem.html#cb1-70" tabindex="-1"></a><span class="co"># the indirect effect is approximately -1.1</span></span>
<span id="cb1-71"><a href="ChapBaronKennySem.html#cb1-71" tabindex="-1"></a><span class="co"># The confidence interval of the indirect effect can be computed by bootstrap.</span></span>
<span id="cb1-72"><a href="ChapBaronKennySem.html#cb1-72" tabindex="-1"></a></span>
<span id="cb1-73"><a href="ChapBaronKennySem.html#cb1-73" tabindex="-1"></a><span class="co"># Because the mediator is binary and we applied a logistic regression for Model 2,</span></span>
<span id="cb1-74"><a href="ChapBaronKennySem.html#cb1-74" tabindex="-1"></a><span class="co"># we cannot apply the product of coefficients combining a coefficient from</span></span>
<span id="cb1-75"><a href="ChapBaronKennySem.html#cb1-75" tabindex="-1"></a><span class="co"># Model 2 (logit scale) and from Model 3 (difference scale)</span></span>
<span id="cb1-76"><a href="ChapBaronKennySem.html#cb1-76" tabindex="-1"></a></span>
<span id="cb1-77"><a href="ChapBaronKennySem.html#cb1-77" tabindex="-1"></a><span class="do">### Model 2bis</span></span>
<span id="cb1-78"><a href="ChapBaronKennySem.html#cb1-78" tabindex="-1"></a><span class="co"># Surprisingly, another possibility is to run a linear model of the binary mediator</span></span>
<span id="cb1-79"><a href="ChapBaronKennySem.html#cb1-79" tabindex="-1"></a><span class="co"># instead of the logistic regression to apply the &quot;product of coefficient method&quot;</span></span>
<span id="cb1-80"><a href="ChapBaronKennySem.html#cb1-80" tabindex="-1"></a><span class="co"># in order to estimate the indirect effect:</span></span>
<span id="cb1-81"><a href="ChapBaronKennySem.html#cb1-81" tabindex="-1"></a>linear.model.A.M <span class="ot">&lt;-</span> <span class="fu">lm</span>(M_diabetes <span class="sc">~</span> A0_PM2<span class="fl">.5</span> <span class="sc">+</span> L0_male <span class="sc">+</span> L0_soc_env,</span>
<span id="cb1-82"><a href="ChapBaronKennySem.html#cb1-82" tabindex="-1"></a>                       <span class="at">data =</span> df1)</span>
<span id="cb1-83"><a href="ChapBaronKennySem.html#cb1-83" tabindex="-1"></a><span class="fu">summary</span>(linear.model.A.M)</span>
<span id="cb1-84"><a href="ChapBaronKennySem.html#cb1-84" tabindex="-1"></a><span class="co"># Coefficients:</span></span>
<span id="cb1-85"><a href="ChapBaronKennySem.html#cb1-85" tabindex="-1"></a><span class="co">#             Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb1-86"><a href="ChapBaronKennySem.html#cb1-86" tabindex="-1"></a><span class="co"># (Intercept) 0.215398   0.008929  24.123  &lt; 2e-16 ***</span></span>
<span id="cb1-87"><a href="ChapBaronKennySem.html#cb1-87" tabindex="-1"></a><span class="co"># A0_PM2.5    0.127180   0.014446   8.804  &lt; 2e-16 *** &lt;- effect of A on M</span></span>
<span id="cb1-88"><a href="ChapBaronKennySem.html#cb1-88" tabindex="-1"></a><span class="co"># L0_male     0.052363   0.009091   5.760 8.67e-09 ***</span></span>
<span id="cb1-89"><a href="ChapBaronKennySem.html#cb1-89" tabindex="-1"></a><span class="co"># L0_soc_env  0.065806   0.009511   6.919 4.83e-12 ***</span></span>
<span id="cb1-90"><a href="ChapBaronKennySem.html#cb1-90" tabindex="-1"></a></span>
<span id="cb1-91"><a href="ChapBaronKennySem.html#cb1-91" tabindex="-1"></a><span class="do">## product of coefficient method:</span></span>
<span id="cb1-92"><a href="ChapBaronKennySem.html#cb1-92" tabindex="-1"></a>ind.effect.prod.meth <span class="ot">&lt;-</span> (linear.model.A.M<span class="sc">$</span>coefficients[<span class="st">&quot;A0_PM2.5&quot;</span>] <span class="sc">*</span></span>
<span id="cb1-93"><a href="ChapBaronKennySem.html#cb1-93" tabindex="-1"></a>                           model.A.M.QoL<span class="sc">$</span>coefficients[<span class="st">&quot;M_diabetes&quot;</span>])</span>
<span id="cb1-94"><a href="ChapBaronKennySem.html#cb1-94" tabindex="-1"></a><span class="co"># -1.108213</span></span>
<span id="cb1-95"><a href="ChapBaronKennySem.html#cb1-95" tabindex="-1"></a><span class="co"># which also gives an indirect effect of approximately -1.1</span></span></code></pre></div>
<p>The Baron &amp; Kenny approach is usually applied for continuous outcomes, using linear regressions. It is less adapted for binary outcomes.</p>
<p>However, as for the binary mediator, some authors suggested that using linear regressions of the mediator and the outcome could still give some results.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="ChapBaronKennySem.html#cb2-1" tabindex="-1"></a><span class="do">### Baron &amp; Kenny approach for binary outcomes:</span></span>
<span id="cb2-2"><a href="ChapBaronKennySem.html#cb2-2" tabindex="-1"></a><span class="do">## Model 1: linear model of the probability of death to estimate the total effect:</span></span>
<span id="cb2-3"><a href="ChapBaronKennySem.html#cb2-3" tabindex="-1"></a>model.tot.A.death <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y_death <span class="sc">~</span> A0_PM2<span class="fl">.5</span> <span class="sc">+</span> L0_male <span class="sc">+</span> L0_soc_env,</span>
<span id="cb2-4"><a href="ChapBaronKennySem.html#cb2-4" tabindex="-1"></a>                        <span class="at">data =</span> df1)</span>
<span id="cb2-5"><a href="ChapBaronKennySem.html#cb2-5" tabindex="-1"></a><span class="fu">summary</span>(model.tot.A.death)</span>
<span id="cb2-6"><a href="ChapBaronKennySem.html#cb2-6" tabindex="-1"></a><span class="co"># Coefficients:</span></span>
<span id="cb2-7"><a href="ChapBaronKennySem.html#cb2-7" tabindex="-1"></a><span class="co">#               Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb2-8"><a href="ChapBaronKennySem.html#cb2-8" tabindex="-1"></a><span class="co">#   (Intercept) 0.135282   0.007909  17.104  &lt; 2e-16 ***</span></span>
<span id="cb2-9"><a href="ChapBaronKennySem.html#cb2-9" tabindex="-1"></a><span class="co">#   A0_PM2.5    0.060247   0.012796   4.708 2.53e-06 *** &lt;- Total effect</span></span>
<span id="cb2-10"><a href="ChapBaronKennySem.html#cb2-10" tabindex="-1"></a><span class="co">#   L0_male     0.050285   0.008053   6.244 4.43e-10 ***</span></span>
<span id="cb2-11"><a href="ChapBaronKennySem.html#cb2-11" tabindex="-1"></a><span class="co">#   L0_soc_env  0.059565   0.008425   7.070 1.65e-12 ***</span></span>
<span id="cb2-12"><a href="ChapBaronKennySem.html#cb2-12" tabindex="-1"></a><span class="co"># On a risk difference scale the total effect of being exposed to high levels of</span></span>
<span id="cb2-13"><a href="ChapBaronKennySem.html#cb2-13" tabindex="-1"></a><span class="co"># PM_2.5 on the probability of death is approximately +6.0%</span></span>
<span id="cb2-14"><a href="ChapBaronKennySem.html#cb2-14" tabindex="-1"></a></span>
<span id="cb2-15"><a href="ChapBaronKennySem.html#cb2-15" tabindex="-1"></a><span class="do">## Model 3: linear model to estimate the direct effect of the exposure (conditional on</span></span>
<span id="cb2-16"><a href="ChapBaronKennySem.html#cb2-16" tabindex="-1"></a><span class="do">## the outcome) and the effect of M on Y, adjusted for confounders of the A-Y</span></span>
<span id="cb2-17"><a href="ChapBaronKennySem.html#cb2-17" tabindex="-1"></a><span class="do">## and M-Y relationships</span></span>
<span id="cb2-18"><a href="ChapBaronKennySem.html#cb2-18" tabindex="-1"></a>model.A.M.death <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y_death <span class="sc">~</span> A0_PM2<span class="fl">.5</span> <span class="sc">+</span> M_diabetes <span class="sc">+</span> L1 <span class="sc">+</span> L0_male <span class="sc">+</span> L0_soc_env,</span>
<span id="cb2-19"><a href="ChapBaronKennySem.html#cb2-19" tabindex="-1"></a>                      <span class="at">data =</span> df1)</span>
<span id="cb2-20"><a href="ChapBaronKennySem.html#cb2-20" tabindex="-1"></a><span class="fu">summary</span>(model.A.M.death)</span>
<span id="cb2-21"><a href="ChapBaronKennySem.html#cb2-21" tabindex="-1"></a><span class="co">#   Coefficients:</span></span>
<span id="cb2-22"><a href="ChapBaronKennySem.html#cb2-22" tabindex="-1"></a><span class="co">#                          Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span id="cb2-23"><a href="ChapBaronKennySem.html#cb2-23" tabindex="-1"></a><span class="co">#   (Intercept) 0.098691   0.008460  11.666  &lt; 2e-16 ***</span></span>
<span id="cb2-24"><a href="ChapBaronKennySem.html#cb2-24" tabindex="-1"></a><span class="co">#   A0_PM2.5    0.051509   0.012759   4.037 5.45e-05 *** &lt;- Direct effect</span></span>
<span id="cb2-25"><a href="ChapBaronKennySem.html#cb2-25" tabindex="-1"></a><span class="co">#   M_diabetes  0.064751   0.008822   7.340 2.31e-13 *** &lt;- effect of M on Y</span></span>
<span id="cb2-26"><a href="ChapBaronKennySem.html#cb2-26" tabindex="-1"></a><span class="co">#   L1          0.075533   0.008788   8.595  &lt; 2e-16 ***</span></span>
<span id="cb2-27"><a href="ChapBaronKennySem.html#cb2-27" tabindex="-1"></a><span class="co">#   L0_male     0.047490   0.008013   5.927 3.19e-09 ***</span></span>
<span id="cb2-28"><a href="ChapBaronKennySem.html#cb2-28" tabindex="-1"></a><span class="co">#   L0_soc_env  0.055676   0.008389   6.637 3.36e-11 ***</span></span>
<span id="cb2-29"><a href="ChapBaronKennySem.html#cb2-29" tabindex="-1"></a></span>
<span id="cb2-30"><a href="ChapBaronKennySem.html#cb2-30" tabindex="-1"></a></span>
<span id="cb2-31"><a href="ChapBaronKennySem.html#cb2-31" tabindex="-1"></a><span class="co"># The direct effect is approximately +5.2% given by the A0_PM2.5 coefficient</span></span>
<span id="cb2-32"><a href="ChapBaronKennySem.html#cb2-32" tabindex="-1"></a>model.A.M.death<span class="sc">$</span>coefficients[<span class="st">&quot;A0_PM2.5&quot;</span>]</span>
<span id="cb2-33"><a href="ChapBaronKennySem.html#cb2-33" tabindex="-1"></a><span class="co"># 0.05150901</span></span>
<span id="cb2-34"><a href="ChapBaronKennySem.html#cb2-34" tabindex="-1"></a></span>
<span id="cb2-35"><a href="ChapBaronKennySem.html#cb2-35" tabindex="-1"></a><span class="co"># The indirect effect can be calculated by the &quot;difference in coefficient&quot; method</span></span>
<span id="cb2-36"><a href="ChapBaronKennySem.html#cb2-36" tabindex="-1"></a><span class="co"># using coefficients from models 1 and 3</span></span>
<span id="cb2-37"><a href="ChapBaronKennySem.html#cb2-37" tabindex="-1"></a>model.tot.A.death<span class="sc">$</span>coefficients[<span class="st">&quot;A0_PM2.5&quot;</span>] <span class="sc">-</span> model.A.M.death<span class="sc">$</span>coefficients[<span class="st">&quot;A0_PM2.5&quot;</span>]</span>
<span id="cb2-38"><a href="ChapBaronKennySem.html#cb2-38" tabindex="-1"></a><span class="co"># 0.008737889, i.e. approximately 0.9%</span></span>
<span id="cb2-39"><a href="ChapBaronKennySem.html#cb2-39" tabindex="-1"></a></span>
<span id="cb2-40"><a href="ChapBaronKennySem.html#cb2-40" tabindex="-1"></a><span class="co"># or the product of coefficients using the previous model 2bis and model 3:</span></span>
<span id="cb2-41"><a href="ChapBaronKennySem.html#cb2-41" tabindex="-1"></a>linear.model.A.M<span class="sc">$</span>coefficients[<span class="st">&quot;A0_PM2.5&quot;</span>] <span class="sc">*</span> model.A.M.death<span class="sc">$</span>coefficients[<span class="st">&quot;M_diabetes&quot;</span>]</span>
<span id="cb2-42"><a href="ChapBaronKennySem.html#cb2-42" tabindex="-1"></a><span class="co"># 0.008234978, i.e. approximately 0.8%</span></span></code></pre></div>
</div>
<div id="path-analysis-and-structural-equation-modeling" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Path analysis and Structural Equation Modeling<a href="ChapBaronKennySem.html#path-analysis-and-structural-equation-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="first-application-without-intermediate-confouding-affected-by-the-exposure" class="section level3 hasAnchor" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> First application, without intermediate confouding affected by the exposure<a href="ChapBaronKennySem.html#first-application-without-intermediate-confouding-affected-by-the-exposure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Path analyses can be considered as a âgeneralizationâ of the product of coefficients method. They combine graphical representation of causal structures, a set of linear equations and assumptions concerning the covariance structure of residuals.</p>
<p>When the causal model includes latent variables (represented by a measurement model), we refer to the analysis as structural equation modeling.</p>
<p>Variables which does not receive causal inputs from any other variable in the diagram are called exogenous variables. Unless the assumption is explicitly made that two exogenous variables are uncorrelated (because they do not have any common causal factor), it is preferable to consider them as not independent (connecting them by double arrows).</p>
<p>In the <code>df1.csv</code> data set, there are 3 exogenous variables: <code>L0_male</code>, <code>L0_soc_env</code> and <code>L1</code>.</p>
<p>We will use the <a href="https://lavaan.ugent.be/"><code>lavaan</code></a> R package to run path analyses.</p>
<ul>
<li>The first step is to write the model syntax</li>
<li>The second step is to analyze the model with the dataset</li>
</ul>
<p>For a complete overview of the analyses that can be performed using <code>lavaan</code>, you can read:</p>
<ul>
<li><a href="https://lavaan.ugent.be/tutorial/">the lavaan tutorial</a></li>
<li><a href="https://tdjorgensen.github.io/SEM-in-Ed-compendium/index.html">A lavaan Compendium for Structural Equation Modeling in Educational Research</a>,<span class="citation">(<a href="#ref-Jak2023">Jak, Suzanne and Jorgensen, Terrence D. 2024</a>)</span></li>
<li><a href="https://gabriellajg.github.io/EPSY-579-R-Cookbook-for-SEM/">R Cookbook for Structural Equation Modeling</a>,<span class="citation">(<a href="#ref-Jiang2023">Jiang, Ge 2023</a>)</span></li>
</ul>
<p><strong>First step</strong>. Let us write the model syntax to analyze the effect of being exposed to high levels of <span class="math inline">\(\text{PM}_{2.5}\)</span> on quality of life, mediated by type-2 diabetes.</p>
<p>We have to define:</p>
<ul>
<li>regression models for the endogenous variables: exposure to <span class="math inline">\(\text{PM}_{2.5}\)</span> (<code>A0_PM2.5</code>), type-2 diabetes (<code>M_diabetes</code>) and quality of life (<code>Y_qol</code>)</li>
<li>covariance assumptions for the exogenous variables</li>
<li>we can also define additional parameters of interest (in our case, direct, indirect and total effects)</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="ChapBaronKennySem.html#cb3-1" tabindex="-1"></a>sem.QoL <span class="ot">&lt;-</span> <span class="st">&quot;                                 # models are written between quotes</span></span>
<span id="cb3-2"><a href="ChapBaronKennySem.html#cb3-2" tabindex="-1"></a><span class="st">## Regression models</span></span>
<span id="cb3-3"><a href="ChapBaronKennySem.html#cb3-3" tabindex="-1"></a><span class="st">## we can also add the names of some path coefficients </span></span>
<span id="cb3-4"><a href="ChapBaronKennySem.html#cb3-4" tabindex="-1"></a><span class="st">  A0_PM2.5 ~ L0_male + L0_soc_env</span></span>
<span id="cb3-5"><a href="ChapBaronKennySem.html#cb3-5" tabindex="-1"></a><span class="st">  M_diabetes ~ L0_male + L0_soc_env + b.A * A0_PM2.5 + L1   # label b.A path coef</span></span>
<span id="cb3-6"><a href="ChapBaronKennySem.html#cb3-6" tabindex="-1"></a><span class="st">  Y_qol ~ L0_male + L0_soc_env + c.A*A0_PM2.5 + L1 + c.M*M_diabetes # label c.A and c.M</span></span>
<span id="cb3-7"><a href="ChapBaronKennySem.html#cb3-7" tabindex="-1"></a></span>
<span id="cb3-8"><a href="ChapBaronKennySem.html#cb3-8" tabindex="-1"></a><span class="st">## Covariances</span></span>
<span id="cb3-9"><a href="ChapBaronKennySem.html#cb3-9" tabindex="-1"></a><span class="st"># Assuming a non-null covariance between confounders </span></span>
<span id="cb3-10"><a href="ChapBaronKennySem.html#cb3-10" tabindex="-1"></a><span class="st"># covariances are represented with a double tilde ~~ (double arrow)</span></span>
<span id="cb3-11"><a href="ChapBaronKennySem.html#cb3-11" tabindex="-1"></a><span class="st"># (note: in the data-generating system, the null assumptions were true)</span></span>
<span id="cb3-12"><a href="ChapBaronKennySem.html#cb3-12" tabindex="-1"></a><span class="st">  L0_male ~~ L0_soc_env</span></span>
<span id="cb3-13"><a href="ChapBaronKennySem.html#cb3-13" tabindex="-1"></a><span class="st">  L0_male ~~ L1</span></span>
<span id="cb3-14"><a href="ChapBaronKennySem.html#cb3-14" tabindex="-1"></a><span class="st">  L0_soc_env ~~ L1</span></span>
<span id="cb3-15"><a href="ChapBaronKennySem.html#cb3-15" tabindex="-1"></a></span>
<span id="cb3-16"><a href="ChapBaronKennySem.html#cb3-16" tabindex="-1"></a><span class="st">## We can define other parameters to estimate, using the := syntax</span></span>
<span id="cb3-17"><a href="ChapBaronKennySem.html#cb3-17" tabindex="-1"></a><span class="st">## we want the direct, indirect and total effects:</span></span>
<span id="cb3-18"><a href="ChapBaronKennySem.html#cb3-18" tabindex="-1"></a><span class="st">  direct := c.A</span></span>
<span id="cb3-19"><a href="ChapBaronKennySem.html#cb3-19" tabindex="-1"></a><span class="st">  indirect := b.A * c.M</span></span>
<span id="cb3-20"><a href="ChapBaronKennySem.html#cb3-20" tabindex="-1"></a><span class="st">  total := (b.A * c.M) + c.A</span></span>
<span id="cb3-21"><a href="ChapBaronKennySem.html#cb3-21" tabindex="-1"></a><span class="st">&quot;</span></span></code></pre></div>
<p><strong>Second step</strong>. Let us analyze the model with the <code>df1.csv</code> dataset using the <code>sem</code> function from the <code>lavaan</code> package.</p>
<p>Binary exogenous variables (<code>L0_male</code>,<code>L0_soc_env</code> and <code>L1</code>) can be coded as simple dummy (0/1) variables, there is no need to declare them as factors (<code>ordered</code>).</p>
<p>Note that in the following example, we will not declare the other binary variables (<code>A0_PM2.5</code>,<code>M_diabetes</code>) as factors and let them as simple dummy variables.</p>
<p>Running the <code>sem</code> function with the <code>df1.csv</code> dataset, we obtain:</p>
<ul>
<li>information about the estimator</li>
<li>estimates of the regression models</li>
<li>estimates of the covariance between exogenous variables</li>
<li>estimates of the residual variances</li>
<li>estimates of the additional parameters (direct, indirect and total effects)</li>
</ul>
<p>For datasets with only continuous variables, <code>lavaan</code> would estimate the covariance structure by maximum likelihood estimation. For categorical data, weighted least square estimators (WLS) are typically used. Applying WLS to continuous data is referred to as asymptotical distribution-free estimation (ADF) in the SEM literature. ADF estimation requires large sample sizes (&gt; 2000 or 5000).<span class="citation">(<a href="#ref-Jak2023">Jak, Suzanne and Jorgensen, Terrence D. 2024</a>)</span></p>
<p>In order to avoid underestimating standard errors and confidence intervals, robust estimators (âsandwichâ and bootstrap) are usually applied if the data are not multivariate normal.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="ChapBaronKennySem.html#cb4-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb4-2"><a href="ChapBaronKennySem.html#cb4-2" tabindex="-1"></a>fit.qol <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">sem</span>(<span class="at">model =</span> sem.QoL,</span>
<span id="cb4-3"><a href="ChapBaronKennySem.html#cb4-3" tabindex="-1"></a>                       <span class="at">fixed.x =</span> <span class="cn">FALSE</span>, <span class="co"># ask for covariance of exogenous variables</span></span>
<span id="cb4-4"><a href="ChapBaronKennySem.html#cb4-4" tabindex="-1"></a>                                        <span class="co"># to be freely estimated </span></span>
<span id="cb4-5"><a href="ChapBaronKennySem.html#cb4-5" tabindex="-1"></a>                       <span class="co"># estimator = &quot;DWLS&quot;,  # for WLS estimation</span></span>
<span id="cb4-6"><a href="ChapBaronKennySem.html#cb4-6" tabindex="-1"></a>                       <span class="at">se =</span> <span class="st">&quot;boot&quot;</span>, <span class="co"># estimation of SE by bootstrap</span></span>
<span id="cb4-7"><a href="ChapBaronKennySem.html#cb4-7" tabindex="-1"></a>                       <span class="co"># se = &quot;robust.sem&quot;, # for sandwich-type SE</span></span>
<span id="cb4-8"><a href="ChapBaronKennySem.html#cb4-8" tabindex="-1"></a>                       <span class="at">bootstrap =</span> <span class="dv">100</span>, <span class="co"># better with 1000 bootstrap samples or more</span></span>
<span id="cb4-9"><a href="ChapBaronKennySem.html#cb4-9" tabindex="-1"></a>                       <span class="at">data =</span> df1)</span>
<span id="cb4-10"><a href="ChapBaronKennySem.html#cb4-10" tabindex="-1"></a><span class="fu">summary</span>(fit.qol,</span>
<span id="cb4-11"><a href="ChapBaronKennySem.html#cb4-11" tabindex="-1"></a>        <span class="at">ci =</span> <span class="cn">TRUE</span>) <span class="co"># add 95%CI in the output</span></span>
<span id="cb4-12"><a href="ChapBaronKennySem.html#cb4-12" tabindex="-1"></a><span class="co"># You will get 2 warning messages: </span></span>
<span id="cb4-13"><a href="ChapBaronKennySem.html#cb4-13" tabindex="-1"></a><span class="co"># 1) we did not standardize the outcome, its variance is very large variance compared  </span></span>
<span id="cb4-14"><a href="ChapBaronKennySem.html#cb4-14" tabindex="-1"></a><span class="co">#    to the other binary variables (not a problem)</span></span>
<span id="cb4-15"><a href="ChapBaronKennySem.html#cb4-15" tabindex="-1"></a><span class="co"># 2) 3 bootstrap runs failed or did not converge. </span></span>
<span id="cb4-16"><a href="ChapBaronKennySem.html#cb4-16" tabindex="-1"></a><span class="co">#    =&gt; The estimations relie on the 97 other bootstrap samples</span></span>
<span id="cb4-17"><a href="ChapBaronKennySem.html#cb4-17" tabindex="-1"></a></span>
<span id="cb4-18"><a href="ChapBaronKennySem.html#cb4-18" tabindex="-1"></a><span class="co"># lavaan 0.6-18 ended normally after 23 iterations</span></span>
<span id="cb4-19"><a href="ChapBaronKennySem.html#cb4-19" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-20"><a href="ChapBaronKennySem.html#cb4-20" tabindex="-1"></a><span class="co">#   Estimator                                         ML</span></span>
<span id="cb4-21"><a href="ChapBaronKennySem.html#cb4-21" tabindex="-1"></a><span class="co">#   Optimization method                           NLMINB</span></span>
<span id="cb4-22"><a href="ChapBaronKennySem.html#cb4-22" tabindex="-1"></a><span class="co">#   Number of model parameters                        20</span></span>
<span id="cb4-23"><a href="ChapBaronKennySem.html#cb4-23" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-24"><a href="ChapBaronKennySem.html#cb4-24" tabindex="-1"></a><span class="co">#   Number of observations                         10000</span></span>
<span id="cb4-25"><a href="ChapBaronKennySem.html#cb4-25" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-26"><a href="ChapBaronKennySem.html#cb4-26" tabindex="-1"></a><span class="co"># Model Test User Model:</span></span>
<span id="cb4-27"><a href="ChapBaronKennySem.html#cb4-27" tabindex="-1"></a><span class="co">#   Test statistic                                 0.211</span></span>
<span id="cb4-28"><a href="ChapBaronKennySem.html#cb4-28" tabindex="-1"></a><span class="co">#   Degrees of freedom                                 1</span></span>
<span id="cb4-29"><a href="ChapBaronKennySem.html#cb4-29" tabindex="-1"></a><span class="co">#   P-value (Chi-square)                           0.646</span></span>
<span id="cb4-30"><a href="ChapBaronKennySem.html#cb4-30" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-31"><a href="ChapBaronKennySem.html#cb4-31" tabindex="-1"></a><span class="co"># Parameter Estimates:</span></span>
<span id="cb4-32"><a href="ChapBaronKennySem.html#cb4-32" tabindex="-1"></a><span class="co">#   Standard errors                            Bootstrap</span></span>
<span id="cb4-33"><a href="ChapBaronKennySem.html#cb4-33" tabindex="-1"></a><span class="co">#   Number of requested bootstrap draws              100</span></span>
<span id="cb4-34"><a href="ChapBaronKennySem.html#cb4-34" tabindex="-1"></a><span class="co">#   Number of successful bootstrap draws              97</span></span>
<span id="cb4-35"><a href="ChapBaronKennySem.html#cb4-35" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-36"><a href="ChapBaronKennySem.html#cb4-36" tabindex="-1"></a><span class="co"># Regressions:</span></span>
<span id="cb4-37"><a href="ChapBaronKennySem.html#cb4-37" tabindex="-1"></a><span class="co">#                  Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper</span></span>
<span id="cb4-38"><a href="ChapBaronKennySem.html#cb4-38" tabindex="-1"></a><span class="co"># A0_PM2.5 ~</span></span>
<span id="cb4-39"><a href="ChapBaronKennySem.html#cb4-39" tabindex="-1"></a><span class="co">#   L0_male           0.040    0.005    7.310    0.000    0.029    0.050</span></span>
<span id="cb4-40"><a href="ChapBaronKennySem.html#cb4-40" tabindex="-1"></a><span class="co">#   L0_sc_nv          0.058    0.006    9.243    0.000    0.046    0.071</span></span>
<span id="cb4-41"><a href="ChapBaronKennySem.html#cb4-41" tabindex="-1"></a><span class="co"># M_diabetes ~</span></span>
<span id="cb4-42"><a href="ChapBaronKennySem.html#cb4-42" tabindex="-1"></a><span class="co">#   L0_male           0.053    0.009    5.626    0.000    0.033    0.074</span></span>
<span id="cb4-43"><a href="ChapBaronKennySem.html#cb4-43" tabindex="-1"></a><span class="co">#   L0_sc_nv          0.066    0.010    6.948    0.000    0.047    0.088</span></span>
<span id="cb4-44"><a href="ChapBaronKennySem.html#cb4-44" tabindex="-1"></a><span class="co">#   A0_PM2.5 (b.A)    0.127    0.015    8.475    0.000    0.100    0.156</span></span>
<span id="cb4-45"><a href="ChapBaronKennySem.html#cb4-45" tabindex="-1"></a><span class="co">#   L1                0.070    0.011    6.391    0.000    0.046    0.088</span></span>
<span id="cb4-46"><a href="ChapBaronKennySem.html#cb4-46" tabindex="-1"></a><span class="co"># Y_qol ~</span></span>
<span id="cb4-47"><a href="ChapBaronKennySem.html#cb4-47" tabindex="-1"></a><span class="co">#   L0_male          -0.719    0.190   -3.777    0.000   -1.081   -0.314</span></span>
<span id="cb4-48"><a href="ChapBaronKennySem.html#cb4-48" tabindex="-1"></a><span class="co">#   L0_sc_nv         -2.888    0.210  -13.760    0.000   -3.262   -2.408</span></span>
<span id="cb4-49"><a href="ChapBaronKennySem.html#cb4-49" tabindex="-1"></a><span class="co">#   A0_PM2.5 (c.A)   -3.965    0.331  -11.977    0.000   -4.631   -3.262</span></span>
<span id="cb4-50"><a href="ChapBaronKennySem.html#cb4-50" tabindex="-1"></a><span class="co">#   L1               -3.425    0.189  -18.136    0.000   -3.808   -3.043</span></span>
<span id="cb4-51"><a href="ChapBaronKennySem.html#cb4-51" tabindex="-1"></a><span class="co">#   M_diabts (c.M)   -8.714    0.211  -41.394    0.000   -9.082   -8.280</span></span>
<span id="cb4-52"><a href="ChapBaronKennySem.html#cb4-52" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-53"><a href="ChapBaronKennySem.html#cb4-53" tabindex="-1"></a><span class="co"># Covariances:</span></span>
<span id="cb4-54"><a href="ChapBaronKennySem.html#cb4-54" tabindex="-1"></a><span class="co">#                  Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper</span></span>
<span id="cb4-55"><a href="ChapBaronKennySem.html#cb4-55" tabindex="-1"></a><span class="co"># L0_male ~~</span></span>
<span id="cb4-56"><a href="ChapBaronKennySem.html#cb4-56" tabindex="-1"></a><span class="co">#   L0_soc_env       -0.003    0.003   -1.055    0.291   -0.008    0.004</span></span>
<span id="cb4-57"><a href="ChapBaronKennySem.html#cb4-57" tabindex="-1"></a><span class="co">#   L1               -0.002    0.002   -0.887    0.375   -0.006    0.002</span></span>
<span id="cb4-58"><a href="ChapBaronKennySem.html#cb4-58" tabindex="-1"></a><span class="co"># L0_soc_env ~~</span></span>
<span id="cb4-59"><a href="ChapBaronKennySem.html#cb4-59" tabindex="-1"></a><span class="co">#   L1               -0.001    0.002   -0.452    0.651   -0.006    0.003</span></span>
<span id="cb4-60"><a href="ChapBaronKennySem.html#cb4-60" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-61"><a href="ChapBaronKennySem.html#cb4-61" tabindex="-1"></a><span class="co"># Variances:</span></span>
<span id="cb4-62"><a href="ChapBaronKennySem.html#cb4-62" tabindex="-1"></a><span class="co">#                  Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper</span></span>
<span id="cb4-63"><a href="ChapBaronKennySem.html#cb4-63" tabindex="-1"></a><span class="co">#  .A0_PM2.5          0.099    0.002   43.273    0.000    0.094    0.103</span></span>
<span id="cb4-64"><a href="ChapBaronKennySem.html#cb4-64" tabindex="-1"></a><span class="co">#  .M_diabetes        0.205    0.002  114.604    0.000    0.200    0.208</span></span>
<span id="cb4-65"><a href="ChapBaronKennySem.html#cb4-65" tabindex="-1"></a><span class="co">#  .Y_qol           100.882    1.409   71.573    0.000   98.185  103.725</span></span>
<span id="cb4-66"><a href="ChapBaronKennySem.html#cb4-66" tabindex="-1"></a><span class="co">#   L0_male           0.250    0.000 9358.475    0.000    0.250    0.250</span></span>
<span id="cb4-67"><a href="ChapBaronKennySem.html#cb4-67" tabindex="-1"></a><span class="co">#   L0_soc_env        0.229    0.001  166.244    0.000    0.226    0.232</span></span>
<span id="cb4-68"><a href="ChapBaronKennySem.html#cb4-68" tabindex="-1"></a><span class="co">#   L1                0.207    0.002  117.109    0.000    0.204    0.210</span></span>
<span id="cb4-69"><a href="ChapBaronKennySem.html#cb4-69" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb4-70"><a href="ChapBaronKennySem.html#cb4-70" tabindex="-1"></a><span class="co"># Defined Parameters:</span></span>
<span id="cb4-71"><a href="ChapBaronKennySem.html#cb4-71" tabindex="-1"></a><span class="co">#                Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper</span></span>
<span id="cb4-72"><a href="ChapBaronKennySem.html#cb4-72" tabindex="-1"></a><span class="co"># direct           -3.965    0.333  -11.915    0.000   -4.631   -3.262</span></span>
<span id="cb4-73"><a href="ChapBaronKennySem.html#cb4-73" tabindex="-1"></a><span class="co"># indirect         -1.104    0.129   -8.586    0.000   -1.359   -0.866</span></span>
<span id="cb4-74"><a href="ChapBaronKennySem.html#cb4-74" tabindex="-1"></a><span class="co"># total            -5.069    0.358  -14.170    0.000   -5.843   -4.343</span></span>
<span id="cb4-75"><a href="ChapBaronKennySem.html#cb4-75" tabindex="-1"></a></span>
<span id="cb4-76"><a href="ChapBaronKennySem.html#cb4-76" tabindex="-1"></a><span class="co"># ?lavaan::parameterEstimates for more options on bootstrap SE estimations.</span></span>
<span id="cb4-77"><a href="ChapBaronKennySem.html#cb4-77" tabindex="-1"></a><span class="fu">parameterEstimates</span>(fit.qol,</span>
<span id="cb4-78"><a href="ChapBaronKennySem.html#cb4-78" tabindex="-1"></a>                   <span class="at">level =</span> <span class="fl">0.95</span>,</span>
<span id="cb4-79"><a href="ChapBaronKennySem.html#cb4-79" tabindex="-1"></a>                   <span class="at">boot.ci.type =</span> <span class="st">&quot;bca.simple&quot;</span>) <span class="co"># &quot;bca.simple&quot; to correct for bias,</span></span>
<span id="cb4-80"><a href="ChapBaronKennySem.html#cb4-80" tabindex="-1"></a>                                                <span class="co"># but not acceleration</span></span>
<span id="cb4-81"><a href="ChapBaronKennySem.html#cb4-81" tabindex="-1"></a><span class="co">#           lhs op           rhs    label     est    se        z pvalue ci.lower ci.upper</span></span>
<span id="cb4-82"><a href="ChapBaronKennySem.html#cb4-82" tabindex="-1"></a><span class="co"># 1    A0_PM2.5  ~       L0_male            0.040 0.005    7.310  0.000    0.031    0.051</span></span>
<span id="cb4-83"><a href="ChapBaronKennySem.html#cb4-83" tabindex="-1"></a><span class="co"># 2    A0_PM2.5  ~    L0_soc_env            0.058 0.006    9.243  0.000    0.045    0.070</span></span>
<span id="cb4-84"><a href="ChapBaronKennySem.html#cb4-84" tabindex="-1"></a><span class="co"># ...</span></span>
<span id="cb4-85"><a href="ChapBaronKennySem.html#cb4-85" tabindex="-1"></a><span class="co"># 21     direct :=           c.A   direct  -3.965 0.333  -11.915  0.000   -4.544   -3.190</span></span>
<span id="cb4-86"><a href="ChapBaronKennySem.html#cb4-86" tabindex="-1"></a><span class="co"># 22   indirect :=       b.A*c.M indirect  -1.104 0.129   -8.586  0.000   -1.401   -0.897</span></span>
<span id="cb4-87"><a href="ChapBaronKennySem.html#cb4-87" tabindex="-1"></a><span class="co"># 23      total := (b.A*c.M)+c.A    total  -5.069 0.358  -14.170  0.000   -5.658   -4.201</span></span></code></pre></div>
<p>We recall that the results obtained using Baron &amp; Kenny approach were:</p>
<ul>
<li>direct effect = -3.965</li>
<li>indirect effect = -1.131 (using the âdifference in coefficientsâ method) or -1.108213 (using the âproduct of coefficientsâ method)</li>
<li>total effect = -5.096</li>
</ul>
<p>The path analysis results from <code>lavaan</code> are very close to the Baron &amp; Kenny results.</p>
<p>We can plot the estimated model using the <code>semPlot</code> package (Figure <a href="ChapBaronKennySem.html#fig:FigSemPlotQol1">4.1</a>):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="ChapBaronKennySem.html#cb5-1" tabindex="-1"></a><span class="fu">library</span>(semPlot)</span>
<span id="cb5-2"><a href="ChapBaronKennySem.html#cb5-2" tabindex="-1"></a><span class="fu">semPaths</span>(fit.qol,</span>
<span id="cb5-3"><a href="ChapBaronKennySem.html#cb5-3" tabindex="-1"></a>         <span class="at">what =</span> <span class="st">&quot;est&quot;</span>,</span>
<span id="cb5-4"><a href="ChapBaronKennySem.html#cb5-4" tabindex="-1"></a>         <span class="at">layout =</span> <span class="st">&quot;tree2&quot;</span>, <span class="co"># tree, tree2, spring</span></span>
<span id="cb5-5"><a href="ChapBaronKennySem.html#cb5-5" tabindex="-1"></a>         <span class="at">rotation =</span> <span class="dv">2</span>, <span class="co">#exogenous on the left, endogenous on the right</span></span>
<span id="cb5-6"><a href="ChapBaronKennySem.html#cb5-6" tabindex="-1"></a>         <span class="at">sizeMan =</span> <span class="dv">10</span>, <span class="co"># font size of manifest variable names</span></span>
<span id="cb5-7"><a href="ChapBaronKennySem.html#cb5-7" tabindex="-1"></a>         <span class="at">nCharNodes =</span> <span class="dv">0</span>,</span>
<span id="cb5-8"><a href="ChapBaronKennySem.html#cb5-8" tabindex="-1"></a>         <span class="at">nCharEdges =</span> <span class="dv">0</span>, <span class="co"># don&#39;t limit variable name lengths</span></span>
<span id="cb5-9"><a href="ChapBaronKennySem.html#cb5-9" tabindex="-1"></a>         <span class="at">edge.label.cex =</span> <span class="fl">0.6</span>,</span>
<span id="cb5-10"><a href="ChapBaronKennySem.html#cb5-10" tabindex="-1"></a>         <span class="at">curvePivot =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-11"><a href="ChapBaronKennySem.html#cb5-11" tabindex="-1"></a>         <span class="at">fade =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:FigSemPlotQol1"></span>
<img src="figures/sem_plot.jpeg" alt="Plot of the SEM" width="70%" />
<p class="caption">
Figure 4.1: Plot of the SEM
</p>
</div>
</div>
<div id="dealing-with-categorical-endogenous-variables" class="section level3 hasAnchor" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Dealing with categorical endogenous variables<a href="ChapBaronKennySem.html#dealing-with-categorical-endogenous-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the dataset, we can declare the binary endogenous variables as <code>ordered</code> variables, so that the <code>sem</code> function will detect them automatically as categorical variables, and apply a Weighted Least Square estimation.</p>
<p>When endogenous variables are binary or ordered categorical variables, the SEM-method will assume the existence of latent normal variables that underlies the observed categorical variables (corresponding to <em>latent response variables</em> (LRV)). SEM will then fit the model to the LRV instead of the categorical variables. The distribution of a categorical variable is linked to the LRV using âthresholdsâ, defined from the cumulative distribution function of a standard normal distribution to match the probabilities of observed levels (similarly to probit regressions).<span class="citation">(<a href="#ref-Jak2023">Jak, Suzanne and Jorgensen, Terrence D. 2024</a>)</span></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="ChapBaronKennySem.html#cb6-1" tabindex="-1"></a><span class="do">## We first create a data.frame, setting the exposure and mediator to ordered variables</span></span>
<span id="cb6-2"><a href="ChapBaronKennySem.html#cb6-2" tabindex="-1"></a>df1.cat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">L0_male =</span> df1<span class="sc">$</span>L0_male,</span>
<span id="cb6-3"><a href="ChapBaronKennySem.html#cb6-3" tabindex="-1"></a>                      <span class="at">L0_soc_env =</span> df1<span class="sc">$</span>L0_soc_env,</span>
<span id="cb6-4"><a href="ChapBaronKennySem.html#cb6-4" tabindex="-1"></a>                      <span class="at">A0_PM2.5 =</span> <span class="fu">ordered</span>(df1<span class="sc">$</span>A0_PM2<span class="fl">.5</span>), </span>
<span id="cb6-5"><a href="ChapBaronKennySem.html#cb6-5" tabindex="-1"></a>                      <span class="at">L1 =</span> df1<span class="sc">$</span>L1,</span>
<span id="cb6-6"><a href="ChapBaronKennySem.html#cb6-6" tabindex="-1"></a>                      <span class="at">M_diabetes =</span> <span class="fu">ordered</span>(df1<span class="sc">$</span>M_diabetes), </span>
<span id="cb6-7"><a href="ChapBaronKennySem.html#cb6-7" tabindex="-1"></a>                      <span class="at">Y_qol =</span> df1<span class="sc">$</span>Y_qol)</span>
<span id="cb6-8"><a href="ChapBaronKennySem.html#cb6-8" tabindex="-1"></a></span>
<span id="cb6-9"><a href="ChapBaronKennySem.html#cb6-9" tabindex="-1"></a><span class="do">## We analyze the model with the new data.frame (df1.cat)</span></span>
<span id="cb6-10"><a href="ChapBaronKennySem.html#cb6-10" tabindex="-1"></a><span class="do">## In this example, we estimate standwich-type standard errors</span></span>
<span id="cb6-11"><a href="ChapBaronKennySem.html#cb6-11" tabindex="-1"></a>fit.qol <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">sem</span>(<span class="at">model =</span> sem.QoL,</span>
<span id="cb6-12"><a href="ChapBaronKennySem.html#cb6-12" tabindex="-1"></a>                       <span class="at">se =</span> <span class="st">&quot;robust.sem&quot;</span>, <span class="co"># for sandwich-type SE</span></span>
<span id="cb6-13"><a href="ChapBaronKennySem.html#cb6-13" tabindex="-1"></a>                       <span class="at">fixed.x =</span> <span class="cn">FALSE</span>,</span>
<span id="cb6-14"><a href="ChapBaronKennySem.html#cb6-14" tabindex="-1"></a>                       <span class="at">data =</span> df1.cat)</span>
<span id="cb6-15"><a href="ChapBaronKennySem.html#cb6-15" tabindex="-1"></a><span class="co"># You will get 2 warnings:</span></span>
<span id="cb6-16"><a href="ChapBaronKennySem.html#cb6-16" tabindex="-1"></a><span class="co"># 1) A generalized inverse for A11 submatrix was used to solve a trouble</span></span>
<span id="cb6-17"><a href="ChapBaronKennySem.html#cb6-17" tabindex="-1"></a><span class="co">#    constructing W matrix</span></span>
<span id="cb6-18"><a href="ChapBaronKennySem.html#cb6-18" tabindex="-1"></a><span class="co"># 2) The variance-covariance matrix of the vcov does not appear to be positive definite.</span></span>
<span id="cb6-19"><a href="ChapBaronKennySem.html#cb6-19" tabindex="-1"></a><span class="co">#    Probably because the mean and variance of binary variable are collinear.</span></span>
<span id="cb6-20"><a href="ChapBaronKennySem.html#cb6-20" tabindex="-1"></a><span class="co">#    This message might be quite common and can be ignored</span></span>
<span id="cb6-21"><a href="ChapBaronKennySem.html#cb6-21" tabindex="-1"></a><span class="fu">summary</span>(fit.qol,</span>
<span id="cb6-22"><a href="ChapBaronKennySem.html#cb6-22" tabindex="-1"></a>        <span class="at">ci =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-23"><a href="ChapBaronKennySem.html#cb6-23" tabindex="-1"></a><span class="co"># lavaan 0.6-18 ended normally after 76 iterations</span></span>
<span id="cb6-24"><a href="ChapBaronKennySem.html#cb6-24" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-25"><a href="ChapBaronKennySem.html#cb6-25" tabindex="-1"></a><span class="co"># Estimator                                       DWLS  # apply WLS estimator</span></span>
<span id="cb6-26"><a href="ChapBaronKennySem.html#cb6-26" tabindex="-1"></a><span class="co"># Optimization method                           NLMINB</span></span>
<span id="cb6-27"><a href="ChapBaronKennySem.html#cb6-27" tabindex="-1"></a><span class="co"># Number of model parameters                        24</span></span>
<span id="cb6-28"><a href="ChapBaronKennySem.html#cb6-28" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-29"><a href="ChapBaronKennySem.html#cb6-29" tabindex="-1"></a><span class="co"># Number of observations                         10000</span></span>
<span id="cb6-30"><a href="ChapBaronKennySem.html#cb6-30" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-31"><a href="ChapBaronKennySem.html#cb6-31" tabindex="-1"></a><span class="co"># Model Test User Model:</span></span>
<span id="cb6-32"><a href="ChapBaronKennySem.html#cb6-32" tabindex="-1"></a><span class="co">#   Standard      Scaled</span></span>
<span id="cb6-33"><a href="ChapBaronKennySem.html#cb6-33" tabindex="-1"></a><span class="co"># Test Statistic                                 0.209       0.214</span></span>
<span id="cb6-34"><a href="ChapBaronKennySem.html#cb6-34" tabindex="-1"></a><span class="co"># Degrees of freedom                                 1           1</span></span>
<span id="cb6-35"><a href="ChapBaronKennySem.html#cb6-35" tabindex="-1"></a><span class="co"># P-value (Chi-square)                           0.648       0.644</span></span>
<span id="cb6-36"><a href="ChapBaronKennySem.html#cb6-36" tabindex="-1"></a><span class="co"># Scaling correction factor                                  0.977</span></span>
<span id="cb6-37"><a href="ChapBaronKennySem.html#cb6-37" tabindex="-1"></a><span class="co"># Shift parameter                                           -0.000</span></span>
<span id="cb6-38"><a href="ChapBaronKennySem.html#cb6-38" tabindex="-1"></a><span class="co"># simple second-order correction</span></span>
<span id="cb6-39"><a href="ChapBaronKennySem.html#cb6-39" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-40"><a href="ChapBaronKennySem.html#cb6-40" tabindex="-1"></a><span class="co"># Parameter Estimates:</span></span>
<span id="cb6-41"><a href="ChapBaronKennySem.html#cb6-41" tabindex="-1"></a><span class="co">#   Parameterization                               Delta</span></span>
<span id="cb6-42"><a href="ChapBaronKennySem.html#cb6-42" tabindex="-1"></a><span class="co">#   Standard errors                           Robust.sem</span></span>
<span id="cb6-43"><a href="ChapBaronKennySem.html#cb6-43" tabindex="-1"></a><span class="co">#   Information                                 Expected</span></span>
<span id="cb6-44"><a href="ChapBaronKennySem.html#cb6-44" tabindex="-1"></a><span class="co">#   Information saturated (h1) model        Unstructured</span></span>
<span id="cb6-45"><a href="ChapBaronKennySem.html#cb6-45" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-46"><a href="ChapBaronKennySem.html#cb6-46" tabindex="-1"></a><span class="co"># Regressions:</span></span>
<span id="cb6-47"><a href="ChapBaronKennySem.html#cb6-47" tabindex="-1"></a><span class="co">#                  Estimate  Std.Err  z-value   P(&gt;|z|) ci.lower ci.upper</span></span>
<span id="cb6-48"><a href="ChapBaronKennySem.html#cb6-48" tabindex="-1"></a><span class="co"># A0_PM2.5 ~</span></span>
<span id="cb6-49"><a href="ChapBaronKennySem.html#cb6-49" tabindex="-1"></a><span class="co">#   L0_male           0.209    0.033     6.394    0.000    0.145    0.273</span></span>
<span id="cb6-50"><a href="ChapBaronKennySem.html#cb6-50" tabindex="-1"></a><span class="co">#   L0_sc_nv          0.324    0.035     9.129    0.000    0.254    0.393</span></span>
<span id="cb6-51"><a href="ChapBaronKennySem.html#cb6-51" tabindex="-1"></a><span class="co"># M_diabetes ~</span></span>
<span id="cb6-52"><a href="ChapBaronKennySem.html#cb6-52" tabindex="-1"></a><span class="co">#   L0_male           0.129    0.027     4.846    0.000    0.077    0.181</span></span>
<span id="cb6-53"><a href="ChapBaronKennySem.html#cb6-53" tabindex="-1"></a><span class="co">#   L0_sc_nv          0.156    0.029     5.463    0.000    0.100    0.212</span></span>
<span id="cb6-54"><a href="ChapBaronKennySem.html#cb6-54" tabindex="-1"></a><span class="co">#   A0_PM2.5 (b.A)    0.182    0.021     8.498    0.000    0.140    0.224</span></span>
<span id="cb6-55"><a href="ChapBaronKennySem.html#cb6-55" tabindex="-1"></a><span class="co">#   L1                0.199    0.028     7.083    0.000    0.144    0.254</span></span>
<span id="cb6-56"><a href="ChapBaronKennySem.html#cb6-56" tabindex="-1"></a><span class="co"># Y_qol ~</span></span>
<span id="cb6-57"><a href="ChapBaronKennySem.html#cb6-57" tabindex="-1"></a><span class="co">#   L0_male          -0.193    0.214    -0.899    0.369   -0.613    0.227</span></span>
<span id="cb6-58"><a href="ChapBaronKennySem.html#cb6-58" tabindex="-1"></a><span class="co">#   L0_sc_nv         -2.130    0.232    -9.195    0.000   -2.585   -1.676</span></span>
<span id="cb6-59"><a href="ChapBaronKennySem.html#cb6-59" tabindex="-1"></a><span class="co">#   A0_PM2.5 (c.A)   -1.754    0.169   -10.351    0.000   -2.086   -1.422</span></span>
<span id="cb6-60"><a href="ChapBaronKennySem.html#cb6-60" tabindex="-1"></a><span class="co">#   L1               -3.070    0.229   -13.411    0.000   -3.519   -2.621</span></span>
<span id="cb6-61"><a href="ChapBaronKennySem.html#cb6-61" tabindex="-1"></a><span class="co">#   M_diabts (c.M)   -4.927    0.142   -34.802    0.000   -5.204   -4.649</span></span>
<span id="cb6-62"><a href="ChapBaronKennySem.html#cb6-62" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-63"><a href="ChapBaronKennySem.html#cb6-63" tabindex="-1"></a><span class="co"># Covariances:</span></span>
<span id="cb6-64"><a href="ChapBaronKennySem.html#cb6-64" tabindex="-1"></a><span class="co">#   Estimate  Std.Err  z-value   P(&gt;|z|) ci.lower ci.upper</span></span>
<span id="cb6-65"><a href="ChapBaronKennySem.html#cb6-65" tabindex="-1"></a><span class="co"># L0_male ~~</span></span>
<span id="cb6-66"><a href="ChapBaronKennySem.html#cb6-66" tabindex="-1"></a><span class="co">#   L0_soc_env       -0.003    0.002    -1.167    0.243   -0.007    0.002</span></span>
<span id="cb6-67"><a href="ChapBaronKennySem.html#cb6-67" tabindex="-1"></a><span class="co">#   L1               -0.002    0.002    -0.801    0.423   -0.006    0.003</span></span>
<span id="cb6-68"><a href="ChapBaronKennySem.html#cb6-68" tabindex="-1"></a><span class="co"># L0_soc_env ~~</span></span>
<span id="cb6-69"><a href="ChapBaronKennySem.html#cb6-69" tabindex="-1"></a><span class="co">#   L1               -0.001    0.002    -0.425    0.671   -0.005    0.003</span></span>
<span id="cb6-70"><a href="ChapBaronKennySem.html#cb6-70" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-71"><a href="ChapBaronKennySem.html#cb6-71" tabindex="-1"></a><span class="co"># Intercepts:</span></span>
<span id="cb6-72"><a href="ChapBaronKennySem.html#cb6-72" tabindex="-1"></a><span class="co">#                  Estimate  Std.Err  z-value   P(&gt;|z|) ci.lower ci.upper</span></span>
<span id="cb6-73"><a href="ChapBaronKennySem.html#cb6-73" tabindex="-1"></a><span class="co">#  .Y_qol            72.816    0.228   319.590    0.000   72.370   73.263</span></span>
<span id="cb6-74"><a href="ChapBaronKennySem.html#cb6-74" tabindex="-1"></a><span class="co">#   L0_male           0.501    0.005   100.197    0.000    0.491    0.511</span></span>
<span id="cb6-75"><a href="ChapBaronKennySem.html#cb6-75" tabindex="-1"></a><span class="co">#   L0_soc_env        0.644    0.003   187.422    0.000    0.637    0.651</span></span>
<span id="cb6-76"><a href="ChapBaronKennySem.html#cb6-76" tabindex="-1"></a><span class="co">#   L1                0.293    0.002   128.425    0.000    0.289    0.298</span></span>
<span id="cb6-77"><a href="ChapBaronKennySem.html#cb6-77" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-78"><a href="ChapBaronKennySem.html#cb6-78" tabindex="-1"></a><span class="co"># Thresholds:</span></span>
<span id="cb6-79"><a href="ChapBaronKennySem.html#cb6-79" tabindex="-1"></a><span class="co">#                Estimate  Std.Err  z-value   P(&gt;|z|) ci.lower ci.upper</span></span>
<span id="cb6-80"><a href="ChapBaronKennySem.html#cb6-80" tabindex="-1"></a><span class="co"># A0_PM2.5|t1       1.527    0.031    48.583    0.000    1.465    1.589</span></span>
<span id="cb6-81"><a href="ChapBaronKennySem.html#cb6-81" tabindex="-1"></a><span class="co"># M_diabetes|t1     0.810    0.026    30.789    0.000    0.758    0.861</span></span>
<span id="cb6-82"><a href="ChapBaronKennySem.html#cb6-82" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-83"><a href="ChapBaronKennySem.html#cb6-83" tabindex="-1"></a><span class="co"># Variances:</span></span>
<span id="cb6-84"><a href="ChapBaronKennySem.html#cb6-84" tabindex="-1"></a><span class="co">#                  Estimate  Std.Err  z-value   P(&gt;|z|) ci.lower ci.upper</span></span>
<span id="cb6-85"><a href="ChapBaronKennySem.html#cb6-85" tabindex="-1"></a><span class="co">#  .A0_PM2.5          0.965                                0.965    0.965</span></span>
<span id="cb6-86"><a href="ChapBaronKennySem.html#cb6-86" tabindex="-1"></a><span class="co">#  .M_diabetes        0.975                                0.975    0.975</span></span>
<span id="cb6-87"><a href="ChapBaronKennySem.html#cb6-87" tabindex="-1"></a><span class="co">#  .Y_qol            88.521    1.538    57.551    0.000   85.506   91.535</span></span>
<span id="cb6-88"><a href="ChapBaronKennySem.html#cb6-88" tabindex="-1"></a><span class="co">#   L0_male           0.250    0.000 12499.500    0.000    0.250    0.250</span></span>
<span id="cb6-89"><a href="ChapBaronKennySem.html#cb6-89" tabindex="-1"></a><span class="co">#   L0_soc_env        0.229    0.002   106.346    0.000    0.225    0.234</span></span>
<span id="cb6-90"><a href="ChapBaronKennySem.html#cb6-90" tabindex="-1"></a><span class="co">#   L1                0.207    0.002    91.060    0.000    0.203    0.212</span></span>
<span id="cb6-91"><a href="ChapBaronKennySem.html#cb6-91" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb6-92"><a href="ChapBaronKennySem.html#cb6-92" tabindex="-1"></a><span class="co"># Defined Parameters:</span></span>
<span id="cb6-93"><a href="ChapBaronKennySem.html#cb6-93" tabindex="-1"></a><span class="co">#                Estimate  Std.Err  z-value   P(&gt;|z|) ci.lower ci.upper</span></span>
<span id="cb6-94"><a href="ChapBaronKennySem.html#cb6-94" tabindex="-1"></a><span class="co"># direct           -1.754    0.169   -10.351    0.000   -2.086   -1.422</span></span>
<span id="cb6-95"><a href="ChapBaronKennySem.html#cb6-95" tabindex="-1"></a><span class="co"># indirect         -0.896    0.099    -9.041    0.000   -1.091   -0.702</span></span>
<span id="cb6-96"><a href="ChapBaronKennySem.html#cb6-96" tabindex="-1"></a><span class="co"># total            -2.651    0.177   -14.942    0.000   -2.998   -2.303</span></span></code></pre></div>
<p>The results of the direct, indirect and total effects are quite different from the Baron &amp; Kenny estimations and the previous SEM (where categorical exogenous variables were treated as simple dummy variables).</p>
<p>This difference can probably be explained by the fact that the data generating system (used to simulate the data) does not imply latent normal variables underlying the categorical variables. Binary variables were directly simulated using binomial distributions.</p>
<p>If the exposure, mediator and outcome variables are a mix of continuous and categorical variables, <span class="citation">(<a href="#ref-Iacobucci2008">Iacobucci 2008</a>)</span> recommends to treat them as simple dummy variables (and as continuous variables when fitting the models).</p>
</div>
<div id="application-with-intermediate-confounding-affected-by-the-exposure" class="section level3 hasAnchor" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Application with intermediate confounding affected by the exposure<a href="ChapBaronKennySem.html#application-with-intermediate-confounding-affected-by-the-exposure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Under the causal model where the intermediate confounder <span class="math inline">\(L(1)\)</span> of the <span class="math inline">\(M-Y\)</span> relationship is affected by the exposure <span class="math inline">\(A\)</span> (Causal model 2, Figure <a href="data-sets.html#fig:figDAGM2">3.2</a>), we can describe 4 directed paths connecting the exposure to the outcome :</p>
<ol style="list-style-type: lower-roman">
<li>the path <span class="math inline">\(A \rightarrow Y\)</span>,</li>
<li>the path <span class="math inline">\(A \rightarrow L(1) \rightarrow Y\)</span></li>
<li>the path <span class="math inline">\(A \rightarrow M \rightarrow Y\)</span></li>
<li>and the path <span class="math inline">\(A \rightarrow L(1) \rightarrow M \rightarrow Y\)</span></li>
</ol>
<p>In the causal inference literature,</p>
<ul>
<li>the <em>Marginal Randomized (or Interventional) Indirect Effect</em> (MRIE), described by <span class="citation">(<a href="#ref-vanderweele2016">VanderWeele and Tchetgen Tchetgen 2017</a>)</span>, can be considered as an analogue of the set of directed paths from <span class="math inline">\(A\)</span> to <span class="math inline">\(Y\)</span> going through the mediator <span class="math inline">\(M\)</span> (i.e.Â paths (iii) <span class="math inline">\(A \rightarrow M \rightarrow Y\)</span> and (iv) <span class="math inline">\(A \rightarrow L(1) \rightarrow M \rightarrow Y\)</span>)</li>
<li>and the <em>Marginal Randomized (or Interventional) Direct Effect</em> (MRDE), corresponds to the other paths (i.e.Â paths (i) <span class="math inline">\(A \rightarrow Y\)</span> and (ii) <span class="math inline">\(A \rightarrow L(1) \rightarrow Y\)</span>).</li>
</ul>
<p>Regarding the <em>conditional effects</em> described by <span class="citation">(<a href="#ref-zheng2017longitudinal">Zheng and van der Laan 2017</a>)</span>,</p>
<ul>
<li>the <em>Conditional Randomized (or Interventional) Indirect Effect</em> (CRIE), described by <span class="citation">Lin et al. (<a href="#ref-lin2017">2017</a>)</span>, can be considered as an analogue of the specific paths from <span class="math inline">\(A\)</span> to <span class="math inline">\(Y\)</span> going only through the mediator <span class="math inline">\(M\)</span> (i.e.Â path (iii) <span class="math inline">\(A \rightarrow M \rightarrow Y\)</span>)</li>
<li>and the <em>Conditional Randomized (or Interventional) Direct Effect</em> (CRDE), corresponds to the other paths (i.e.Â paths (i) <span class="math inline">\(A \rightarrow Y\)</span> and (ii) <span class="math inline">\(A \rightarrow L(1) \rightarrow Y\)</span> and (iv) <span class="math inline">\(A \rightarrow L(1) \rightarrow M \rightarrow Y\)</span>).</li>
</ul>
<p>We can estimate the 4 paths by SEM analysis. Using the <code>df2.csv</code> dataset (without <span class="math inline">\(A\ast M\)</span> interaction effect on the outcome), we will explore the effect of the exposure to high levels of <span class="math inline">\(\text{PM}_{2.5}\)</span> on quality of life (<span class="math inline">\(Y\)</span>), through type-2 diabetes (mediator of interest <span class="math inline">\(M\)</span>), where overweight <span class="math inline">\(L(1)\)</span> is affected by the exposure.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="ChapBaronKennySem.html#cb7-1" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">&quot;data/df2.csv&quot;</span>)</span>
<span id="cb7-2"><a href="ChapBaronKennySem.html#cb7-2" tabindex="-1"></a><span class="fu">head</span>(df2)</span>
<span id="cb7-3"><a href="ChapBaronKennySem.html#cb7-3" tabindex="-1"></a><span class="co">#   L0_male L0_soc_env A0_PM2.5 L1 M_diabetes Y_death    Y_qol</span></span>
<span id="cb7-4"><a href="ChapBaronKennySem.html#cb7-4" tabindex="-1"></a><span class="co"># 1       0          1        0  1          0       0 91.91819</span></span>
<span id="cb7-5"><a href="ChapBaronKennySem.html#cb7-5" tabindex="-1"></a><span class="co"># 2       1          1        1  0          0       1 67.53221</span></span>
<span id="cb7-6"><a href="ChapBaronKennySem.html#cb7-6" tabindex="-1"></a><span class="co"># 3       1          1        0  0          0       0 75.56249</span></span>
<span id="cb7-7"><a href="ChapBaronKennySem.html#cb7-7" tabindex="-1"></a><span class="co"># 4       1          0        0  0          0       0 89.77055</span></span>
<span id="cb7-8"><a href="ChapBaronKennySem.html#cb7-8" tabindex="-1"></a><span class="co"># 5       1          1        0  1          1       1 63.22353</span></span>
<span id="cb7-9"><a href="ChapBaronKennySem.html#cb7-9" tabindex="-1"></a><span class="co"># 6       1          1        0  1          0       0 77.87975</span></span>
<span id="cb7-10"><a href="ChapBaronKennySem.html#cb7-10" tabindex="-1"></a></span>
<span id="cb7-11"><a href="ChapBaronKennySem.html#cb7-11" tabindex="-1"></a><span class="do">## quality of life ----</span></span>
<span id="cb7-12"><a href="ChapBaronKennySem.html#cb7-12" tabindex="-1"></a><span class="do">## First step: write the model syntax</span></span>
<span id="cb7-13"><a href="ChapBaronKennySem.html#cb7-13" tabindex="-1"></a>sem.QoL.df2 <span class="ot">&lt;-</span> <span class="st">&quot;</span></span>
<span id="cb7-14"><a href="ChapBaronKennySem.html#cb7-14" tabindex="-1"></a><span class="st">  ## SEM for quantitative outcome (QoL)</span></span>
<span id="cb7-15"><a href="ChapBaronKennySem.html#cb7-15" tabindex="-1"></a><span class="st">  # Regression models</span></span>
<span id="cb7-16"><a href="ChapBaronKennySem.html#cb7-16" tabindex="-1"></a><span class="st">    A0_PM2.5 ~ a.L01 * L0_male + a.L02 * L0_soc_env</span></span>
<span id="cb7-17"><a href="ChapBaronKennySem.html#cb7-17" tabindex="-1"></a><span class="st">    L1 ~ b.L01 * L0_male + b.L02 * L0_soc_env + b.A * A0_PM2.5</span></span>
<span id="cb7-18"><a href="ChapBaronKennySem.html#cb7-18" tabindex="-1"></a><span class="st">    M_diabetes ~ c.L01 * L0_male + c.L02 * L0_soc_env + c.A * A0_PM2.5 + c.L1 * L1</span></span>
<span id="cb7-19"><a href="ChapBaronKennySem.html#cb7-19" tabindex="-1"></a><span class="st">    Y_qol ~ d.01 * L0_male + d.02 * L0_soc_env + d.A * A0_PM2.5 + d.L1 * L1 + d.M * M_diabetes</span></span>
<span id="cb7-20"><a href="ChapBaronKennySem.html#cb7-20" tabindex="-1"></a></span>
<span id="cb7-21"><a href="ChapBaronKennySem.html#cb7-21" tabindex="-1"></a><span class="st">  # Assuming the possibility of non-null covariance between confounders</span></span>
<span id="cb7-22"><a href="ChapBaronKennySem.html#cb7-22" tabindex="-1"></a><span class="st">  # (note: in the data-generating system, the null assumptions were true)</span></span>
<span id="cb7-23"><a href="ChapBaronKennySem.html#cb7-23" tabindex="-1"></a><span class="st">    L0_male ~~ L0_soc_env</span></span>
<span id="cb7-24"><a href="ChapBaronKennySem.html#cb7-24" tabindex="-1"></a></span>
<span id="cb7-25"><a href="ChapBaronKennySem.html#cb7-25" tabindex="-1"></a><span class="st">  # define other parameters: specific paths, direct, indirect and total effects</span></span>
<span id="cb7-26"><a href="ChapBaronKennySem.html#cb7-26" tabindex="-1"></a><span class="st">    path.A_Y := d.A</span></span>
<span id="cb7-27"><a href="ChapBaronKennySem.html#cb7-27" tabindex="-1"></a><span class="st">    path.A_L1_Y := b.A * d.L1</span></span>
<span id="cb7-28"><a href="ChapBaronKennySem.html#cb7-28" tabindex="-1"></a><span class="st">    path.A_M_Y := c.A * d.M</span></span>
<span id="cb7-29"><a href="ChapBaronKennySem.html#cb7-29" tabindex="-1"></a><span class="st">    path.A_L1_M_Y := b.A * c.L1 * d.M</span></span>
<span id="cb7-30"><a href="ChapBaronKennySem.html#cb7-30" tabindex="-1"></a><span class="st">    MRDE := d.A + (b.A * d.L1)</span></span>
<span id="cb7-31"><a href="ChapBaronKennySem.html#cb7-31" tabindex="-1"></a><span class="st">    MRIE := (c.A * d.M) + (b.A * c.L1 * d.M)</span></span>
<span id="cb7-32"><a href="ChapBaronKennySem.html#cb7-32" tabindex="-1"></a><span class="st">    CRDE := d.A + (b.A * d.L1) + (b.A * c.L1 * d.M)</span></span>
<span id="cb7-33"><a href="ChapBaronKennySem.html#cb7-33" tabindex="-1"></a><span class="st">    CRIE := (c.A * d.M)</span></span>
<span id="cb7-34"><a href="ChapBaronKennySem.html#cb7-34" tabindex="-1"></a><span class="st">    total := d.A + (b.A * d.L1) + (c.A * d.M) + (b.A * c.L1 * d.M)</span></span>
<span id="cb7-35"><a href="ChapBaronKennySem.html#cb7-35" tabindex="-1"></a><span class="st">  &quot;</span></span>
<span id="cb7-36"><a href="ChapBaronKennySem.html#cb7-36" tabindex="-1"></a></span>
<span id="cb7-37"><a href="ChapBaronKennySem.html#cb7-37" tabindex="-1"></a><span class="do">## Second step: estimate the model with the df2 dataset</span></span>
<span id="cb7-38"><a href="ChapBaronKennySem.html#cb7-38" tabindex="-1"></a>fit.qol.df2 <span class="ot">&lt;-</span> lavaan<span class="sc">::</span><span class="fu">sem</span>(<span class="at">model =</span> sem.QoL.df2,</span>
<span id="cb7-39"><a href="ChapBaronKennySem.html#cb7-39" tabindex="-1"></a>                           <span class="at">se =</span> <span class="st">&quot;robust.sem&quot;</span>, <span class="co"># for sandwich-type SE</span></span>
<span id="cb7-40"><a href="ChapBaronKennySem.html#cb7-40" tabindex="-1"></a>                           <span class="at">fixed.x =</span> <span class="cn">FALSE</span>,</span>
<span id="cb7-41"><a href="ChapBaronKennySem.html#cb7-41" tabindex="-1"></a>                           <span class="at">data =</span> df2)</span>
<span id="cb7-42"><a href="ChapBaronKennySem.html#cb7-42" tabindex="-1"></a><span class="fu">summary</span>(fit.qol.df2,</span>
<span id="cb7-43"><a href="ChapBaronKennySem.html#cb7-43" tabindex="-1"></a>        <span class="at">ci =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-44"><a href="ChapBaronKennySem.html#cb7-44" tabindex="-1"></a><span class="co"># lavaan 0.6-18 ended normally after 18 iterations</span></span>
<span id="cb7-45"><a href="ChapBaronKennySem.html#cb7-45" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-46"><a href="ChapBaronKennySem.html#cb7-46" tabindex="-1"></a><span class="co"># Estimator                                         ML</span></span>
<span id="cb7-47"><a href="ChapBaronKennySem.html#cb7-47" tabindex="-1"></a><span class="co"># Optimization method                           NLMINB</span></span>
<span id="cb7-48"><a href="ChapBaronKennySem.html#cb7-48" tabindex="-1"></a><span class="co"># Number of model parameters                        21</span></span>
<span id="cb7-49"><a href="ChapBaronKennySem.html#cb7-49" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-50"><a href="ChapBaronKennySem.html#cb7-50" tabindex="-1"></a><span class="co"># Number of observations                         10000</span></span>
<span id="cb7-51"><a href="ChapBaronKennySem.html#cb7-51" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-52"><a href="ChapBaronKennySem.html#cb7-52" tabindex="-1"></a><span class="co"># Model Test User Model:</span></span>
<span id="cb7-53"><a href="ChapBaronKennySem.html#cb7-53" tabindex="-1"></a><span class="co">#   Test statistic                                 0.000</span></span>
<span id="cb7-54"><a href="ChapBaronKennySem.html#cb7-54" tabindex="-1"></a><span class="co">#   Degrees of freedom                                 0</span></span>
<span id="cb7-55"><a href="ChapBaronKennySem.html#cb7-55" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-56"><a href="ChapBaronKennySem.html#cb7-56" tabindex="-1"></a><span class="co"># Parameter Estimates:</span></span>
<span id="cb7-57"><a href="ChapBaronKennySem.html#cb7-57" tabindex="-1"></a><span class="co">#   Standard errors                           Robust.sem</span></span>
<span id="cb7-58"><a href="ChapBaronKennySem.html#cb7-58" tabindex="-1"></a><span class="co">#   Information                                 Expected</span></span>
<span id="cb7-59"><a href="ChapBaronKennySem.html#cb7-59" tabindex="-1"></a><span class="co">#   Information saturated (h1) model          Structured</span></span>
<span id="cb7-60"><a href="ChapBaronKennySem.html#cb7-60" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-61"><a href="ChapBaronKennySem.html#cb7-61" tabindex="-1"></a><span class="co"># Regressions:</span></span>
<span id="cb7-62"><a href="ChapBaronKennySem.html#cb7-62" tabindex="-1"></a><span class="co">#                  Estimate  Std.Err  z-value   P(&gt;|z|) ci.lower ci.upper</span></span>
<span id="cb7-63"><a href="ChapBaronKennySem.html#cb7-63" tabindex="-1"></a><span class="co"># A0_PM2.5 ~</span></span>
<span id="cb7-64"><a href="ChapBaronKennySem.html#cb7-64" tabindex="-1"></a><span class="co">#   L0_mal (a.L01)    0.040    0.006     6.339    0.000    0.027    0.052</span></span>
<span id="cb7-65"><a href="ChapBaronKennySem.html#cb7-65" tabindex="-1"></a><span class="co">#   L0_sc_ (a.L02)    0.058    0.006     9.527    0.000    0.046    0.070</span></span>
<span id="cb7-66"><a href="ChapBaronKennySem.html#cb7-66" tabindex="-1"></a><span class="co"># L1 ~</span></span>
<span id="cb7-67"><a href="ChapBaronKennySem.html#cb7-67" tabindex="-1"></a><span class="co">#   L0_mal (b.L01)   -0.043    0.009    -4.638    0.000   -0.062   -0.025</span></span>
<span id="cb7-68"><a href="ChapBaronKennySem.html#cb7-68" tabindex="-1"></a><span class="co">#   L0_sc_ (b.L02)    0.069    0.010     7.166    0.000    0.050    0.088</span></span>
<span id="cb7-69"><a href="ChapBaronKennySem.html#cb7-69" tabindex="-1"></a><span class="co">#   A0_PM2   (b.A)    0.226    0.016    14.373    0.000    0.195    0.257</span></span>
<span id="cb7-70"><a href="ChapBaronKennySem.html#cb7-70" tabindex="-1"></a><span class="co"># M_diabetes ~</span></span>
<span id="cb7-71"><a href="ChapBaronKennySem.html#cb7-71" tabindex="-1"></a><span class="co">#   L0_mal (c.L01)    0.052    0.009     5.662    0.000    0.034    0.070</span></span>
<span id="cb7-72"><a href="ChapBaronKennySem.html#cb7-72" tabindex="-1"></a><span class="co">#   L0_sc_ (c.L02)    0.064    0.010     6.692    0.000    0.045    0.082</span></span>
<span id="cb7-73"><a href="ChapBaronKennySem.html#cb7-73" tabindex="-1"></a><span class="co">#   A0_PM2   (c.A)    0.072    0.016     4.567    0.000    0.041    0.103</span></span>
<span id="cb7-74"><a href="ChapBaronKennySem.html#cb7-74" tabindex="-1"></a><span class="co">#   L1      (c.L1)    0.194    0.010    18.962    0.000    0.174    0.215</span></span>
<span id="cb7-75"><a href="ChapBaronKennySem.html#cb7-75" tabindex="-1"></a><span class="co"># Y_qol ~</span></span>
<span id="cb7-76"><a href="ChapBaronKennySem.html#cb7-76" tabindex="-1"></a><span class="co">#   L0_mal  (d.01)   -0.725    0.202    -3.591    0.000   -1.121   -0.329</span></span>
<span id="cb7-77"><a href="ChapBaronKennySem.html#cb7-77" tabindex="-1"></a><span class="co">#   L0_sc_  (d.02)   -2.881    0.210   -13.722    0.000   -3.292   -2.469</span></span>
<span id="cb7-78"><a href="ChapBaronKennySem.html#cb7-78" tabindex="-1"></a><span class="co">#   A0_PM2   (d.A)   -3.926    0.329   -11.945    0.000   -4.570   -3.282</span></span>
<span id="cb7-79"><a href="ChapBaronKennySem.html#cb7-79" tabindex="-1"></a><span class="co">#   L1      (d.L1)   -5.165    0.217   -23.794    0.000   -5.591   -4.740</span></span>
<span id="cb7-80"><a href="ChapBaronKennySem.html#cb7-80" tabindex="-1"></a><span class="co">#   M_dbts   (d.M)   -8.698    0.217   -40.020    0.000   -9.124   -8.272</span></span>
<span id="cb7-81"><a href="ChapBaronKennySem.html#cb7-81" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-82"><a href="ChapBaronKennySem.html#cb7-82" tabindex="-1"></a><span class="co"># Covariances:</span></span>
<span id="cb7-83"><a href="ChapBaronKennySem.html#cb7-83" tabindex="-1"></a><span class="co">#                  Estimate  Std.Err  z-value   P(&gt;|z|) ci.lower ci.upper</span></span>
<span id="cb7-84"><a href="ChapBaronKennySem.html#cb7-84" tabindex="-1"></a><span class="co"># L0_male ~~</span></span>
<span id="cb7-85"><a href="ChapBaronKennySem.html#cb7-85" tabindex="-1"></a><span class="co">#   L0_soc_env       -0.003    0.002    -1.167    0.243   -0.007    0.002</span></span>
<span id="cb7-86"><a href="ChapBaronKennySem.html#cb7-86" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-87"><a href="ChapBaronKennySem.html#cb7-87" tabindex="-1"></a><span class="co"># Variances:</span></span>
<span id="cb7-88"><a href="ChapBaronKennySem.html#cb7-88" tabindex="-1"></a><span class="co">#                  Estimate  Std.Err  z-value   P(&gt;|z|) ci.lower ci.upper</span></span>
<span id="cb7-89"><a href="ChapBaronKennySem.html#cb7-89" tabindex="-1"></a><span class="co">#  .A0_PM2.5          0.099    0.002    41.100    0.000    0.094    0.103</span></span>
<span id="cb7-90"><a href="ChapBaronKennySem.html#cb7-90" tabindex="-1"></a><span class="co">#  .L1                0.219    0.002   135.196    0.000    0.216    0.222</span></span>
<span id="cb7-91"><a href="ChapBaronKennySem.html#cb7-91" tabindex="-1"></a><span class="co">#  .M_diabetes        0.212    0.002   123.351    0.000    0.208    0.215</span></span>
<span id="cb7-92"><a href="ChapBaronKennySem.html#cb7-92" tabindex="-1"></a><span class="co">#  .Y_qol           100.878    1.409    71.598    0.000   98.117  103.640</span></span>
<span id="cb7-93"><a href="ChapBaronKennySem.html#cb7-93" tabindex="-1"></a><span class="co">#   L0_male           0.250    0.000 24999.950    0.000    0.250    0.250</span></span>
<span id="cb7-94"><a href="ChapBaronKennySem.html#cb7-94" tabindex="-1"></a><span class="co">#   L0_soc_env        0.229    0.001   166.381    0.000    0.227    0.232</span></span>
<span id="cb7-95"><a href="ChapBaronKennySem.html#cb7-95" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-96"><a href="ChapBaronKennySem.html#cb7-96" tabindex="-1"></a><span class="co"># Defined Parameters:</span></span>
<span id="cb7-97"><a href="ChapBaronKennySem.html#cb7-97" tabindex="-1"></a><span class="co">#                Estimate  Std.Err  z-value   P(&gt;|z|) ci.lower ci.upper</span></span>
<span id="cb7-98"><a href="ChapBaronKennySem.html#cb7-98" tabindex="-1"></a><span class="co"># path.A_Y         -3.926    0.329   -11.945    0.000   -4.570   -3.282</span></span>
<span id="cb7-99"><a href="ChapBaronKennySem.html#cb7-99" tabindex="-1"></a><span class="co"># path.A_L1_Y      -1.168    0.095   -12.322    0.000   -1.354   -0.982</span></span>
<span id="cb7-100"><a href="ChapBaronKennySem.html#cb7-100" tabindex="-1"></a><span class="co"># path.A_M_Y       -0.625    0.138    -4.536    0.000   -0.895   -0.355</span></span>
<span id="cb7-101"><a href="ChapBaronKennySem.html#cb7-101" tabindex="-1"></a><span class="co"># path.A_L1_M_Y    -0.382    0.035   -10.999    0.000   -0.451   -0.314</span></span>
<span id="cb7-102"><a href="ChapBaronKennySem.html#cb7-102" tabindex="-1"></a><span class="co"># MRDE             -5.093    0.336   -15.170    0.000   -5.751   -4.435</span></span>
<span id="cb7-103"><a href="ChapBaronKennySem.html#cb7-103" tabindex="-1"></a><span class="co"># MRIE             -1.007    0.139    -7.228    0.000   -1.280   -0.734</span></span>
<span id="cb7-104"><a href="ChapBaronKennySem.html#cb7-104" tabindex="-1"></a><span class="co"># CRDE             -5.476    0.343   -15.942    0.000   -6.149   -4.803</span></span>
<span id="cb7-105"><a href="ChapBaronKennySem.html#cb7-105" tabindex="-1"></a><span class="co"># CRIE             -0.625    0.138    -4.536    0.000   -0.895   -0.355</span></span>
<span id="cb7-106"><a href="ChapBaronKennySem.html#cb7-106" tabindex="-1"></a><span class="co"># total            -6.101    0.370   -16.500    0.000   -6.825   -5.376</span></span></code></pre></div>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Iacobucci2008" class="csl-entry">
Iacobucci, Dawn. 2008. <em>Mediation Analysis</em>. Thousand Oaks, California: Sage.
</div>
<div id="ref-Jak2023" class="csl-entry">
Jak, Suzanne and Jorgensen, Terrence D. 2024. <span>âA âLavaanâ Compendium for Structural Equation Modeling in Educational Research.â</span> <a href="https://tdjorgensen.github.io/SEM-in-Ed-compendium/" class="uri">https://tdjorgensen.github.io/SEM-in-Ed-compendium/</a>.
</div>
<div id="ref-Jiang2023" class="csl-entry">
Jiang, Ge. 2023. <span>âR Cookbook for Structural Equation Modeling.â</span> <a href="https://gabriellajg.github.io/EPSY-579-R-Cookbook-for-SEM/" class="uri">https://gabriellajg.github.io/EPSY-579-R-Cookbook-for-SEM/</a>.
</div>
<div id="ref-lin2017" class="csl-entry">
Lin, Sheng-Hsuan, Jessica Young, Roger Logan, Eric J. Tchetgen Tchetgen, and Tyler J VanderWeele. 2017. <span>âParametric Mediational g-Formula Approach to Mediation Analysis with Time-Varying Exposures, Mediators, and Confounders.â</span> <em>Epidemiology</em> 28 (2): 266â74.
</div>
<div id="ref-vanderweele2016" class="csl-entry">
VanderWeele, Tyler J, and Eric J Tchetgen Tchetgen. 2017. <span>âMediation Analysis with Time Varying Exposures and Mediators.â</span> <em>J R Stat Soc Series B Stat Methodol</em> 79 (3): 917â38.
</div>
<div id="ref-zheng2017longitudinal" class="csl-entry">
Zheng, Wenjing, and Mark van der Laan. 2017. <span>âLongitudinal Mediation Analysis with Time-Varying Mediators and Exposures, with Application to Survival Outcomes.â</span> <em>Journal of Causal Inference</em> 5 (2).
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-sets.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ChapTradRegModels.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/benoitlepage/mediation_workshop/01-baron_kenny_sem.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
