<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Appendix B: Calculation of the true causal quantities | Mediation Workshop</title>
  <meta name="description" content="Expanse project - Mediation workshop. Online complementary document with practical examples in R." />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Appendix B: Calculation of the true causal quantities | Mediation Workshop" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Expanse project - Mediation workshop. Online complementary document with practical examples in R." />
  <meta name="github-repo" content="mediation_workshop" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Appendix B: Calculation of the true causal quantities | Mediation Workshop" />
  
  <meta name="twitter:description" content="Expanse project - Mediation workshop. Online complementary document with practical examples in R." />
  

<meta name="author" content="Benoît Lepage" />


<meta name="date" content="2024-10-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="appendix_a.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Mediation workshop</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="software.html"><a href="software.html"><i class="fa fa-check"></i><b>2</b> Software</a></li>
<li class="chapter" data-level="3" data-path="data-sets.html"><a href="data-sets.html"><i class="fa fa-check"></i><b>3</b> Data sets</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-sets.html"><a href="data-sets.html#general-presentation-of-the-data-used-in-our-examples"><i class="fa fa-check"></i><b>3.1</b> General presentation of the data used in our examples</a></li>
<li class="chapter" data-level="3.2" data-path="data-sets.html"><a href="data-sets.html#data-generating-mechanisms"><i class="fa fa-check"></i><b>3.2</b> Data generating mechanisms</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ChapBaronKennySem.html"><a href="ChapBaronKennySem.html"><i class="fa fa-check"></i><b>4</b> Baron and Kenny, structural equation models</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ChapBaronKennySem.html"><a href="ChapBaronKennySem.html#baron-and-kenny-approach"><i class="fa fa-check"></i><b>4.1</b> Baron and Kenny approach</a></li>
<li class="chapter" data-level="4.2" data-path="ChapBaronKennySem.html"><a href="ChapBaronKennySem.html#path-analysis-and-structural-equation-modeling"><i class="fa fa-check"></i><b>4.2</b> Path analysis and Structural Equation Modeling</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ChapBaronKennySem.html"><a href="ChapBaronKennySem.html#first-application-without-intermediate-confouding-affected-by-the-exposure"><i class="fa fa-check"></i><b>4.2.1</b> First application, without intermediate confouding affected by the exposure</a></li>
<li class="chapter" data-level="4.2.2" data-path="ChapBaronKennySem.html"><a href="ChapBaronKennySem.html#dealing-with-categorical-endogenous-variables"><i class="fa fa-check"></i><b>4.2.2</b> Dealing with categorical endogenous variables</a></li>
<li class="chapter" data-level="4.2.3" data-path="ChapBaronKennySem.html"><a href="ChapBaronKennySem.html#application-with-intermediate-confounding-affected-by-the-exposure"><i class="fa fa-check"></i><b>4.2.3</b> Application with intermediate confounding affected by the exposure</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ChapTradRegModels.html"><a href="ChapTradRegModels.html"><i class="fa fa-check"></i><b>5</b> Traditional regression models</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ChapTradRegModels.html"><a href="ChapTradRegModels.html#estimation-of-the-average-total-effect-ate"><i class="fa fa-check"></i><b>5.1</b> Estimation of the Average Total Effect (ATE)</a></li>
<li class="chapter" data-level="5.2" data-path="ChapTradRegModels.html"><a href="ChapTradRegModels.html#trad2way"><i class="fa fa-check"></i><b>5.2</b> Two-way decomposition</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="ChapTradRegModels.html"><a href="ChapTradRegModels.html#trad2waycde"><i class="fa fa-check"></i><b>5.2.1</b> Controlled Direct Effect</a></li>
<li class="chapter" data-level="5.2.2" data-path="ChapTradRegModels.html"><a href="ChapTradRegModels.html#trad2waynatural"><i class="fa fa-check"></i><b>5.2.2</b> Natural Direct and Indirect effects</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="ChapTradRegModels.html"><a href="ChapTradRegModels.html#trad3way"><i class="fa fa-check"></i><b>5.3</b> Three-way decomposition</a></li>
<li class="chapter" data-level="5.4" data-path="ChapTradRegModels.html"><a href="ChapTradRegModels.html#four-way-decomposition"><i class="fa fa-check"></i><b>5.4</b> Four-way decomposition</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ChapGcomp.html"><a href="ChapGcomp.html"><i class="fa fa-check"></i><b>6</b> G-computation</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ChapGcomp.html"><a href="ChapGcomp.html#estimation-of-the-average-total-effect-ate-1"><i class="fa fa-check"></i><b>6.1</b> Estimation of the Average Total Effect (ATE)</a></li>
<li class="chapter" data-level="6.2" data-path="ChapGcomp.html"><a href="ChapGcomp.html#estimation-of-controlled-direct-effects-cde"><i class="fa fa-check"></i><b>6.2</b> Estimation of Controlled Direct Effects (CDE)</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="ChapGcomp.html"><a href="ChapGcomp.html#ChapGcomp-CDE-param"><i class="fa fa-check"></i><b>6.2.1</b> Parametric g-computation</a></li>
<li class="chapter" data-level="6.2.2" data-path="ChapGcomp.html"><a href="ChapGcomp.html#ChapGcomp-CDE-ICE"><i class="fa fa-check"></i><b>6.2.2</b> G-computation by iterative conditional expectation</a></li>
<li class="chapter" data-level="6.2.3" data-path="ChapGcomp.html"><a href="ChapGcomp.html#sequential-g-estimator"><i class="fa fa-check"></i><b>6.2.3</b> Sequential g-estimator</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="ChapGcomp.html"><a href="ChapGcomp.html#estimation-of-natural-direct-nde-and-indirect-effects-nie"><i class="fa fa-check"></i><b>6.3</b> Estimation of Natural Direct (NDE) and Indirect Effects (NIE)</a></li>
<li class="chapter" data-level="6.4" data-path="ChapGcomp.html"><a href="ChapGcomp.html#estimation-of-marginal-randomizedinterventional-natural-direct-nde-and-indirect-effects-nie"><i class="fa fa-check"></i><b>6.4</b> Estimation of “Marginal” Randomized/Interventional Natural Direct (NDE) and Indirect Effects (NIE)</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="ChapGcomp.html"><a href="ChapGcomp.html#parametric-g-computation"><i class="fa fa-check"></i><b>6.4.1</b> Parametric g-computation</a></li>
<li class="chapter" data-level="6.4.2" data-path="ChapGcomp.html"><a href="ChapGcomp.html#g-computation-by-iterative-conditional-expectation"><i class="fa fa-check"></i><b>6.4.2</b> G-computation by iterative conditional expectation</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="ChapGcomp.html"><a href="ChapGcomp.html#using-the-cmaverse-package-for-2-way-3-way-and-4-way-decomposition"><i class="fa fa-check"></i><b>6.5</b> Using the <code>CMAverse</code> package for 2-way, 3-way and 4-way decomposition</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ChapIptw.html"><a href="ChapIptw.html"><i class="fa fa-check"></i><b>7</b> Inverse Probability of Treatment Weighting (IPTW)</a>
<ul>
<li class="chapter" data-level="7.1" data-path="ChapIptw.html"><a href="ChapIptw.html#estimation-of-the-average-total-effect"><i class="fa fa-check"></i><b>7.1</b> Estimation of the Average total effect</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="ChapIptw.html"><a href="ChapIptw.html#iptw-for-the-ate"><i class="fa fa-check"></i><b>7.1.1</b> IPTW for the ATE</a></li>
<li class="chapter" data-level="7.1.2" data-path="ChapIptw.html"><a href="ChapIptw.html#stabilized-iptw-for-the-ate"><i class="fa fa-check"></i><b>7.1.2</b> Stabilized IPTW for the ATE</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="ChapIptw.html"><a href="ChapIptw.html#estimation-of-the-controlled-direct-effect-cde"><i class="fa fa-check"></i><b>7.2</b> Estimation of the Controlled direct effect (CDE)</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="ChapIptw.html"><a href="ChapIptw.html#iptw-for-the-cde"><i class="fa fa-check"></i><b>7.2.1</b> IPTW for the CDE</a></li>
<li class="chapter" data-level="7.2.2" data-path="ChapIptw.html"><a href="ChapIptw.html#stabilized-iptw-for-the-cde"><i class="fa fa-check"></i><b>7.2.2</b> Stabilized IPTW for the CDE</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="msm_chapter.html"><a href="msm_chapter.html"><i class="fa fa-check"></i><b>8</b> Marginal structural models</a>
<ul>
<li class="chapter" data-level="8.1" data-path="msm_chapter.html"><a href="msm_chapter.html#msm_ATE_paragraph"><i class="fa fa-check"></i><b>8.1</b> MSM for the Average Total Effect (ATE)</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="msm_chapter.html"><a href="msm_chapter.html#expressing-the-ate-using-coefficients-of-an-msm"><i class="fa fa-check"></i><b>8.1.1</b> Expressing the ATE using coefficients of an MSM</a></li>
<li class="chapter" data-level="8.1.2" data-path="msm_chapter.html"><a href="msm_chapter.html#estimation-of-the-msm-coefficients-by-iptw"><i class="fa fa-check"></i><b>8.1.2</b> Estimation of the MSM coefficients by IPTW</a></li>
<li class="chapter" data-level="8.1.3" data-path="msm_chapter.html"><a href="msm_chapter.html#estimation-of-the-msm-coefficients-by-g-computation-imputation"><i class="fa fa-check"></i><b>8.1.3</b> Estimation of the MSM coefficients by G-computation (imputation)</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="msm_chapter.html"><a href="msm_chapter.html#msm_CDE_paragraph"><i class="fa fa-check"></i><b>8.2</b> MSM for Controlled Direct Effects</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="msm_chapter.html"><a href="msm_chapter.html#expressing-the-cde-using-coefficients-of-an-msm"><i class="fa fa-check"></i><b>8.2.1</b> Expressing the CDE using coefficients of an MSM</a></li>
<li class="chapter" data-level="8.2.2" data-path="msm_chapter.html"><a href="msm_chapter.html#estimation-of-the-msm-coefficients-by-iptw-1"><i class="fa fa-check"></i><b>8.2.2</b> Estimation of the MSM coefficients by IPTW</a></li>
<li class="chapter" data-level="8.2.3" data-path="msm_chapter.html"><a href="msm_chapter.html#estimation-of-the-msm-coefficients-by-g-computation"><i class="fa fa-check"></i><b>8.2.3</b> Estimation of the MSM coefficients by G-computation</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="msm_chapter.html"><a href="msm_chapter.html#msm_NDE_NIE_paragraph"><i class="fa fa-check"></i><b>8.3</b> MSM for Natural Direct and Indirect Effects</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="msm_chapter.html"><a href="msm_chapter.html#expressing-the-nde-and-nie-using-coefficients-of-2-msms"><i class="fa fa-check"></i><b>8.3.1</b> Expressing the NDE and NIE using coefficients of 2 MSMs</a></li>
<li class="chapter" data-level="8.3.2" data-path="msm_chapter.html"><a href="msm_chapter.html#estimation-of-the-2-msms-coefficients-by-iptw-for-nde-and-nie"><i class="fa fa-check"></i><b>8.3.2</b> Estimation of the 2 MSMs coefficients by IPTW for NDE and NIE</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chap_tmle.html"><a href="chap_tmle.html"><i class="fa fa-check"></i><b>9</b> Targeted Maximum Likelihood Estimation (TMLE)</a>
<ul>
<li class="chapter" data-level="9.1" data-path="chap_tmle.html"><a href="chap_tmle.html#tmle-for-the-ate"><i class="fa fa-check"></i><b>9.1</b> TMLE for the ATE</a></li>
<li class="chapter" data-level="9.2" data-path="chap_tmle.html"><a href="chap_tmle.html#tmle-of-the-controlled-direct-effect-cde"><i class="fa fa-check"></i><b>9.2</b> TMLE of the Controlled direct effect (CDE)</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="chap_tmle.html"><a href="chap_tmle.html#for-binary-outcomes"><i class="fa fa-check"></i><b>9.2.1</b> For binary outcomes</a></li>
<li class="chapter" data-level="9.2.2" data-path="chap_tmle.html"><a href="chap_tmle.html#for-continuous-outcomes"><i class="fa fa-check"></i><b>9.2.2</b> For continuous outcomes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="appendix_a.html"><a href="appendix_a.html"><i class="fa fa-check"></i><b>10</b> Appendix A: Data generating mechanisms</a>
<ul>
<li class="chapter" data-level="10.1" data-path="appendix_a.html"><a href="appendix_a.html#first-causal-model-data-generating-mechanism-without-mediator-outcome-confounder-affected-by-the-exposure"><i class="fa fa-check"></i><b>10.1</b> First causal model: Data generating mechanism without mediator-outcome confounder affected by the exposure</a></li>
<li class="chapter" data-level="10.2" data-path="appendix_a.html"><a href="appendix_a.html#second-causal-model-data-generating-mechanism-with-mediator-outcome-confounder-affected-by-the-exposure"><i class="fa fa-check"></i><b>10.2</b> Second causal model: Data generating mechanism with mediator-outcome confounder affected by the exposure</a></li>
<li class="chapter" data-level="10.3" data-path="appendix_a.html"><a href="appendix_a.html#simulation-of-the-four-data-sets-used-in-examples"><i class="fa fa-check"></i><b>10.3</b> Simulation of the four data sets used in examples</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="appendix_a.html"><a href="appendix_a.html#data-sets-generated-from-the-causal-model-1"><i class="fa fa-check"></i><b>10.3.1</b> Data sets generated from the causal model 1</a></li>
<li class="chapter" data-level="10.3.2" data-path="appendix_a.html"><a href="appendix_a.html#data-sets-generated-from-the-causal-model-2"><i class="fa fa-check"></i><b>10.3.2</b> Data sets generated from the causal model 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="appendix_b.html"><a href="appendix_b.html"><i class="fa fa-check"></i><b>11</b> Appendix B: Calculation of the true causal quantities</a>
<ul>
<li class="chapter" data-level="11.1" data-path="appendix_b.html"><a href="appendix_b.html#true-causal-quantities-without-mediator-ouctome-confounder-affected-by-the-exposure"><i class="fa fa-check"></i><b>11.1</b> True causal quantities without mediator-ouctome confounder affected by the exposure</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="appendix_b.html"><a href="appendix_b.html#average-total-effects-ate"><i class="fa fa-check"></i><b>11.1.1</b> Average total effects (ATE)</a></li>
<li class="chapter" data-level="11.1.2" data-path="appendix_b.html"><a href="appendix_b.html#controlled-direct-effects-cde"><i class="fa fa-check"></i><b>11.1.2</b> Controlled direct effects (CDE)</a></li>
<li class="chapter" data-level="11.1.3" data-path="appendix_b.html"><a href="appendix_b.html#pure-natural-direct-effect-and-total-natural-indirect-effect"><i class="fa fa-check"></i><b>11.1.3</b> Pure natural direct effect and Total natural indirect effect</a></li>
<li class="chapter" data-level="11.1.4" data-path="appendix_b.html"><a href="appendix_b.html#total-natural-direct-effect-and-pure-natural-indirect-effect"><i class="fa fa-check"></i><b>11.1.4</b> Total natural direct effect and Pure natural indirect effect</a></li>
<li class="chapter" data-level="11.1.5" data-path="appendix_b.html"><a href="appendix_b.html#vanderweeles-3-way-decomposition"><i class="fa fa-check"></i><b>11.1.5</b> Vanderweele’s 3-way decomposition</a></li>
<li class="chapter" data-level="11.1.6" data-path="appendix_b.html"><a href="appendix_b.html#vanderweeles-4-way-decomposition"><i class="fa fa-check"></i><b>11.1.6</b> Vanderweele’s 4-way decomposition</a></li>
<li class="chapter" data-level="11.1.7" data-path="appendix_b.html"><a href="appendix_b.html#marginal-randomized-direct-and-indirect-effects"><i class="fa fa-check"></i><b>11.1.7</b> Marginal randomized direct and indirect effects</a></li>
<li class="chapter" data-level="11.1.8" data-path="appendix_b.html"><a href="appendix_b.html#conditional-randomized-direct-and-indirect-effects"><i class="fa fa-check"></i><b>11.1.8</b> Conditional randomized direct and indirect effects</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="appendix_b.html"><a href="appendix_b.html#true-causal-quantities-with-mediator-outcome-confounder-affected-by-the-exposure"><i class="fa fa-check"></i><b>11.2</b> True causal quantities with mediator-outcome confounder affected by the exposure</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="appendix_b.html"><a href="appendix_b.html#average-total-effects-ate-1"><i class="fa fa-check"></i><b>11.2.1</b> Average total effects (ATE)</a></li>
<li class="chapter" data-level="11.2.2" data-path="appendix_b.html"><a href="appendix_b.html#controlled-direct-effects-cde-1"><i class="fa fa-check"></i><b>11.2.2</b> Controlled direct effects (CDE)</a></li>
<li class="chapter" data-level="11.2.3" data-path="appendix_b.html"><a href="appendix_b.html#marginal-randomized-direct-and-indirect-effects-1"><i class="fa fa-check"></i><b>11.2.3</b> Marginal randomized direct and indirect effects</a></li>
<li class="chapter" data-level="11.2.4" data-path="appendix_b.html"><a href="appendix_b.html#conditional-randomized-direct-and-indirect-effects-1"><i class="fa fa-check"></i><b>11.2.4</b> Conditional randomized direct and indirect effects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Mediation Workshop</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="appendix_b" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">Chapter 11</span> Appendix B: Calculation of the true causal quantities<a href="appendix_b.html#appendix_b" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="true-causal-quantities-without-mediator-ouctome-confounder-affected-by-the-exposure" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> True causal quantities without mediator-ouctome confounder affected by the exposure<a href="appendix_b.html#true-causal-quantities-without-mediator-ouctome-confounder-affected-by-the-exposure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="average-total-effects-ate" class="section level3 hasAnchor" number="11.1.1">
<h3><span class="header-section-number">11.1.1</span> Average total effects (ATE)<a href="appendix_b.html#average-total-effects-ate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following function <code>true.ATE1</code> can be used to run the calculation for the average total effects (ATE).</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="appendix_b.html#cb68-1" tabindex="-1"></a>true.ATE1 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">interaction =</span> <span class="cn">NULL</span>) {</span>
<span id="cb68-2"><a href="appendix_b.html#cb68-2" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">param.causal.model.1</span>(<span class="at">A.M.interaction =</span> interaction)</span>
<span id="cb68-3"><a href="appendix_b.html#cb68-3" tabindex="-1"></a>  </span>
<span id="cb68-4"><a href="appendix_b.html#cb68-4" tabindex="-1"></a>  <span class="co"># binary outcome (death)</span></span>
<span id="cb68-5"><a href="appendix_b.html#cb68-5" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb68-6"><a href="appendix_b.html#cb68-6" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum&quot;</span>)</span>
<span id="cb68-7"><a href="appendix_b.html#cb68-7" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb68-8"><a href="appendix_b.html#cb68-8" tabindex="-1"></a>    S[n,<span class="st">&quot;sum&quot;</span>] <span class="ot">&lt;-</span> ( ( ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-9"><a href="appendix_b.html#cb68-9" tabindex="-1"></a>                      b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-10"><a href="appendix_b.html#cb68-10" tabindex="-1"></a>                      b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-11"><a href="appendix_b.html#cb68-11" tabindex="-1"></a>                      b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb68-12"><a href="appendix_b.html#cb68-12" tabindex="-1"></a>                      b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb68-13"><a href="appendix_b.html#cb68-13" tabindex="-1"></a>                      b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb68-14"><a href="appendix_b.html#cb68-14" tabindex="-1"></a>                      b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb68-15"><a href="appendix_b.html#cb68-15" tabindex="-1"></a>                    (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-16"><a href="appendix_b.html#cb68-16" tabindex="-1"></a>                           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-17"><a href="appendix_b.html#cb68-17" tabindex="-1"></a>                           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-18"><a href="appendix_b.html#cb68-18" tabindex="-1"></a>                           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb68-19"><a href="appendix_b.html#cb68-19" tabindex="-1"></a>                           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb68-20"><a href="appendix_b.html#cb68-20" tabindex="-1"></a>                    (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-21"><a href="appendix_b.html#cb68-21" tabindex="-1"></a>                              b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-22"><a href="appendix_b.html#cb68-22" tabindex="-1"></a>                              b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-23"><a href="appendix_b.html#cb68-23" tabindex="-1"></a>                              b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb68-24"><a href="appendix_b.html#cb68-24" tabindex="-1"></a>                              b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) ) <span class="sc">-</span> </span>
<span id="cb68-25"><a href="appendix_b.html#cb68-25" tabindex="-1"></a>                    ( ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-26"><a href="appendix_b.html#cb68-26" tabindex="-1"></a>                          b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-27"><a href="appendix_b.html#cb68-27" tabindex="-1"></a>                          b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-28"><a href="appendix_b.html#cb68-28" tabindex="-1"></a>                          b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb68-29"><a href="appendix_b.html#cb68-29" tabindex="-1"></a>                          b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb68-30"><a href="appendix_b.html#cb68-30" tabindex="-1"></a>                          b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb68-31"><a href="appendix_b.html#cb68-31" tabindex="-1"></a>                          b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb68-32"><a href="appendix_b.html#cb68-32" tabindex="-1"></a>                        (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-33"><a href="appendix_b.html#cb68-33" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-34"><a href="appendix_b.html#cb68-34" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-35"><a href="appendix_b.html#cb68-35" tabindex="-1"></a>                             b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb68-36"><a href="appendix_b.html#cb68-36" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb68-37"><a href="appendix_b.html#cb68-37" tabindex="-1"></a>                        (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-38"><a href="appendix_b.html#cb68-38" tabindex="-1"></a>                                  b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-39"><a href="appendix_b.html#cb68-39" tabindex="-1"></a>                                  b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-40"><a href="appendix_b.html#cb68-40" tabindex="-1"></a>                                  b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb68-41"><a href="appendix_b.html#cb68-41" tabindex="-1"></a>                                  b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) ) ) <span class="sc">*</span></span>
<span id="cb68-42"><a href="appendix_b.html#cb68-42" tabindex="-1"></a>    ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb68-43"><a href="appendix_b.html#cb68-43" tabindex="-1"></a>    ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb68-44"><a href="appendix_b.html#cb68-44" tabindex="-1"></a>    ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb68-45"><a href="appendix_b.html#cb68-45" tabindex="-1"></a>    ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb68-46"><a href="appendix_b.html#cb68-46" tabindex="-1"></a>    ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb68-47"><a href="appendix_b.html#cb68-47" tabindex="-1"></a>    ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb68-48"><a href="appendix_b.html#cb68-48" tabindex="-1"></a>}</span>
<span id="cb68-49"><a href="appendix_b.html#cb68-49" tabindex="-1"></a></span>
<span id="cb68-50"><a href="appendix_b.html#cb68-50" tabindex="-1"></a>ATE.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb68-51"><a href="appendix_b.html#cb68-51" tabindex="-1"></a></span>
<span id="cb68-52"><a href="appendix_b.html#cb68-52" tabindex="-1"></a></span>
<span id="cb68-53"><a href="appendix_b.html#cb68-53" tabindex="-1"></a><span class="co"># quantitative outcome (QoL)</span></span>
<span id="cb68-54"><a href="appendix_b.html#cb68-54" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb68-55"><a href="appendix_b.html#cb68-55" tabindex="-1"></a><span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum&quot;</span>)</span>
<span id="cb68-56"><a href="appendix_b.html#cb68-56" tabindex="-1"></a><span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb68-57"><a href="appendix_b.html#cb68-57" tabindex="-1"></a>  S[n,<span class="st">&quot;sum&quot;</span>] <span class="ot">&lt;-</span> ( ( ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-58"><a href="appendix_b.html#cb68-58" tabindex="-1"></a>                        b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-59"><a href="appendix_b.html#cb68-59" tabindex="-1"></a>                        b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb68-60"><a href="appendix_b.html#cb68-60" tabindex="-1"></a>                        b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb68-61"><a href="appendix_b.html#cb68-61" tabindex="-1"></a>                        b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb68-62"><a href="appendix_b.html#cb68-62" tabindex="-1"></a>                        b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-63"><a href="appendix_b.html#cb68-63" tabindex="-1"></a>                        b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb68-64"><a href="appendix_b.html#cb68-64" tabindex="-1"></a>                      (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-65"><a href="appendix_b.html#cb68-65" tabindex="-1"></a>                           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-66"><a href="appendix_b.html#cb68-66" tabindex="-1"></a>                           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-67"><a href="appendix_b.html#cb68-67" tabindex="-1"></a>                           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb68-68"><a href="appendix_b.html#cb68-68" tabindex="-1"></a>                           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb68-69"><a href="appendix_b.html#cb68-69" tabindex="-1"></a>                      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-70"><a href="appendix_b.html#cb68-70" tabindex="-1"></a>                                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-71"><a href="appendix_b.html#cb68-71" tabindex="-1"></a>                                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-72"><a href="appendix_b.html#cb68-72" tabindex="-1"></a>                                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb68-73"><a href="appendix_b.html#cb68-73" tabindex="-1"></a>                                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) ) <span class="sc">-</span> </span>
<span id="cb68-74"><a href="appendix_b.html#cb68-74" tabindex="-1"></a>                    ( ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-75"><a href="appendix_b.html#cb68-75" tabindex="-1"></a>                          b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-76"><a href="appendix_b.html#cb68-76" tabindex="-1"></a>                          b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb68-77"><a href="appendix_b.html#cb68-77" tabindex="-1"></a>                          b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb68-78"><a href="appendix_b.html#cb68-78" tabindex="-1"></a>                          b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb68-79"><a href="appendix_b.html#cb68-79" tabindex="-1"></a>                          b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-80"><a href="appendix_b.html#cb68-80" tabindex="-1"></a>                          b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb68-81"><a href="appendix_b.html#cb68-81" tabindex="-1"></a>                        (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-82"><a href="appendix_b.html#cb68-82" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-83"><a href="appendix_b.html#cb68-83" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-84"><a href="appendix_b.html#cb68-84" tabindex="-1"></a>                             b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb68-85"><a href="appendix_b.html#cb68-85" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb68-86"><a href="appendix_b.html#cb68-86" tabindex="-1"></a>                        (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-87"><a href="appendix_b.html#cb68-87" tabindex="-1"></a>                                  b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-88"><a href="appendix_b.html#cb68-88" tabindex="-1"></a>                                  b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb68-89"><a href="appendix_b.html#cb68-89" tabindex="-1"></a>                                  b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb68-90"><a href="appendix_b.html#cb68-90" tabindex="-1"></a>                                  b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) ) ) <span class="sc">*</span></span>
<span id="cb68-91"><a href="appendix_b.html#cb68-91" tabindex="-1"></a>    ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb68-92"><a href="appendix_b.html#cb68-92" tabindex="-1"></a>    ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb68-93"><a href="appendix_b.html#cb68-93" tabindex="-1"></a>    ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb68-94"><a href="appendix_b.html#cb68-94" tabindex="-1"></a>    ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb68-95"><a href="appendix_b.html#cb68-95" tabindex="-1"></a>    ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb68-96"><a href="appendix_b.html#cb68-96" tabindex="-1"></a>    ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb68-97"><a href="appendix_b.html#cb68-97" tabindex="-1"></a>}</span>
<span id="cb68-98"><a href="appendix_b.html#cb68-98" tabindex="-1"></a></span>
<span id="cb68-99"><a href="appendix_b.html#cb68-99" tabindex="-1"></a>ATE.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb68-100"><a href="appendix_b.html#cb68-100" tabindex="-1"></a></span>
<span id="cb68-101"><a href="appendix_b.html#cb68-101" tabindex="-1"></a><span class="fu">return</span>(<span class="fu">list</span>(<span class="at">ATE.death =</span> ATE.death, <span class="at">ATE.qol =</span> ATE.qol))</span>
<span id="cb68-102"><a href="appendix_b.html#cb68-102" tabindex="-1"></a>  </span>
<span id="cb68-103"><a href="appendix_b.html#cb68-103" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="appendix_b.html#cb69-1" tabindex="-1"></a>true.ATE1.no.inter <span class="ot">&lt;-</span> <span class="fu">true.ATE1</span>(<span class="at">interaction =</span> <span class="dv">0</span>)</span>
<span id="cb69-2"><a href="appendix_b.html#cb69-2" tabindex="-1"></a></span>
<span id="cb69-3"><a href="appendix_b.html#cb69-3" tabindex="-1"></a>true.ATE1.with.inter <span class="ot">&lt;-</span> <span class="fu">true.ATE1</span>(<span class="at">interaction =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>The average total effects <span class="math inline">\(\text{ATE} = \mathbb{E}(Y_1) - \mathbb{E}(Y_0)\)</span> are:</p>
<ul>
<li>0.058 for death and -4.9 for quality of life without interaction;</li>
<li>0.06955 for death and -6.825 for quality of life with interaction.</li>
</ul>
</div>
<div id="controlled-direct-effects-cde" class="section level3 hasAnchor" number="11.1.2">
<h3><span class="header-section-number">11.1.2</span> Controlled direct effects (CDE)<a href="appendix_b.html#controlled-direct-effects-cde" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following function <code>true.CDE1</code> can be used to run the calculation for controlled direct effects (CDE).</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="appendix_b.html#cb70-1" tabindex="-1"></a>true.CDE1 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">interaction =</span> <span class="cn">NULL</span>) {</span>
<span id="cb70-2"><a href="appendix_b.html#cb70-2" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">param.causal.model.1</span>(<span class="at">A.M.interaction =</span> interaction)</span>
<span id="cb70-3"><a href="appendix_b.html#cb70-3" tabindex="-1"></a>  </span>
<span id="cb70-4"><a href="appendix_b.html#cb70-4" tabindex="-1"></a>  <span class="co"># binary outcome (death)</span></span>
<span id="cb70-5"><a href="appendix_b.html#cb70-5" tabindex="-1"></a>  <span class="co"># we estimate both CDE, fixing do(M) = 0 et do(M) = 1 and </span></span>
<span id="cb70-6"><a href="appendix_b.html#cb70-6" tabindex="-1"></a>  <span class="co"># using the corresponding lines in the S matrix</span></span>
<span id="cb70-7"><a href="appendix_b.html#cb70-7" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb70-8"><a href="appendix_b.html#cb70-8" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum&quot;</span>)</span>
<span id="cb70-9"><a href="appendix_b.html#cb70-9" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb70-10"><a href="appendix_b.html#cb70-10" tabindex="-1"></a>    S[n,<span class="st">&quot;sum&quot;</span>] <span class="ot">&lt;-</span> ( ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb70-11"><a href="appendix_b.html#cb70-11" tabindex="-1"></a>                        b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb70-12"><a href="appendix_b.html#cb70-12" tabindex="-1"></a>                        b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb70-13"><a href="appendix_b.html#cb70-13" tabindex="-1"></a>                        b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb70-14"><a href="appendix_b.html#cb70-14" tabindex="-1"></a>                        b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb70-15"><a href="appendix_b.html#cb70-15" tabindex="-1"></a>                        b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb70-16"><a href="appendix_b.html#cb70-16" tabindex="-1"></a>                        b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb70-17"><a href="appendix_b.html#cb70-17" tabindex="-1"></a>                      ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb70-18"><a href="appendix_b.html#cb70-18" tabindex="-1"></a>                          b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb70-19"><a href="appendix_b.html#cb70-19" tabindex="-1"></a>                          b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb70-20"><a href="appendix_b.html#cb70-20" tabindex="-1"></a>                          b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb70-21"><a href="appendix_b.html#cb70-21" tabindex="-1"></a>                          b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb70-22"><a href="appendix_b.html#cb70-22" tabindex="-1"></a>                          b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb70-23"><a href="appendix_b.html#cb70-23" tabindex="-1"></a>                          b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) ) <span class="sc">*</span></span>
<span id="cb70-24"><a href="appendix_b.html#cb70-24" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb70-25"><a href="appendix_b.html#cb70-25" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb70-26"><a href="appendix_b.html#cb70-26" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb70-27"><a href="appendix_b.html#cb70-27" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb70-28"><a href="appendix_b.html#cb70-28" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb70-29"><a href="appendix_b.html#cb70-29" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb70-30"><a href="appendix_b.html#cb70-30" tabindex="-1"></a>    }</span>
<span id="cb70-31"><a href="appendix_b.html#cb70-31" tabindex="-1"></a>  </span>
<span id="cb70-32"><a href="appendix_b.html#cb70-32" tabindex="-1"></a>  CDE.M0.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb70-33"><a href="appendix_b.html#cb70-33" tabindex="-1"></a>  CDE.M1.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[<span class="dv">9</span><span class="sc">:</span><span class="dv">16</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb70-34"><a href="appendix_b.html#cb70-34" tabindex="-1"></a>  </span>
<span id="cb70-35"><a href="appendix_b.html#cb70-35" tabindex="-1"></a>  <span class="co"># quantitative outcome (QoL)</span></span>
<span id="cb70-36"><a href="appendix_b.html#cb70-36" tabindex="-1"></a>  <span class="co"># we estimate both CDE, fixing do(M) = 0 et do(M) = 1 and using </span></span>
<span id="cb70-37"><a href="appendix_b.html#cb70-37" tabindex="-1"></a>  <span class="co"># the corresponding lines in the S matrix</span></span>
<span id="cb70-38"><a href="appendix_b.html#cb70-38" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb70-39"><a href="appendix_b.html#cb70-39" tabindex="-1"></a>    S[n,<span class="st">&quot;sum&quot;</span>] <span class="ot">&lt;-</span> ( ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb70-40"><a href="appendix_b.html#cb70-40" tabindex="-1"></a>                        b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb70-41"><a href="appendix_b.html#cb70-41" tabindex="-1"></a>                        b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb70-42"><a href="appendix_b.html#cb70-42" tabindex="-1"></a>                        b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb70-43"><a href="appendix_b.html#cb70-43" tabindex="-1"></a>                        b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb70-44"><a href="appendix_b.html#cb70-44" tabindex="-1"></a>                        b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb70-45"><a href="appendix_b.html#cb70-45" tabindex="-1"></a>                        b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb70-46"><a href="appendix_b.html#cb70-46" tabindex="-1"></a>                      ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb70-47"><a href="appendix_b.html#cb70-47" tabindex="-1"></a>                          b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb70-48"><a href="appendix_b.html#cb70-48" tabindex="-1"></a>                          b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb70-49"><a href="appendix_b.html#cb70-49" tabindex="-1"></a>                          b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb70-50"><a href="appendix_b.html#cb70-50" tabindex="-1"></a>                          b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb70-51"><a href="appendix_b.html#cb70-51" tabindex="-1"></a>                          b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb70-52"><a href="appendix_b.html#cb70-52" tabindex="-1"></a>                          b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) ) <span class="sc">*</span></span>
<span id="cb70-53"><a href="appendix_b.html#cb70-53" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb70-54"><a href="appendix_b.html#cb70-54" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb70-55"><a href="appendix_b.html#cb70-55" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb70-56"><a href="appendix_b.html#cb70-56" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb70-57"><a href="appendix_b.html#cb70-57" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb70-58"><a href="appendix_b.html#cb70-58" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb70-59"><a href="appendix_b.html#cb70-59" tabindex="-1"></a>    }</span>
<span id="cb70-60"><a href="appendix_b.html#cb70-60" tabindex="-1"></a>  </span>
<span id="cb70-61"><a href="appendix_b.html#cb70-61" tabindex="-1"></a>  CDE.M0.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb70-62"><a href="appendix_b.html#cb70-62" tabindex="-1"></a>  CDE.M1.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[<span class="dv">9</span><span class="sc">:</span><span class="dv">16</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb70-63"><a href="appendix_b.html#cb70-63" tabindex="-1"></a>  </span>
<span id="cb70-64"><a href="appendix_b.html#cb70-64" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">CDE.M0.death =</span> CDE.M0.death, <span class="at">CDE.M1.death =</span> CDE.M1.death, </span>
<span id="cb70-65"><a href="appendix_b.html#cb70-65" tabindex="-1"></a>              <span class="at">CDE.M0.qol =</span> CDE.M0.qol, <span class="at">CDE.M1.qol =</span> CDE.M1.qol))</span>
<span id="cb70-66"><a href="appendix_b.html#cb70-66" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="appendix_b.html#cb71-1" tabindex="-1"></a>true.CDE1.no.inter <span class="ot">&lt;-</span> <span class="fu">true.CDE1</span>(<span class="at">interaction =</span> <span class="dv">0</span>)</span>
<span id="cb71-2"><a href="appendix_b.html#cb71-2" tabindex="-1"></a></span>
<span id="cb71-3"><a href="appendix_b.html#cb71-3" tabindex="-1"></a>true.CDE1.with.inter <span class="ot">&lt;-</span> <span class="fu">true.CDE1</span>(<span class="at">interaction =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>Setting <span class="math inline">\(do(M=0)\)</span>, the controlled direct effects <span class="math inline">\(\text{CDE}_{M=0} = \mathbb{E}\left(Y_{1,0} \right) - \mathbb{E}\left(Y_{0,0} \right)\)</span> are:</p>
<ul>
<li>0.05 for death and -4 for quality of life without interaction,</li>
<li>0.05 for death and -4 for quality of life with interaction.</li>
</ul>
<p>Setting <span class="math inline">\(do(M=1)\)</span>, the controlled direct effects <span class="math inline">\(\text{CDE}_{M=1} = \mathbb{E}\left(Y_{1,1} \right) - \mathbb{E}\left(Y_{0,1} \right)\)</span> are:</p>
<ul>
<li>0.05 for death and -4 for quality of life without interaction,</li>
<li>0.08 for death and -9 for quality of life with interaction.</li>
</ul>
</div>
<div id="pure-natural-direct-effect-and-total-natural-indirect-effect" class="section level3 hasAnchor" number="11.1.3">
<h3><span class="header-section-number">11.1.3</span> Pure natural direct effect and Total natural indirect effect<a href="appendix_b.html#pure-natural-direct-effect-and-total-natural-indirect-effect" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following function <code>true.PNDE.TNIE1</code> can be used to run the calculation for pure natural direct effects (PNDE) and total natural indirect effects (TNIE).</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="appendix_b.html#cb72-1" tabindex="-1"></a>true.PNDE.TNIE1 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">interaction =</span> <span class="cn">NULL</span>) {</span>
<span id="cb72-2"><a href="appendix_b.html#cb72-2" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">param.causal.model.1</span>(<span class="at">A.M.interaction =</span> interaction)</span>
<span id="cb72-3"><a href="appendix_b.html#cb72-3" tabindex="-1"></a>  </span>
<span id="cb72-4"><a href="appendix_b.html#cb72-4" tabindex="-1"></a>  <span class="co"># binary outcome (death)</span></span>
<span id="cb72-5"><a href="appendix_b.html#cb72-5" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb72-6"><a href="appendix_b.html#cb72-6" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum.pnde&quot;</span>, <span class="st">&quot;sum.tnie&quot;</span>)</span>
<span id="cb72-7"><a href="appendix_b.html#cb72-7" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb72-8"><a href="appendix_b.html#cb72-8" tabindex="-1"></a>    <span class="co"># PNDE </span></span>
<span id="cb72-9"><a href="appendix_b.html#cb72-9" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.pnde&quot;</span>] <span class="ot">&lt;-</span> ( ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-10"><a href="appendix_b.html#cb72-10" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-11"><a href="appendix_b.html#cb72-11" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-12"><a href="appendix_b.html#cb72-12" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb72-13"><a href="appendix_b.html#cb72-13" tabindex="-1"></a>                             b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-14"><a href="appendix_b.html#cb72-14" tabindex="-1"></a>                             b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-15"><a href="appendix_b.html#cb72-15" tabindex="-1"></a>                             b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb72-16"><a href="appendix_b.html#cb72-16" tabindex="-1"></a>                           ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-17"><a href="appendix_b.html#cb72-17" tabindex="-1"></a>                               b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-18"><a href="appendix_b.html#cb72-18" tabindex="-1"></a>                               b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-19"><a href="appendix_b.html#cb72-19" tabindex="-1"></a>                               b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb72-20"><a href="appendix_b.html#cb72-20" tabindex="-1"></a>                               b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-21"><a href="appendix_b.html#cb72-21" tabindex="-1"></a>                               b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-22"><a href="appendix_b.html#cb72-22" tabindex="-1"></a>                               b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) ) <span class="sc">*</span></span>
<span id="cb72-23"><a href="appendix_b.html#cb72-23" tabindex="-1"></a>      (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-24"><a href="appendix_b.html#cb72-24" tabindex="-1"></a>           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-25"><a href="appendix_b.html#cb72-25" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-26"><a href="appendix_b.html#cb72-26" tabindex="-1"></a>           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-27"><a href="appendix_b.html#cb72-27" tabindex="-1"></a>           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span> </span>
<span id="cb72-28"><a href="appendix_b.html#cb72-28" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-29"><a href="appendix_b.html#cb72-29" tabindex="-1"></a>                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-30"><a href="appendix_b.html#cb72-30" tabindex="-1"></a>                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-31"><a href="appendix_b.html#cb72-31" tabindex="-1"></a>                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-32"><a href="appendix_b.html#cb72-32" tabindex="-1"></a>                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] ))  <span class="sc">*</span></span>
<span id="cb72-33"><a href="appendix_b.html#cb72-33" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb72-34"><a href="appendix_b.html#cb72-34" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb72-35"><a href="appendix_b.html#cb72-35" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb72-36"><a href="appendix_b.html#cb72-36" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb72-37"><a href="appendix_b.html#cb72-37" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb72-38"><a href="appendix_b.html#cb72-38" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb72-39"><a href="appendix_b.html#cb72-39" tabindex="-1"></a>    </span>
<span id="cb72-40"><a href="appendix_b.html#cb72-40" tabindex="-1"></a>    <span class="co"># TNIE </span></span>
<span id="cb72-41"><a href="appendix_b.html#cb72-41" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.tnie&quot;</span>] <span class="ot">&lt;-</span> ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-42"><a href="appendix_b.html#cb72-42" tabindex="-1"></a>                           b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-43"><a href="appendix_b.html#cb72-43" tabindex="-1"></a>                           b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-44"><a href="appendix_b.html#cb72-44" tabindex="-1"></a>                           b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb72-45"><a href="appendix_b.html#cb72-45" tabindex="-1"></a>                           b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-46"><a href="appendix_b.html#cb72-46" tabindex="-1"></a>                           b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-47"><a href="appendix_b.html#cb72-47" tabindex="-1"></a>                           b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb72-48"><a href="appendix_b.html#cb72-48" tabindex="-1"></a>      ( (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-49"><a href="appendix_b.html#cb72-49" tabindex="-1"></a>             b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-50"><a href="appendix_b.html#cb72-50" tabindex="-1"></a>             b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-51"><a href="appendix_b.html#cb72-51" tabindex="-1"></a>             b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-52"><a href="appendix_b.html#cb72-52" tabindex="-1"></a>             b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">+</span></span>
<span id="cb72-53"><a href="appendix_b.html#cb72-53" tabindex="-1"></a>          (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-54"><a href="appendix_b.html#cb72-54" tabindex="-1"></a>                    b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-55"><a href="appendix_b.html#cb72-55" tabindex="-1"></a>                    b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-56"><a href="appendix_b.html#cb72-56" tabindex="-1"></a>                    b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-57"><a href="appendix_b.html#cb72-57" tabindex="-1"></a>                    b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">-</span></span>
<span id="cb72-58"><a href="appendix_b.html#cb72-58" tabindex="-1"></a>          (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-59"><a href="appendix_b.html#cb72-59" tabindex="-1"></a>               b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-60"><a href="appendix_b.html#cb72-60" tabindex="-1"></a>               b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-61"><a href="appendix_b.html#cb72-61" tabindex="-1"></a>               b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-62"><a href="appendix_b.html#cb72-62" tabindex="-1"></a>               b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">-</span> </span>
<span id="cb72-63"><a href="appendix_b.html#cb72-63" tabindex="-1"></a>          (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-64"><a href="appendix_b.html#cb72-64" tabindex="-1"></a>                    b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-65"><a href="appendix_b.html#cb72-65" tabindex="-1"></a>                    b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-66"><a href="appendix_b.html#cb72-66" tabindex="-1"></a>                    b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-67"><a href="appendix_b.html#cb72-67" tabindex="-1"></a>                    b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) ) <span class="sc">*</span></span>
<span id="cb72-68"><a href="appendix_b.html#cb72-68" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb72-69"><a href="appendix_b.html#cb72-69" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb72-70"><a href="appendix_b.html#cb72-70" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb72-71"><a href="appendix_b.html#cb72-71" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb72-72"><a href="appendix_b.html#cb72-72" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb72-73"><a href="appendix_b.html#cb72-73" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb72-74"><a href="appendix_b.html#cb72-74" tabindex="-1"></a>    }</span>
<span id="cb72-75"><a href="appendix_b.html#cb72-75" tabindex="-1"></a>  </span>
<span id="cb72-76"><a href="appendix_b.html#cb72-76" tabindex="-1"></a>  PNDE.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.pnde&quot;</span>])</span>
<span id="cb72-77"><a href="appendix_b.html#cb72-77" tabindex="-1"></a>  TNIE.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.tnie&quot;</span>])</span>
<span id="cb72-78"><a href="appendix_b.html#cb72-78" tabindex="-1"></a>  </span>
<span id="cb72-79"><a href="appendix_b.html#cb72-79" tabindex="-1"></a>  </span>
<span id="cb72-80"><a href="appendix_b.html#cb72-80" tabindex="-1"></a>  <span class="co"># quantitative outcome (QoL)</span></span>
<span id="cb72-81"><a href="appendix_b.html#cb72-81" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb72-82"><a href="appendix_b.html#cb72-82" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum.pnde&quot;</span>, <span class="st">&quot;sum.tnie&quot;</span>)</span>
<span id="cb72-83"><a href="appendix_b.html#cb72-83" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb72-84"><a href="appendix_b.html#cb72-84" tabindex="-1"></a>    <span class="co"># PNDE </span></span>
<span id="cb72-85"><a href="appendix_b.html#cb72-85" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.pnde&quot;</span>] <span class="ot">&lt;-</span> ( ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-86"><a href="appendix_b.html#cb72-86" tabindex="-1"></a>                             b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-87"><a href="appendix_b.html#cb72-87" tabindex="-1"></a>                             b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-88"><a href="appendix_b.html#cb72-88" tabindex="-1"></a>                             b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb72-89"><a href="appendix_b.html#cb72-89" tabindex="-1"></a>                             b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-90"><a href="appendix_b.html#cb72-90" tabindex="-1"></a>                             b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-91"><a href="appendix_b.html#cb72-91" tabindex="-1"></a>                             b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb72-92"><a href="appendix_b.html#cb72-92" tabindex="-1"></a>                           ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-93"><a href="appendix_b.html#cb72-93" tabindex="-1"></a>                               b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-94"><a href="appendix_b.html#cb72-94" tabindex="-1"></a>                               b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-95"><a href="appendix_b.html#cb72-95" tabindex="-1"></a>                               b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb72-96"><a href="appendix_b.html#cb72-96" tabindex="-1"></a>                               b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-97"><a href="appendix_b.html#cb72-97" tabindex="-1"></a>                               b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-98"><a href="appendix_b.html#cb72-98" tabindex="-1"></a>                               b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) ) <span class="sc">*</span></span>
<span id="cb72-99"><a href="appendix_b.html#cb72-99" tabindex="-1"></a>      (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-100"><a href="appendix_b.html#cb72-100" tabindex="-1"></a>           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-101"><a href="appendix_b.html#cb72-101" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-102"><a href="appendix_b.html#cb72-102" tabindex="-1"></a>           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-103"><a href="appendix_b.html#cb72-103" tabindex="-1"></a>           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span> </span>
<span id="cb72-104"><a href="appendix_b.html#cb72-104" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-105"><a href="appendix_b.html#cb72-105" tabindex="-1"></a>                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-106"><a href="appendix_b.html#cb72-106" tabindex="-1"></a>                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-107"><a href="appendix_b.html#cb72-107" tabindex="-1"></a>                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-108"><a href="appendix_b.html#cb72-108" tabindex="-1"></a>                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] ))  <span class="sc">*</span></span>
<span id="cb72-109"><a href="appendix_b.html#cb72-109" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb72-110"><a href="appendix_b.html#cb72-110" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb72-111"><a href="appendix_b.html#cb72-111" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb72-112"><a href="appendix_b.html#cb72-112" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb72-113"><a href="appendix_b.html#cb72-113" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb72-114"><a href="appendix_b.html#cb72-114" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb72-115"><a href="appendix_b.html#cb72-115" tabindex="-1"></a>    </span>
<span id="cb72-116"><a href="appendix_b.html#cb72-116" tabindex="-1"></a>    <span class="co"># TNIE </span></span>
<span id="cb72-117"><a href="appendix_b.html#cb72-117" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.tnie&quot;</span>] <span class="ot">&lt;-</span> ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-118"><a href="appendix_b.html#cb72-118" tabindex="-1"></a>                           b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-119"><a href="appendix_b.html#cb72-119" tabindex="-1"></a>                           b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-120"><a href="appendix_b.html#cb72-120" tabindex="-1"></a>                           b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb72-121"><a href="appendix_b.html#cb72-121" tabindex="-1"></a>                           b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-122"><a href="appendix_b.html#cb72-122" tabindex="-1"></a>                           b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-123"><a href="appendix_b.html#cb72-123" tabindex="-1"></a>                           b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb72-124"><a href="appendix_b.html#cb72-124" tabindex="-1"></a>      ( (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-125"><a href="appendix_b.html#cb72-125" tabindex="-1"></a>             b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-126"><a href="appendix_b.html#cb72-126" tabindex="-1"></a>             b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-127"><a href="appendix_b.html#cb72-127" tabindex="-1"></a>             b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-128"><a href="appendix_b.html#cb72-128" tabindex="-1"></a>             b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">+</span></span>
<span id="cb72-129"><a href="appendix_b.html#cb72-129" tabindex="-1"></a>          (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-130"><a href="appendix_b.html#cb72-130" tabindex="-1"></a>                    b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-131"><a href="appendix_b.html#cb72-131" tabindex="-1"></a>                    b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-132"><a href="appendix_b.html#cb72-132" tabindex="-1"></a>                    b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-133"><a href="appendix_b.html#cb72-133" tabindex="-1"></a>                    b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">-</span></span>
<span id="cb72-134"><a href="appendix_b.html#cb72-134" tabindex="-1"></a>          (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-135"><a href="appendix_b.html#cb72-135" tabindex="-1"></a>               b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-136"><a href="appendix_b.html#cb72-136" tabindex="-1"></a>               b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-137"><a href="appendix_b.html#cb72-137" tabindex="-1"></a>               b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-138"><a href="appendix_b.html#cb72-138" tabindex="-1"></a>               b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">-</span> </span>
<span id="cb72-139"><a href="appendix_b.html#cb72-139" tabindex="-1"></a>          (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-140"><a href="appendix_b.html#cb72-140" tabindex="-1"></a>                    b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-141"><a href="appendix_b.html#cb72-141" tabindex="-1"></a>                    b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb72-142"><a href="appendix_b.html#cb72-142" tabindex="-1"></a>                    b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb72-143"><a href="appendix_b.html#cb72-143" tabindex="-1"></a>                    b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) ) <span class="sc">*</span></span>
<span id="cb72-144"><a href="appendix_b.html#cb72-144" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb72-145"><a href="appendix_b.html#cb72-145" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb72-146"><a href="appendix_b.html#cb72-146" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb72-147"><a href="appendix_b.html#cb72-147" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb72-148"><a href="appendix_b.html#cb72-148" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb72-149"><a href="appendix_b.html#cb72-149" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb72-150"><a href="appendix_b.html#cb72-150" tabindex="-1"></a>    }</span>
<span id="cb72-151"><a href="appendix_b.html#cb72-151" tabindex="-1"></a>  </span>
<span id="cb72-152"><a href="appendix_b.html#cb72-152" tabindex="-1"></a>  PNDE.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.pnde&quot;</span>])</span>
<span id="cb72-153"><a href="appendix_b.html#cb72-153" tabindex="-1"></a>  TNIE.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.tnie&quot;</span>])</span>
<span id="cb72-154"><a href="appendix_b.html#cb72-154" tabindex="-1"></a>  </span>
<span id="cb72-155"><a href="appendix_b.html#cb72-155" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">PNDE.death =</span> PNDE.death, <span class="at">TNIE.death =</span> TNIE.death, </span>
<span id="cb72-156"><a href="appendix_b.html#cb72-156" tabindex="-1"></a>              <span class="at">PNDE.qol =</span> PNDE.qol, <span class="at">TNIE.qol =</span> TNIE.qol))</span>
<span id="cb72-157"><a href="appendix_b.html#cb72-157" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="appendix_b.html#cb73-1" tabindex="-1"></a>true.PNDE.TNIE.no.inter <span class="ot">&lt;-</span> <span class="fu">true.PNDE.TNIE1</span>(<span class="at">interaction =</span> <span class="dv">0</span>)</span>
<span id="cb73-2"><a href="appendix_b.html#cb73-2" tabindex="-1"></a></span>
<span id="cb73-3"><a href="appendix_b.html#cb73-3" tabindex="-1"></a>true.PNDE.TNIE.with.inter <span class="ot">&lt;-</span> <span class="fu">true.PNDE.TNIE1</span>(<span class="at">interaction =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>The <span class="math inline">\(\text{PNDE}=\mathbb{E}\left( Y_{1,M_0}\right) - \mathbb{E}\left(Y_{0,M_0}\right)\)</span> and <span class="math inline">\(\text{TNIE}=\mathbb{E}\left( Y_{1,M_1}\right) - \mathbb{E}\left(Y_{1,M_0}\right)\)</span> are respectively:</p>
<ul>
<li>0.05 and 0.008 for death without interaction,</li>
<li>0.05855 and 0.011 for death with interaction,</li>
<li>-4 and -0.9 for quality of life without interaction,</li>
<li>-5.425 and -1.4 for quality of life with interaction.</li>
</ul>
</div>
<div id="total-natural-direct-effect-and-pure-natural-indirect-effect" class="section level3 hasAnchor" number="11.1.4">
<h3><span class="header-section-number">11.1.4</span> Total natural direct effect and Pure natural indirect effect<a href="appendix_b.html#total-natural-direct-effect-and-pure-natural-indirect-effect" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following function <code>true.TNDE.PNIE1</code> can be used to run the calculation for total natural direct effects (TNDE) and pure natural indirect effects (PNIE).</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="appendix_b.html#cb74-1" tabindex="-1"></a>true.TNDE.PNIE1 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">interaction =</span> <span class="cn">NULL</span>) {</span>
<span id="cb74-2"><a href="appendix_b.html#cb74-2" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">param.causal.model.1</span>(<span class="at">A.M.interaction =</span> interaction)</span>
<span id="cb74-3"><a href="appendix_b.html#cb74-3" tabindex="-1"></a>  </span>
<span id="cb74-4"><a href="appendix_b.html#cb74-4" tabindex="-1"></a>  <span class="co"># binary outcome (death)</span></span>
<span id="cb74-5"><a href="appendix_b.html#cb74-5" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb74-6"><a href="appendix_b.html#cb74-6" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum.tnde&quot;</span>, <span class="st">&quot;sum.pnie&quot;</span>)</span>
<span id="cb74-7"><a href="appendix_b.html#cb74-7" tabindex="-1"></a>  </span>
<span id="cb74-8"><a href="appendix_b.html#cb74-8" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb74-9"><a href="appendix_b.html#cb74-9" tabindex="-1"></a>    <span class="co"># TNDE </span></span>
<span id="cb74-10"><a href="appendix_b.html#cb74-10" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.tnde&quot;</span>] <span class="ot">&lt;-</span> ( ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-11"><a href="appendix_b.html#cb74-11" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-12"><a href="appendix_b.html#cb74-12" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-13"><a href="appendix_b.html#cb74-13" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb74-14"><a href="appendix_b.html#cb74-14" tabindex="-1"></a>                             b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-15"><a href="appendix_b.html#cb74-15" tabindex="-1"></a>                             b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-16"><a href="appendix_b.html#cb74-16" tabindex="-1"></a>                             b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb74-17"><a href="appendix_b.html#cb74-17" tabindex="-1"></a>                           ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-18"><a href="appendix_b.html#cb74-18" tabindex="-1"></a>                               b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-19"><a href="appendix_b.html#cb74-19" tabindex="-1"></a>                               b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-20"><a href="appendix_b.html#cb74-20" tabindex="-1"></a>                               b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb74-21"><a href="appendix_b.html#cb74-21" tabindex="-1"></a>                               b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-22"><a href="appendix_b.html#cb74-22" tabindex="-1"></a>                               b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-23"><a href="appendix_b.html#cb74-23" tabindex="-1"></a>                               b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) ) <span class="sc">*</span></span>
<span id="cb74-24"><a href="appendix_b.html#cb74-24" tabindex="-1"></a>      (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-25"><a href="appendix_b.html#cb74-25" tabindex="-1"></a>           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-26"><a href="appendix_b.html#cb74-26" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-27"><a href="appendix_b.html#cb74-27" tabindex="-1"></a>           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-28"><a href="appendix_b.html#cb74-28" tabindex="-1"></a>           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span> </span>
<span id="cb74-29"><a href="appendix_b.html#cb74-29" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-30"><a href="appendix_b.html#cb74-30" tabindex="-1"></a>                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-31"><a href="appendix_b.html#cb74-31" tabindex="-1"></a>                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-32"><a href="appendix_b.html#cb74-32" tabindex="-1"></a>                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-33"><a href="appendix_b.html#cb74-33" tabindex="-1"></a>                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] ))  <span class="sc">*</span></span>
<span id="cb74-34"><a href="appendix_b.html#cb74-34" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb74-35"><a href="appendix_b.html#cb74-35" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb74-36"><a href="appendix_b.html#cb74-36" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb74-37"><a href="appendix_b.html#cb74-37" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb74-38"><a href="appendix_b.html#cb74-38" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb74-39"><a href="appendix_b.html#cb74-39" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb74-40"><a href="appendix_b.html#cb74-40" tabindex="-1"></a>    </span>
<span id="cb74-41"><a href="appendix_b.html#cb74-41" tabindex="-1"></a>    <span class="co"># PNIE </span></span>
<span id="cb74-42"><a href="appendix_b.html#cb74-42" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.pnie&quot;</span>] <span class="ot">&lt;-</span> ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-43"><a href="appendix_b.html#cb74-43" tabindex="-1"></a>                           b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-44"><a href="appendix_b.html#cb74-44" tabindex="-1"></a>                           b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-45"><a href="appendix_b.html#cb74-45" tabindex="-1"></a>                           b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb74-46"><a href="appendix_b.html#cb74-46" tabindex="-1"></a>                           b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-47"><a href="appendix_b.html#cb74-47" tabindex="-1"></a>                           b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-48"><a href="appendix_b.html#cb74-48" tabindex="-1"></a>                           b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb74-49"><a href="appendix_b.html#cb74-49" tabindex="-1"></a>      ( (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-50"><a href="appendix_b.html#cb74-50" tabindex="-1"></a>             b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-51"><a href="appendix_b.html#cb74-51" tabindex="-1"></a>             b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-52"><a href="appendix_b.html#cb74-52" tabindex="-1"></a>             b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-53"><a href="appendix_b.html#cb74-53" tabindex="-1"></a>             b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">+</span></span>
<span id="cb74-54"><a href="appendix_b.html#cb74-54" tabindex="-1"></a>          (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-55"><a href="appendix_b.html#cb74-55" tabindex="-1"></a>                    b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-56"><a href="appendix_b.html#cb74-56" tabindex="-1"></a>                    b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-57"><a href="appendix_b.html#cb74-57" tabindex="-1"></a>                    b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-58"><a href="appendix_b.html#cb74-58" tabindex="-1"></a>                    b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">-</span></span>
<span id="cb74-59"><a href="appendix_b.html#cb74-59" tabindex="-1"></a>          (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-60"><a href="appendix_b.html#cb74-60" tabindex="-1"></a>               b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-61"><a href="appendix_b.html#cb74-61" tabindex="-1"></a>               b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-62"><a href="appendix_b.html#cb74-62" tabindex="-1"></a>               b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-63"><a href="appendix_b.html#cb74-63" tabindex="-1"></a>               b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">-</span> </span>
<span id="cb74-64"><a href="appendix_b.html#cb74-64" tabindex="-1"></a>          (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-65"><a href="appendix_b.html#cb74-65" tabindex="-1"></a>                    b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-66"><a href="appendix_b.html#cb74-66" tabindex="-1"></a>                    b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-67"><a href="appendix_b.html#cb74-67" tabindex="-1"></a>                    b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-68"><a href="appendix_b.html#cb74-68" tabindex="-1"></a>                    b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) ) <span class="sc">*</span></span>
<span id="cb74-69"><a href="appendix_b.html#cb74-69" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb74-70"><a href="appendix_b.html#cb74-70" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb74-71"><a href="appendix_b.html#cb74-71" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb74-72"><a href="appendix_b.html#cb74-72" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb74-73"><a href="appendix_b.html#cb74-73" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb74-74"><a href="appendix_b.html#cb74-74" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb74-75"><a href="appendix_b.html#cb74-75" tabindex="-1"></a>    }</span>
<span id="cb74-76"><a href="appendix_b.html#cb74-76" tabindex="-1"></a>  </span>
<span id="cb74-77"><a href="appendix_b.html#cb74-77" tabindex="-1"></a>  TNDE.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.tnde&quot;</span>])</span>
<span id="cb74-78"><a href="appendix_b.html#cb74-78" tabindex="-1"></a>  PNIE.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.pnie&quot;</span>])</span>
<span id="cb74-79"><a href="appendix_b.html#cb74-79" tabindex="-1"></a>  </span>
<span id="cb74-80"><a href="appendix_b.html#cb74-80" tabindex="-1"></a>  <span class="co"># quantitative outcome (QoL)</span></span>
<span id="cb74-81"><a href="appendix_b.html#cb74-81" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb74-82"><a href="appendix_b.html#cb74-82" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum.tnde&quot;</span>, <span class="st">&quot;sum.pnie&quot;</span>)</span>
<span id="cb74-83"><a href="appendix_b.html#cb74-83" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb74-84"><a href="appendix_b.html#cb74-84" tabindex="-1"></a>    <span class="co"># TNDE </span></span>
<span id="cb74-85"><a href="appendix_b.html#cb74-85" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.tnde&quot;</span>] <span class="ot">&lt;-</span> ( ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-86"><a href="appendix_b.html#cb74-86" tabindex="-1"></a>                             b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-87"><a href="appendix_b.html#cb74-87" tabindex="-1"></a>                             b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-88"><a href="appendix_b.html#cb74-88" tabindex="-1"></a>                             b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb74-89"><a href="appendix_b.html#cb74-89" tabindex="-1"></a>                             b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-90"><a href="appendix_b.html#cb74-90" tabindex="-1"></a>                             b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-91"><a href="appendix_b.html#cb74-91" tabindex="-1"></a>                             b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb74-92"><a href="appendix_b.html#cb74-92" tabindex="-1"></a>                           ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-93"><a href="appendix_b.html#cb74-93" tabindex="-1"></a>                               b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-94"><a href="appendix_b.html#cb74-94" tabindex="-1"></a>                               b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-95"><a href="appendix_b.html#cb74-95" tabindex="-1"></a>                               b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb74-96"><a href="appendix_b.html#cb74-96" tabindex="-1"></a>                               b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-97"><a href="appendix_b.html#cb74-97" tabindex="-1"></a>                               b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-98"><a href="appendix_b.html#cb74-98" tabindex="-1"></a>                               b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) ) <span class="sc">*</span></span>
<span id="cb74-99"><a href="appendix_b.html#cb74-99" tabindex="-1"></a>      (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-100"><a href="appendix_b.html#cb74-100" tabindex="-1"></a>           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-101"><a href="appendix_b.html#cb74-101" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-102"><a href="appendix_b.html#cb74-102" tabindex="-1"></a>           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-103"><a href="appendix_b.html#cb74-103" tabindex="-1"></a>           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span> </span>
<span id="cb74-104"><a href="appendix_b.html#cb74-104" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-105"><a href="appendix_b.html#cb74-105" tabindex="-1"></a>                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-106"><a href="appendix_b.html#cb74-106" tabindex="-1"></a>                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-107"><a href="appendix_b.html#cb74-107" tabindex="-1"></a>                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-108"><a href="appendix_b.html#cb74-108" tabindex="-1"></a>                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] ))  <span class="sc">*</span></span>
<span id="cb74-109"><a href="appendix_b.html#cb74-109" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb74-110"><a href="appendix_b.html#cb74-110" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb74-111"><a href="appendix_b.html#cb74-111" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb74-112"><a href="appendix_b.html#cb74-112" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb74-113"><a href="appendix_b.html#cb74-113" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb74-114"><a href="appendix_b.html#cb74-114" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb74-115"><a href="appendix_b.html#cb74-115" tabindex="-1"></a>    </span>
<span id="cb74-116"><a href="appendix_b.html#cb74-116" tabindex="-1"></a>    <span class="co"># PNIE </span></span>
<span id="cb74-117"><a href="appendix_b.html#cb74-117" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.pnie&quot;</span>] <span class="ot">&lt;-</span> ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-118"><a href="appendix_b.html#cb74-118" tabindex="-1"></a>                           b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-119"><a href="appendix_b.html#cb74-119" tabindex="-1"></a>                           b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-120"><a href="appendix_b.html#cb74-120" tabindex="-1"></a>                           b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb74-121"><a href="appendix_b.html#cb74-121" tabindex="-1"></a>                           b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-122"><a href="appendix_b.html#cb74-122" tabindex="-1"></a>                           b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-123"><a href="appendix_b.html#cb74-123" tabindex="-1"></a>                           b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb74-124"><a href="appendix_b.html#cb74-124" tabindex="-1"></a>      ( (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-125"><a href="appendix_b.html#cb74-125" tabindex="-1"></a>             b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-126"><a href="appendix_b.html#cb74-126" tabindex="-1"></a>             b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-127"><a href="appendix_b.html#cb74-127" tabindex="-1"></a>             b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-128"><a href="appendix_b.html#cb74-128" tabindex="-1"></a>             b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">+</span></span>
<span id="cb74-129"><a href="appendix_b.html#cb74-129" tabindex="-1"></a>          (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-130"><a href="appendix_b.html#cb74-130" tabindex="-1"></a>                    b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-131"><a href="appendix_b.html#cb74-131" tabindex="-1"></a>                    b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-132"><a href="appendix_b.html#cb74-132" tabindex="-1"></a>                    b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-133"><a href="appendix_b.html#cb74-133" tabindex="-1"></a>                    b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">-</span></span>
<span id="cb74-134"><a href="appendix_b.html#cb74-134" tabindex="-1"></a>          (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-135"><a href="appendix_b.html#cb74-135" tabindex="-1"></a>               b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-136"><a href="appendix_b.html#cb74-136" tabindex="-1"></a>               b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-137"><a href="appendix_b.html#cb74-137" tabindex="-1"></a>               b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-138"><a href="appendix_b.html#cb74-138" tabindex="-1"></a>               b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">-</span> </span>
<span id="cb74-139"><a href="appendix_b.html#cb74-139" tabindex="-1"></a>          (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-140"><a href="appendix_b.html#cb74-140" tabindex="-1"></a>                    b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-141"><a href="appendix_b.html#cb74-141" tabindex="-1"></a>                    b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb74-142"><a href="appendix_b.html#cb74-142" tabindex="-1"></a>                    b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb74-143"><a href="appendix_b.html#cb74-143" tabindex="-1"></a>                    b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) ) <span class="sc">*</span></span>
<span id="cb74-144"><a href="appendix_b.html#cb74-144" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb74-145"><a href="appendix_b.html#cb74-145" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb74-146"><a href="appendix_b.html#cb74-146" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb74-147"><a href="appendix_b.html#cb74-147" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb74-148"><a href="appendix_b.html#cb74-148" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb74-149"><a href="appendix_b.html#cb74-149" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb74-150"><a href="appendix_b.html#cb74-150" tabindex="-1"></a>    }</span>
<span id="cb74-151"><a href="appendix_b.html#cb74-151" tabindex="-1"></a>  </span>
<span id="cb74-152"><a href="appendix_b.html#cb74-152" tabindex="-1"></a>  TNDE.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.tnde&quot;</span>])</span>
<span id="cb74-153"><a href="appendix_b.html#cb74-153" tabindex="-1"></a>  PNIE.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.pnie&quot;</span>])</span>
<span id="cb74-154"><a href="appendix_b.html#cb74-154" tabindex="-1"></a>   </span>
<span id="cb74-155"><a href="appendix_b.html#cb74-155" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">TNDE.death =</span> TNDE.death, <span class="at">PNIE.death =</span> PNIE.death, </span>
<span id="cb74-156"><a href="appendix_b.html#cb74-156" tabindex="-1"></a>              <span class="at">TNDE.qol =</span> TNDE.qol, <span class="at">PNIE.qol =</span> PNIE.qol))</span>
<span id="cb74-157"><a href="appendix_b.html#cb74-157" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="appendix_b.html#cb75-1" tabindex="-1"></a>true.TNDE.PNIE.no.inter <span class="ot">&lt;-</span> <span class="fu">true.TNDE.PNIE1</span>(<span class="at">interaction =</span> <span class="dv">0</span>)</span>
<span id="cb75-2"><a href="appendix_b.html#cb75-2" tabindex="-1"></a></span>
<span id="cb75-3"><a href="appendix_b.html#cb75-3" tabindex="-1"></a>true.TNDE.PNIE.with.inter <span class="ot">&lt;-</span> <span class="fu">true.TNDE.PNIE1</span>(<span class="at">interaction =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>The <span class="math inline">\(\text{TNDE}=\mathbb{E}\left( Y_{1,M_1}\right) - \mathbb{E}\left(Y_{0,M_1}\right)\)</span> and <span class="math inline">\(\text{PNIE}=\mathbb{E}\left( Y_{0,M_1}\right) - \mathbb{E}\left(Y_{0,M_0}\right)\)</span> are respectively:</p>
<ul>
<li>0.05 and 0.008 for death without interaction,</li>
<li>0.06155 and 0.008 for death with interaction,</li>
<li>-4 and -0.9 for quality of life without interaction,</li>
<li>-5.925 and -0.9 for quality of life with interaction.</li>
</ul>
</div>
<div id="vanderweeles-3-way-decomposition" class="section level3 hasAnchor" number="11.1.5">
<h3><span class="header-section-number">11.1.5</span> Vanderweele’s 3-way decomposition<a href="appendix_b.html#vanderweeles-3-way-decomposition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following function <code>true.3way.decomp</code> can be used to run the calculation for the 3-way decomposition of the total effect into a “pure natural direct effect” (PNDE), a “pure natural indirect effect” (PNIE) and a “mediated interactive effect” (MIE).</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="appendix_b.html#cb76-1" tabindex="-1"></a>true<span class="fl">.3</span>way.decomp <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">interaction =</span> <span class="cn">NULL</span>) {</span>
<span id="cb76-2"><a href="appendix_b.html#cb76-2" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">param.causal.model.1</span>(<span class="at">A.M.interaction =</span> interaction)</span>
<span id="cb76-3"><a href="appendix_b.html#cb76-3" tabindex="-1"></a>  </span>
<span id="cb76-4"><a href="appendix_b.html#cb76-4" tabindex="-1"></a>  <span class="co"># binary outcome (death)</span></span>
<span id="cb76-5"><a href="appendix_b.html#cb76-5" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb76-6"><a href="appendix_b.html#cb76-6" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum.pde&quot;</span>, <span class="st">&quot;sum.pie&quot;</span>)</span>
<span id="cb76-7"><a href="appendix_b.html#cb76-7" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb76-8"><a href="appendix_b.html#cb76-8" tabindex="-1"></a>    <span class="co"># PDE </span></span>
<span id="cb76-9"><a href="appendix_b.html#cb76-9" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.pde&quot;</span>] <span class="ot">&lt;-</span> ( ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-10"><a href="appendix_b.html#cb76-10" tabindex="-1"></a>                            b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-11"><a href="appendix_b.html#cb76-11" tabindex="-1"></a>                            b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-12"><a href="appendix_b.html#cb76-12" tabindex="-1"></a>                            b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb76-13"><a href="appendix_b.html#cb76-13" tabindex="-1"></a>                            b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-14"><a href="appendix_b.html#cb76-14" tabindex="-1"></a>                            b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-15"><a href="appendix_b.html#cb76-15" tabindex="-1"></a>                            b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb76-16"><a href="appendix_b.html#cb76-16" tabindex="-1"></a>                          ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-17"><a href="appendix_b.html#cb76-17" tabindex="-1"></a>                              b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-18"><a href="appendix_b.html#cb76-18" tabindex="-1"></a>                              b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-19"><a href="appendix_b.html#cb76-19" tabindex="-1"></a>                              b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb76-20"><a href="appendix_b.html#cb76-20" tabindex="-1"></a>                              b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-21"><a href="appendix_b.html#cb76-21" tabindex="-1"></a>                              b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-22"><a href="appendix_b.html#cb76-22" tabindex="-1"></a>                              b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) ) <span class="sc">*</span></span>
<span id="cb76-23"><a href="appendix_b.html#cb76-23" tabindex="-1"></a>    (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-24"><a href="appendix_b.html#cb76-24" tabindex="-1"></a>         b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-25"><a href="appendix_b.html#cb76-25" tabindex="-1"></a>         b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-26"><a href="appendix_b.html#cb76-26" tabindex="-1"></a>         b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-27"><a href="appendix_b.html#cb76-27" tabindex="-1"></a>         b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span> </span>
<span id="cb76-28"><a href="appendix_b.html#cb76-28" tabindex="-1"></a>    (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-29"><a href="appendix_b.html#cb76-29" tabindex="-1"></a>              b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-30"><a href="appendix_b.html#cb76-30" tabindex="-1"></a>              b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-31"><a href="appendix_b.html#cb76-31" tabindex="-1"></a>              b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-32"><a href="appendix_b.html#cb76-32" tabindex="-1"></a>              b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] ))  <span class="sc">*</span></span>
<span id="cb76-33"><a href="appendix_b.html#cb76-33" tabindex="-1"></a>    ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb76-34"><a href="appendix_b.html#cb76-34" tabindex="-1"></a>    ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb76-35"><a href="appendix_b.html#cb76-35" tabindex="-1"></a>    ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb76-36"><a href="appendix_b.html#cb76-36" tabindex="-1"></a>    ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb76-37"><a href="appendix_b.html#cb76-37" tabindex="-1"></a>    ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb76-38"><a href="appendix_b.html#cb76-38" tabindex="-1"></a>    ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb76-39"><a href="appendix_b.html#cb76-39" tabindex="-1"></a>    </span>
<span id="cb76-40"><a href="appendix_b.html#cb76-40" tabindex="-1"></a>    <span class="co"># PIE </span></span>
<span id="cb76-41"><a href="appendix_b.html#cb76-41" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.pie&quot;</span>] <span class="ot">&lt;-</span> ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-42"><a href="appendix_b.html#cb76-42" tabindex="-1"></a>                          b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-43"><a href="appendix_b.html#cb76-43" tabindex="-1"></a>                          b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-44"><a href="appendix_b.html#cb76-44" tabindex="-1"></a>                          b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb76-45"><a href="appendix_b.html#cb76-45" tabindex="-1"></a>                          b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-46"><a href="appendix_b.html#cb76-46" tabindex="-1"></a>                          b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-47"><a href="appendix_b.html#cb76-47" tabindex="-1"></a>                          b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb76-48"><a href="appendix_b.html#cb76-48" tabindex="-1"></a>      ( (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-49"><a href="appendix_b.html#cb76-49" tabindex="-1"></a>             b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-50"><a href="appendix_b.html#cb76-50" tabindex="-1"></a>             b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-51"><a href="appendix_b.html#cb76-51" tabindex="-1"></a>             b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-52"><a href="appendix_b.html#cb76-52" tabindex="-1"></a>             b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">+</span></span>
<span id="cb76-53"><a href="appendix_b.html#cb76-53" tabindex="-1"></a>          (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-54"><a href="appendix_b.html#cb76-54" tabindex="-1"></a>                    b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-55"><a href="appendix_b.html#cb76-55" tabindex="-1"></a>                    b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-56"><a href="appendix_b.html#cb76-56" tabindex="-1"></a>                    b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-57"><a href="appendix_b.html#cb76-57" tabindex="-1"></a>                    b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">-</span></span>
<span id="cb76-58"><a href="appendix_b.html#cb76-58" tabindex="-1"></a>          (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-59"><a href="appendix_b.html#cb76-59" tabindex="-1"></a>               b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-60"><a href="appendix_b.html#cb76-60" tabindex="-1"></a>               b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-61"><a href="appendix_b.html#cb76-61" tabindex="-1"></a>               b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-62"><a href="appendix_b.html#cb76-62" tabindex="-1"></a>               b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">-</span> </span>
<span id="cb76-63"><a href="appendix_b.html#cb76-63" tabindex="-1"></a>          (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-64"><a href="appendix_b.html#cb76-64" tabindex="-1"></a>                    b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-65"><a href="appendix_b.html#cb76-65" tabindex="-1"></a>                    b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-66"><a href="appendix_b.html#cb76-66" tabindex="-1"></a>                    b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-67"><a href="appendix_b.html#cb76-67" tabindex="-1"></a>                    b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) ) <span class="sc">*</span></span>
<span id="cb76-68"><a href="appendix_b.html#cb76-68" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb76-69"><a href="appendix_b.html#cb76-69" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb76-70"><a href="appendix_b.html#cb76-70" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb76-71"><a href="appendix_b.html#cb76-71" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb76-72"><a href="appendix_b.html#cb76-72" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb76-73"><a href="appendix_b.html#cb76-73" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb76-74"><a href="appendix_b.html#cb76-74" tabindex="-1"></a>    }</span>
<span id="cb76-75"><a href="appendix_b.html#cb76-75" tabindex="-1"></a>  </span>
<span id="cb76-76"><a href="appendix_b.html#cb76-76" tabindex="-1"></a>  <span class="co"># MI </span></span>
<span id="cb76-77"><a href="appendix_b.html#cb76-77" tabindex="-1"></a>  S.MI <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb76-78"><a href="appendix_b.html#cb76-78" tabindex="-1"></a>  <span class="fu">colnames</span>(S.MI) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>, <span class="st">&quot;sum.mi&quot;</span>)</span>
<span id="cb76-79"><a href="appendix_b.html#cb76-79" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb76-80"><a href="appendix_b.html#cb76-80" tabindex="-1"></a>    S.MI[n,<span class="st">&quot;sum.mi&quot;</span>] <span class="ot">&lt;-</span> ( ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-81"><a href="appendix_b.html#cb76-81" tabindex="-1"></a>                              b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-82"><a href="appendix_b.html#cb76-82" tabindex="-1"></a>                              b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-83"><a href="appendix_b.html#cb76-83" tabindex="-1"></a>                              b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb76-84"><a href="appendix_b.html#cb76-84" tabindex="-1"></a>                              b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-85"><a href="appendix_b.html#cb76-85" tabindex="-1"></a>                              b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb76-86"><a href="appendix_b.html#cb76-86" tabindex="-1"></a>                              b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb76-87"><a href="appendix_b.html#cb76-87" tabindex="-1"></a>                            ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-88"><a href="appendix_b.html#cb76-88" tabindex="-1"></a>                                b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-89"><a href="appendix_b.html#cb76-89" tabindex="-1"></a>                                b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-90"><a href="appendix_b.html#cb76-90" tabindex="-1"></a>                                b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb76-91"><a href="appendix_b.html#cb76-91" tabindex="-1"></a>                                b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-92"><a href="appendix_b.html#cb76-92" tabindex="-1"></a>                                b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb76-93"><a href="appendix_b.html#cb76-93" tabindex="-1"></a>                                b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb76-94"><a href="appendix_b.html#cb76-94" tabindex="-1"></a>                            ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-95"><a href="appendix_b.html#cb76-95" tabindex="-1"></a>                                b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-96"><a href="appendix_b.html#cb76-96" tabindex="-1"></a>                                b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-97"><a href="appendix_b.html#cb76-97" tabindex="-1"></a>                                b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb76-98"><a href="appendix_b.html#cb76-98" tabindex="-1"></a>                                b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-99"><a href="appendix_b.html#cb76-99" tabindex="-1"></a>                                b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb76-100"><a href="appendix_b.html#cb76-100" tabindex="-1"></a>                                b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">+</span> </span>
<span id="cb76-101"><a href="appendix_b.html#cb76-101" tabindex="-1"></a>                            ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-102"><a href="appendix_b.html#cb76-102" tabindex="-1"></a>                                b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-103"><a href="appendix_b.html#cb76-103" tabindex="-1"></a>                                b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-104"><a href="appendix_b.html#cb76-104" tabindex="-1"></a>                                b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb76-105"><a href="appendix_b.html#cb76-105" tabindex="-1"></a>                                b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-106"><a href="appendix_b.html#cb76-106" tabindex="-1"></a>                                b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb76-107"><a href="appendix_b.html#cb76-107" tabindex="-1"></a>                                b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb76-108"><a href="appendix_b.html#cb76-108" tabindex="-1"></a>      ( ( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-109"><a href="appendix_b.html#cb76-109" tabindex="-1"></a>            b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-110"><a href="appendix_b.html#cb76-110" tabindex="-1"></a>            b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-111"><a href="appendix_b.html#cb76-111" tabindex="-1"></a>            b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-112"><a href="appendix_b.html#cb76-112" tabindex="-1"></a>            b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> ) <span class="sc">-</span> </span>
<span id="cb76-113"><a href="appendix_b.html#cb76-113" tabindex="-1"></a>          ( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-114"><a href="appendix_b.html#cb76-114" tabindex="-1"></a>              b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-115"><a href="appendix_b.html#cb76-115" tabindex="-1"></a>              b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-116"><a href="appendix_b.html#cb76-116" tabindex="-1"></a>              b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-117"><a href="appendix_b.html#cb76-117" tabindex="-1"></a>              b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )) <span class="sc">*</span> </span>
<span id="cb76-118"><a href="appendix_b.html#cb76-118" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb76-119"><a href="appendix_b.html#cb76-119" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb76-120"><a href="appendix_b.html#cb76-120" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S.MI[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb76-121"><a href="appendix_b.html#cb76-121" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S.MI[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb76-122"><a href="appendix_b.html#cb76-122" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S.MI[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb76-123"><a href="appendix_b.html#cb76-123" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S.MI[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb76-124"><a href="appendix_b.html#cb76-124" tabindex="-1"></a>    }</span>
<span id="cb76-125"><a href="appendix_b.html#cb76-125" tabindex="-1"></a>  </span>
<span id="cb76-126"><a href="appendix_b.html#cb76-126" tabindex="-1"></a>  PDE.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.pde&quot;</span>])</span>
<span id="cb76-127"><a href="appendix_b.html#cb76-127" tabindex="-1"></a>  PIE.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.pie&quot;</span>])</span>
<span id="cb76-128"><a href="appendix_b.html#cb76-128" tabindex="-1"></a>  MI.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S.MI[,<span class="st">&quot;sum.mi&quot;</span>])</span>
<span id="cb76-129"><a href="appendix_b.html#cb76-129" tabindex="-1"></a>  </span>
<span id="cb76-130"><a href="appendix_b.html#cb76-130" tabindex="-1"></a>  </span>
<span id="cb76-131"><a href="appendix_b.html#cb76-131" tabindex="-1"></a>  <span class="co"># quantitative outcome (QoL)</span></span>
<span id="cb76-132"><a href="appendix_b.html#cb76-132" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb76-133"><a href="appendix_b.html#cb76-133" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum.pde&quot;</span>, <span class="st">&quot;sum.pie&quot;</span>)</span>
<span id="cb76-134"><a href="appendix_b.html#cb76-134" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb76-135"><a href="appendix_b.html#cb76-135" tabindex="-1"></a>    <span class="co"># PDE </span></span>
<span id="cb76-136"><a href="appendix_b.html#cb76-136" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.pde&quot;</span>] <span class="ot">&lt;-</span> ( ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-137"><a href="appendix_b.html#cb76-137" tabindex="-1"></a>                            b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-138"><a href="appendix_b.html#cb76-138" tabindex="-1"></a>                            b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-139"><a href="appendix_b.html#cb76-139" tabindex="-1"></a>                            b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb76-140"><a href="appendix_b.html#cb76-140" tabindex="-1"></a>                            b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-141"><a href="appendix_b.html#cb76-141" tabindex="-1"></a>                            b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-142"><a href="appendix_b.html#cb76-142" tabindex="-1"></a>                            b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb76-143"><a href="appendix_b.html#cb76-143" tabindex="-1"></a>                          ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-144"><a href="appendix_b.html#cb76-144" tabindex="-1"></a>                              b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-145"><a href="appendix_b.html#cb76-145" tabindex="-1"></a>                              b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-146"><a href="appendix_b.html#cb76-146" tabindex="-1"></a>                              b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb76-147"><a href="appendix_b.html#cb76-147" tabindex="-1"></a>                              b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-148"><a href="appendix_b.html#cb76-148" tabindex="-1"></a>                              b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-149"><a href="appendix_b.html#cb76-149" tabindex="-1"></a>                              b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) ) <span class="sc">*</span></span>
<span id="cb76-150"><a href="appendix_b.html#cb76-150" tabindex="-1"></a>      (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-151"><a href="appendix_b.html#cb76-151" tabindex="-1"></a>           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-152"><a href="appendix_b.html#cb76-152" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-153"><a href="appendix_b.html#cb76-153" tabindex="-1"></a>           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-154"><a href="appendix_b.html#cb76-154" tabindex="-1"></a>           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span> </span>
<span id="cb76-155"><a href="appendix_b.html#cb76-155" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-156"><a href="appendix_b.html#cb76-156" tabindex="-1"></a>                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-157"><a href="appendix_b.html#cb76-157" tabindex="-1"></a>                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-158"><a href="appendix_b.html#cb76-158" tabindex="-1"></a>                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-159"><a href="appendix_b.html#cb76-159" tabindex="-1"></a>                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] ))  <span class="sc">*</span></span>
<span id="cb76-160"><a href="appendix_b.html#cb76-160" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb76-161"><a href="appendix_b.html#cb76-161" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb76-162"><a href="appendix_b.html#cb76-162" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb76-163"><a href="appendix_b.html#cb76-163" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb76-164"><a href="appendix_b.html#cb76-164" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb76-165"><a href="appendix_b.html#cb76-165" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb76-166"><a href="appendix_b.html#cb76-166" tabindex="-1"></a>    </span>
<span id="cb76-167"><a href="appendix_b.html#cb76-167" tabindex="-1"></a>    <span class="co"># PIE </span></span>
<span id="cb76-168"><a href="appendix_b.html#cb76-168" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.pie&quot;</span>] <span class="ot">&lt;-</span> ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-169"><a href="appendix_b.html#cb76-169" tabindex="-1"></a>                          b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-170"><a href="appendix_b.html#cb76-170" tabindex="-1"></a>                          b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-171"><a href="appendix_b.html#cb76-171" tabindex="-1"></a>                          b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb76-172"><a href="appendix_b.html#cb76-172" tabindex="-1"></a>                          b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-173"><a href="appendix_b.html#cb76-173" tabindex="-1"></a>                          b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-174"><a href="appendix_b.html#cb76-174" tabindex="-1"></a>                          b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb76-175"><a href="appendix_b.html#cb76-175" tabindex="-1"></a>      ( (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-176"><a href="appendix_b.html#cb76-176" tabindex="-1"></a>             b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-177"><a href="appendix_b.html#cb76-177" tabindex="-1"></a>             b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-178"><a href="appendix_b.html#cb76-178" tabindex="-1"></a>             b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-179"><a href="appendix_b.html#cb76-179" tabindex="-1"></a>             b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">+</span></span>
<span id="cb76-180"><a href="appendix_b.html#cb76-180" tabindex="-1"></a>          (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-181"><a href="appendix_b.html#cb76-181" tabindex="-1"></a>                    b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-182"><a href="appendix_b.html#cb76-182" tabindex="-1"></a>                    b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-183"><a href="appendix_b.html#cb76-183" tabindex="-1"></a>                    b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-184"><a href="appendix_b.html#cb76-184" tabindex="-1"></a>                    b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">-</span></span>
<span id="cb76-185"><a href="appendix_b.html#cb76-185" tabindex="-1"></a>          (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-186"><a href="appendix_b.html#cb76-186" tabindex="-1"></a>               b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-187"><a href="appendix_b.html#cb76-187" tabindex="-1"></a>               b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-188"><a href="appendix_b.html#cb76-188" tabindex="-1"></a>               b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-189"><a href="appendix_b.html#cb76-189" tabindex="-1"></a>               b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">-</span> </span>
<span id="cb76-190"><a href="appendix_b.html#cb76-190" tabindex="-1"></a>          (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-191"><a href="appendix_b.html#cb76-191" tabindex="-1"></a>                    b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-192"><a href="appendix_b.html#cb76-192" tabindex="-1"></a>                    b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-193"><a href="appendix_b.html#cb76-193" tabindex="-1"></a>                    b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-194"><a href="appendix_b.html#cb76-194" tabindex="-1"></a>                    b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) ) <span class="sc">*</span></span>
<span id="cb76-195"><a href="appendix_b.html#cb76-195" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb76-196"><a href="appendix_b.html#cb76-196" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb76-197"><a href="appendix_b.html#cb76-197" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb76-198"><a href="appendix_b.html#cb76-198" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb76-199"><a href="appendix_b.html#cb76-199" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb76-200"><a href="appendix_b.html#cb76-200" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb76-201"><a href="appendix_b.html#cb76-201" tabindex="-1"></a>    }</span>
<span id="cb76-202"><a href="appendix_b.html#cb76-202" tabindex="-1"></a>  </span>
<span id="cb76-203"><a href="appendix_b.html#cb76-203" tabindex="-1"></a>  <span class="co"># MI </span></span>
<span id="cb76-204"><a href="appendix_b.html#cb76-204" tabindex="-1"></a>  S.MI <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb76-205"><a href="appendix_b.html#cb76-205" tabindex="-1"></a>  <span class="fu">colnames</span>(S.MI) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;sum.mi&quot;</span>)</span>
<span id="cb76-206"><a href="appendix_b.html#cb76-206" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb76-207"><a href="appendix_b.html#cb76-207" tabindex="-1"></a>    S.MI[n,<span class="st">&quot;sum.mi&quot;</span>] <span class="ot">&lt;-</span> ( ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-208"><a href="appendix_b.html#cb76-208" tabindex="-1"></a>                              b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-209"><a href="appendix_b.html#cb76-209" tabindex="-1"></a>                              b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-210"><a href="appendix_b.html#cb76-210" tabindex="-1"></a>                              b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb76-211"><a href="appendix_b.html#cb76-211" tabindex="-1"></a>                              b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-212"><a href="appendix_b.html#cb76-212" tabindex="-1"></a>                              b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb76-213"><a href="appendix_b.html#cb76-213" tabindex="-1"></a>                              b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb76-214"><a href="appendix_b.html#cb76-214" tabindex="-1"></a>                            ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-215"><a href="appendix_b.html#cb76-215" tabindex="-1"></a>                                b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-216"><a href="appendix_b.html#cb76-216" tabindex="-1"></a>                                b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-217"><a href="appendix_b.html#cb76-217" tabindex="-1"></a>                                b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb76-218"><a href="appendix_b.html#cb76-218" tabindex="-1"></a>                                b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-219"><a href="appendix_b.html#cb76-219" tabindex="-1"></a>                                b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb76-220"><a href="appendix_b.html#cb76-220" tabindex="-1"></a>                                b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb76-221"><a href="appendix_b.html#cb76-221" tabindex="-1"></a>                            ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-222"><a href="appendix_b.html#cb76-222" tabindex="-1"></a>                                b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-223"><a href="appendix_b.html#cb76-223" tabindex="-1"></a>                                b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-224"><a href="appendix_b.html#cb76-224" tabindex="-1"></a>                                b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb76-225"><a href="appendix_b.html#cb76-225" tabindex="-1"></a>                                b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-226"><a href="appendix_b.html#cb76-226" tabindex="-1"></a>                                b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb76-227"><a href="appendix_b.html#cb76-227" tabindex="-1"></a>                                b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">+</span> </span>
<span id="cb76-228"><a href="appendix_b.html#cb76-228" tabindex="-1"></a>                            ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-229"><a href="appendix_b.html#cb76-229" tabindex="-1"></a>                                b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-230"><a href="appendix_b.html#cb76-230" tabindex="-1"></a>                                b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-231"><a href="appendix_b.html#cb76-231" tabindex="-1"></a>                                b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb76-232"><a href="appendix_b.html#cb76-232" tabindex="-1"></a>                                b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-233"><a href="appendix_b.html#cb76-233" tabindex="-1"></a>                                b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb76-234"><a href="appendix_b.html#cb76-234" tabindex="-1"></a>                                b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb76-235"><a href="appendix_b.html#cb76-235" tabindex="-1"></a>      ( ( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-236"><a href="appendix_b.html#cb76-236" tabindex="-1"></a>            b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-237"><a href="appendix_b.html#cb76-237" tabindex="-1"></a>            b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-238"><a href="appendix_b.html#cb76-238" tabindex="-1"></a>            b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-239"><a href="appendix_b.html#cb76-239" tabindex="-1"></a>            b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> ) <span class="sc">-</span> </span>
<span id="cb76-240"><a href="appendix_b.html#cb76-240" tabindex="-1"></a>          ( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-241"><a href="appendix_b.html#cb76-241" tabindex="-1"></a>              b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-242"><a href="appendix_b.html#cb76-242" tabindex="-1"></a>              b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S.MI[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb76-243"><a href="appendix_b.html#cb76-243" tabindex="-1"></a>              b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb76-244"><a href="appendix_b.html#cb76-244" tabindex="-1"></a>              b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )) <span class="sc">*</span> </span>
<span id="cb76-245"><a href="appendix_b.html#cb76-245" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb76-246"><a href="appendix_b.html#cb76-246" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb76-247"><a href="appendix_b.html#cb76-247" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S.MI[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb76-248"><a href="appendix_b.html#cb76-248" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S.MI[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb76-249"><a href="appendix_b.html#cb76-249" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S.MI[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb76-250"><a href="appendix_b.html#cb76-250" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S.MI[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb76-251"><a href="appendix_b.html#cb76-251" tabindex="-1"></a>    }</span>
<span id="cb76-252"><a href="appendix_b.html#cb76-252" tabindex="-1"></a>  </span>
<span id="cb76-253"><a href="appendix_b.html#cb76-253" tabindex="-1"></a>  PDE.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.pde&quot;</span>])</span>
<span id="cb76-254"><a href="appendix_b.html#cb76-254" tabindex="-1"></a>  PIE.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.pie&quot;</span>])</span>
<span id="cb76-255"><a href="appendix_b.html#cb76-255" tabindex="-1"></a>  MI.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S.MI[,<span class="st">&quot;sum.mi&quot;</span>])</span>
<span id="cb76-256"><a href="appendix_b.html#cb76-256" tabindex="-1"></a>  </span>
<span id="cb76-257"><a href="appendix_b.html#cb76-257" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">PDE.death =</span> PDE.death, <span class="at">PIE.death =</span> PIE.death, <span class="at">MI.death =</span> MI.death,</span>
<span id="cb76-258"><a href="appendix_b.html#cb76-258" tabindex="-1"></a>              <span class="at">PDE.qol =</span> PDE.qol, <span class="at">PIE.qol =</span> PIE.qol, <span class="at">MI.qol =</span> MI.qol))</span>
<span id="cb76-259"><a href="appendix_b.html#cb76-259" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="appendix_b.html#cb77-1" tabindex="-1"></a>true<span class="fl">.3</span>way.no.inter <span class="ot">&lt;-</span> <span class="fu">true.3way.decomp</span>(<span class="at">interaction =</span> <span class="dv">0</span>)</span>
<span id="cb77-2"><a href="appendix_b.html#cb77-2" tabindex="-1"></a></span>
<span id="cb77-3"><a href="appendix_b.html#cb77-3" tabindex="-1"></a>true<span class="fl">.3</span>way.with.inter <span class="ot">&lt;-</span> <span class="fu">true.3way.decomp</span>(<span class="at">interaction =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>The <span class="math inline">\(\text{PNDE}=\mathbb{E}\left( Y_{1,M_0}\right) - \mathbb{E}\left( Y_{0,M_0}\right)\)</span>, the <span class="math inline">\(\text{PNIE}=\mathbb{E}\left(Y_{0,M_1}\right) - \mathbb{E}\left(Y_{0,M_0}\right)\)</span> and the <span class="math inline">\(\text{MIE}=\mathbb{E}\left( (Y_{1,1} - Y_{1,0} - Y_{0,1} + Y_{0,0}) \times (M_1 - M_0) \right)\)</span> are respectively:</p>
<ul>
<li>0.05, 0.008 and 0.000 for death without interaction,</li>
<li>0.05855, 0.008 and 0.003 for death with interaction,</li>
<li>-4, -0.9 and 0 for quality of life without interaction,</li>
<li>-5.425, -0.9 and -0.5 for quality of life with interaction.</li>
</ul>
</div>
<div id="vanderweeles-4-way-decomposition" class="section level3 hasAnchor" number="11.1.6">
<h3><span class="header-section-number">11.1.6</span> Vanderweele’s 4-way decomposition<a href="appendix_b.html#vanderweeles-4-way-decomposition" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following function <code>true.4way.decomp</code> can be used to run the calculation for the 4-way decomposition of the total effect into a “controlled direct effect” (CDE), a “reference interaction effect” (RIE), a “mediated interaction effect” (MIE) and a “pure natural indirect effect” (PNIE).</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="appendix_b.html#cb78-1" tabindex="-1"></a>true<span class="fl">.4</span>way.decomp <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">interaction =</span> <span class="cn">NULL</span>) {</span>
<span id="cb78-2"><a href="appendix_b.html#cb78-2" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">param.causal.model.1</span>(<span class="at">A.M.interaction =</span> interaction)</span>
<span id="cb78-3"><a href="appendix_b.html#cb78-3" tabindex="-1"></a>  </span>
<span id="cb78-4"><a href="appendix_b.html#cb78-4" tabindex="-1"></a>  <span class="co"># binary outcome (death)</span></span>
<span id="cb78-5"><a href="appendix_b.html#cb78-5" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">3</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">3</span>), </span>
<span id="cb78-6"><a href="appendix_b.html#cb78-6" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">3</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb78-7"><a href="appendix_b.html#cb78-7" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>, <span class="st">&quot;L1&quot;</span>, <span class="st">&quot;sum.cde&quot;</span>, <span class="st">&quot;sum.intref&quot;</span>, </span>
<span id="cb78-8"><a href="appendix_b.html#cb78-8" tabindex="-1"></a>                      <span class="st">&quot;sum.intmed&quot;</span>, <span class="st">&quot;sum.pie&quot;</span>)</span>
<span id="cb78-9"><a href="appendix_b.html#cb78-9" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb78-10"><a href="appendix_b.html#cb78-10" tabindex="-1"></a>    <span class="co"># CDE </span></span>
<span id="cb78-11"><a href="appendix_b.html#cb78-11" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.cde&quot;</span>] <span class="ot">&lt;-</span> ( ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-12"><a href="appendix_b.html#cb78-12" tabindex="-1"></a>                            b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-13"><a href="appendix_b.html#cb78-13" tabindex="-1"></a>                            b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-14"><a href="appendix_b.html#cb78-14" tabindex="-1"></a>                            b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb78-15"><a href="appendix_b.html#cb78-15" tabindex="-1"></a>                            b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-16"><a href="appendix_b.html#cb78-16" tabindex="-1"></a>                            b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb78-17"><a href="appendix_b.html#cb78-17" tabindex="-1"></a>                            b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb78-18"><a href="appendix_b.html#cb78-18" tabindex="-1"></a>                          ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-19"><a href="appendix_b.html#cb78-19" tabindex="-1"></a>                              b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-20"><a href="appendix_b.html#cb78-20" tabindex="-1"></a>                              b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-21"><a href="appendix_b.html#cb78-21" tabindex="-1"></a>                              b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb78-22"><a href="appendix_b.html#cb78-22" tabindex="-1"></a>                              b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-23"><a href="appendix_b.html#cb78-23" tabindex="-1"></a>                              b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb78-24"><a href="appendix_b.html#cb78-24" tabindex="-1"></a>                              b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) ) <span class="sc">*</span></span>
<span id="cb78-25"><a href="appendix_b.html#cb78-25" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-26"><a href="appendix_b.html#cb78-26" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-27"><a href="appendix_b.html#cb78-27" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb78-28"><a href="appendix_b.html#cb78-28" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb78-29"><a href="appendix_b.html#cb78-29" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-30"><a href="appendix_b.html#cb78-30" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb78-31"><a href="appendix_b.html#cb78-31" tabindex="-1"></a>    </span>
<span id="cb78-32"><a href="appendix_b.html#cb78-32" tabindex="-1"></a>    <span class="co"># INTref </span></span>
<span id="cb78-33"><a href="appendix_b.html#cb78-33" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.intref&quot;</span>] <span class="ot">&lt;-</span> ( ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-34"><a href="appendix_b.html#cb78-34" tabindex="-1"></a>                               b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-35"><a href="appendix_b.html#cb78-35" tabindex="-1"></a>                               b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-36"><a href="appendix_b.html#cb78-36" tabindex="-1"></a>                               b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb78-37"><a href="appendix_b.html#cb78-37" tabindex="-1"></a>                               b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-38"><a href="appendix_b.html#cb78-38" tabindex="-1"></a>                               b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb78-39"><a href="appendix_b.html#cb78-39" tabindex="-1"></a>                               b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb78-40"><a href="appendix_b.html#cb78-40" tabindex="-1"></a>                             ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-41"><a href="appendix_b.html#cb78-41" tabindex="-1"></a>                                 b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-42"><a href="appendix_b.html#cb78-42" tabindex="-1"></a>                                 b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-43"><a href="appendix_b.html#cb78-43" tabindex="-1"></a>                                 b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb78-44"><a href="appendix_b.html#cb78-44" tabindex="-1"></a>                                 b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-45"><a href="appendix_b.html#cb78-45" tabindex="-1"></a>                                 b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb78-46"><a href="appendix_b.html#cb78-46" tabindex="-1"></a>                                 b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb78-47"><a href="appendix_b.html#cb78-47" tabindex="-1"></a>                             ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-48"><a href="appendix_b.html#cb78-48" tabindex="-1"></a>                                 b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-49"><a href="appendix_b.html#cb78-49" tabindex="-1"></a>                                 b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-50"><a href="appendix_b.html#cb78-50" tabindex="-1"></a>                                 b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb78-51"><a href="appendix_b.html#cb78-51" tabindex="-1"></a>                                 b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-52"><a href="appendix_b.html#cb78-52" tabindex="-1"></a>                                 b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb78-53"><a href="appendix_b.html#cb78-53" tabindex="-1"></a>                                 b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">+</span> </span>
<span id="cb78-54"><a href="appendix_b.html#cb78-54" tabindex="-1"></a>                             ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-55"><a href="appendix_b.html#cb78-55" tabindex="-1"></a>                                 b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-56"><a href="appendix_b.html#cb78-56" tabindex="-1"></a>                                 b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-57"><a href="appendix_b.html#cb78-57" tabindex="-1"></a>                                 b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb78-58"><a href="appendix_b.html#cb78-58" tabindex="-1"></a>                                 b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-59"><a href="appendix_b.html#cb78-59" tabindex="-1"></a>                                 b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb78-60"><a href="appendix_b.html#cb78-60" tabindex="-1"></a>                                 b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb78-61"><a href="appendix_b.html#cb78-61" tabindex="-1"></a>      ( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-62"><a href="appendix_b.html#cb78-62" tabindex="-1"></a>          b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-63"><a href="appendix_b.html#cb78-63" tabindex="-1"></a>          b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-64"><a href="appendix_b.html#cb78-64" tabindex="-1"></a>          b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-65"><a href="appendix_b.html#cb78-65" tabindex="-1"></a>          b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> ) <span class="sc">*</span> </span>
<span id="cb78-66"><a href="appendix_b.html#cb78-66" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-67"><a href="appendix_b.html#cb78-67" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-68"><a href="appendix_b.html#cb78-68" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb78-69"><a href="appendix_b.html#cb78-69" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb78-70"><a href="appendix_b.html#cb78-70" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-71"><a href="appendix_b.html#cb78-71" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>]))</span>
<span id="cb78-72"><a href="appendix_b.html#cb78-72" tabindex="-1"></a>    </span>
<span id="cb78-73"><a href="appendix_b.html#cb78-73" tabindex="-1"></a>    <span class="co"># INTmed </span></span>
<span id="cb78-74"><a href="appendix_b.html#cb78-74" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.intmed&quot;</span>] <span class="ot">&lt;-</span> ( ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-75"><a href="appendix_b.html#cb78-75" tabindex="-1"></a>                               b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-76"><a href="appendix_b.html#cb78-76" tabindex="-1"></a>                               b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-77"><a href="appendix_b.html#cb78-77" tabindex="-1"></a>                               b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb78-78"><a href="appendix_b.html#cb78-78" tabindex="-1"></a>                               b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-79"><a href="appendix_b.html#cb78-79" tabindex="-1"></a>                               b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb78-80"><a href="appendix_b.html#cb78-80" tabindex="-1"></a>                               b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb78-81"><a href="appendix_b.html#cb78-81" tabindex="-1"></a>                             ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-82"><a href="appendix_b.html#cb78-82" tabindex="-1"></a>                                 b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-83"><a href="appendix_b.html#cb78-83" tabindex="-1"></a>                                 b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-84"><a href="appendix_b.html#cb78-84" tabindex="-1"></a>                                 b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb78-85"><a href="appendix_b.html#cb78-85" tabindex="-1"></a>                                 b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-86"><a href="appendix_b.html#cb78-86" tabindex="-1"></a>                                 b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb78-87"><a href="appendix_b.html#cb78-87" tabindex="-1"></a>                                 b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb78-88"><a href="appendix_b.html#cb78-88" tabindex="-1"></a>                             ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-89"><a href="appendix_b.html#cb78-89" tabindex="-1"></a>                                 b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-90"><a href="appendix_b.html#cb78-90" tabindex="-1"></a>                                 b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-91"><a href="appendix_b.html#cb78-91" tabindex="-1"></a>                                 b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb78-92"><a href="appendix_b.html#cb78-92" tabindex="-1"></a>                                 b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-93"><a href="appendix_b.html#cb78-93" tabindex="-1"></a>                                 b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb78-94"><a href="appendix_b.html#cb78-94" tabindex="-1"></a>                                 b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">+</span> </span>
<span id="cb78-95"><a href="appendix_b.html#cb78-95" tabindex="-1"></a>                             ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-96"><a href="appendix_b.html#cb78-96" tabindex="-1"></a>                                 b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-97"><a href="appendix_b.html#cb78-97" tabindex="-1"></a>                                 b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-98"><a href="appendix_b.html#cb78-98" tabindex="-1"></a>                                 b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb78-99"><a href="appendix_b.html#cb78-99" tabindex="-1"></a>                                 b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-100"><a href="appendix_b.html#cb78-100" tabindex="-1"></a>                                 b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb78-101"><a href="appendix_b.html#cb78-101" tabindex="-1"></a>                                 b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb78-102"><a href="appendix_b.html#cb78-102" tabindex="-1"></a>      ( ( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-103"><a href="appendix_b.html#cb78-103" tabindex="-1"></a>            b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-104"><a href="appendix_b.html#cb78-104" tabindex="-1"></a>            b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-105"><a href="appendix_b.html#cb78-105" tabindex="-1"></a>            b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-106"><a href="appendix_b.html#cb78-106" tabindex="-1"></a>            b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> ) <span class="sc">-</span> </span>
<span id="cb78-107"><a href="appendix_b.html#cb78-107" tabindex="-1"></a>          ( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-108"><a href="appendix_b.html#cb78-108" tabindex="-1"></a>              b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-109"><a href="appendix_b.html#cb78-109" tabindex="-1"></a>              b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-110"><a href="appendix_b.html#cb78-110" tabindex="-1"></a>              b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-111"><a href="appendix_b.html#cb78-111" tabindex="-1"></a>              b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )) <span class="sc">*</span> </span>
<span id="cb78-112"><a href="appendix_b.html#cb78-112" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-113"><a href="appendix_b.html#cb78-113" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-114"><a href="appendix_b.html#cb78-114" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb78-115"><a href="appendix_b.html#cb78-115" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb78-116"><a href="appendix_b.html#cb78-116" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-117"><a href="appendix_b.html#cb78-117" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb78-118"><a href="appendix_b.html#cb78-118" tabindex="-1"></a>    </span>
<span id="cb78-119"><a href="appendix_b.html#cb78-119" tabindex="-1"></a>    <span class="co"># PIE </span></span>
<span id="cb78-120"><a href="appendix_b.html#cb78-120" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.pie&quot;</span>] <span class="ot">&lt;-</span> ( ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-121"><a href="appendix_b.html#cb78-121" tabindex="-1"></a>                            b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-122"><a href="appendix_b.html#cb78-122" tabindex="-1"></a>                            b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-123"><a href="appendix_b.html#cb78-123" tabindex="-1"></a>                            b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb78-124"><a href="appendix_b.html#cb78-124" tabindex="-1"></a>                            b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-125"><a href="appendix_b.html#cb78-125" tabindex="-1"></a>                            b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb78-126"><a href="appendix_b.html#cb78-126" tabindex="-1"></a>                            b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb78-127"><a href="appendix_b.html#cb78-127" tabindex="-1"></a>                          ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-128"><a href="appendix_b.html#cb78-128" tabindex="-1"></a>                              b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-129"><a href="appendix_b.html#cb78-129" tabindex="-1"></a>                              b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-130"><a href="appendix_b.html#cb78-130" tabindex="-1"></a>                              b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb78-131"><a href="appendix_b.html#cb78-131" tabindex="-1"></a>                              b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-132"><a href="appendix_b.html#cb78-132" tabindex="-1"></a>                              b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb78-133"><a href="appendix_b.html#cb78-133" tabindex="-1"></a>                              b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) ) <span class="sc">*</span></span>
<span id="cb78-134"><a href="appendix_b.html#cb78-134" tabindex="-1"></a>      ( ( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-135"><a href="appendix_b.html#cb78-135" tabindex="-1"></a>            b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-136"><a href="appendix_b.html#cb78-136" tabindex="-1"></a>            b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-137"><a href="appendix_b.html#cb78-137" tabindex="-1"></a>            b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-138"><a href="appendix_b.html#cb78-138" tabindex="-1"></a>            b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> ) <span class="sc">-</span> </span>
<span id="cb78-139"><a href="appendix_b.html#cb78-139" tabindex="-1"></a>          ( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-140"><a href="appendix_b.html#cb78-140" tabindex="-1"></a>              b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-141"><a href="appendix_b.html#cb78-141" tabindex="-1"></a>              b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-142"><a href="appendix_b.html#cb78-142" tabindex="-1"></a>              b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-143"><a href="appendix_b.html#cb78-143" tabindex="-1"></a>              b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )) <span class="sc">*</span> </span>
<span id="cb78-144"><a href="appendix_b.html#cb78-144" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-145"><a href="appendix_b.html#cb78-145" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-146"><a href="appendix_b.html#cb78-146" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb78-147"><a href="appendix_b.html#cb78-147" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb78-148"><a href="appendix_b.html#cb78-148" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-149"><a href="appendix_b.html#cb78-149" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb78-150"><a href="appendix_b.html#cb78-150" tabindex="-1"></a>    }</span>
<span id="cb78-151"><a href="appendix_b.html#cb78-151" tabindex="-1"></a>  </span>
<span id="cb78-152"><a href="appendix_b.html#cb78-152" tabindex="-1"></a>  CDE.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.cde&quot;</span>])</span>
<span id="cb78-153"><a href="appendix_b.html#cb78-153" tabindex="-1"></a>  INTref.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.intref&quot;</span>])</span>
<span id="cb78-154"><a href="appendix_b.html#cb78-154" tabindex="-1"></a>  INTmed.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.intmed&quot;</span>])</span>
<span id="cb78-155"><a href="appendix_b.html#cb78-155" tabindex="-1"></a>  PIE.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.pie&quot;</span>])</span>
<span id="cb78-156"><a href="appendix_b.html#cb78-156" tabindex="-1"></a>  </span>
<span id="cb78-157"><a href="appendix_b.html#cb78-157" tabindex="-1"></a>  <span class="co"># quantitative outcome (QoL)</span></span>
<span id="cb78-158"><a href="appendix_b.html#cb78-158" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">3</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">3</span>), </span>
<span id="cb78-159"><a href="appendix_b.html#cb78-159" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">3</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb78-160"><a href="appendix_b.html#cb78-160" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>, <span class="st">&quot;L1&quot;</span>, <span class="st">&quot;sum.cde&quot;</span>, <span class="st">&quot;sum.intref&quot;</span>, </span>
<span id="cb78-161"><a href="appendix_b.html#cb78-161" tabindex="-1"></a>                      <span class="st">&quot;sum.intmed&quot;</span>, <span class="st">&quot;sum.pie&quot;</span>)</span>
<span id="cb78-162"><a href="appendix_b.html#cb78-162" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>) {</span>
<span id="cb78-163"><a href="appendix_b.html#cb78-163" tabindex="-1"></a>    <span class="co"># CDE </span></span>
<span id="cb78-164"><a href="appendix_b.html#cb78-164" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.cde&quot;</span>] <span class="ot">&lt;-</span> ( ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-165"><a href="appendix_b.html#cb78-165" tabindex="-1"></a>                            b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-166"><a href="appendix_b.html#cb78-166" tabindex="-1"></a>                            b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-167"><a href="appendix_b.html#cb78-167" tabindex="-1"></a>                            b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb78-168"><a href="appendix_b.html#cb78-168" tabindex="-1"></a>                            b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-169"><a href="appendix_b.html#cb78-169" tabindex="-1"></a>                            b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb78-170"><a href="appendix_b.html#cb78-170" tabindex="-1"></a>                            b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb78-171"><a href="appendix_b.html#cb78-171" tabindex="-1"></a>                          ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-172"><a href="appendix_b.html#cb78-172" tabindex="-1"></a>                              b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-173"><a href="appendix_b.html#cb78-173" tabindex="-1"></a>                              b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-174"><a href="appendix_b.html#cb78-174" tabindex="-1"></a>                              b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb78-175"><a href="appendix_b.html#cb78-175" tabindex="-1"></a>                              b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-176"><a href="appendix_b.html#cb78-176" tabindex="-1"></a>                              b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb78-177"><a href="appendix_b.html#cb78-177" tabindex="-1"></a>                              b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) ) <span class="sc">*</span></span>
<span id="cb78-178"><a href="appendix_b.html#cb78-178" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-179"><a href="appendix_b.html#cb78-179" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-180"><a href="appendix_b.html#cb78-180" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb78-181"><a href="appendix_b.html#cb78-181" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb78-182"><a href="appendix_b.html#cb78-182" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-183"><a href="appendix_b.html#cb78-183" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb78-184"><a href="appendix_b.html#cb78-184" tabindex="-1"></a>    </span>
<span id="cb78-185"><a href="appendix_b.html#cb78-185" tabindex="-1"></a>    <span class="co"># INTref </span></span>
<span id="cb78-186"><a href="appendix_b.html#cb78-186" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.intref&quot;</span>] <span class="ot">&lt;-</span> ( ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-187"><a href="appendix_b.html#cb78-187" tabindex="-1"></a>                               b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-188"><a href="appendix_b.html#cb78-188" tabindex="-1"></a>                               b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-189"><a href="appendix_b.html#cb78-189" tabindex="-1"></a>                               b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb78-190"><a href="appendix_b.html#cb78-190" tabindex="-1"></a>                               b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-191"><a href="appendix_b.html#cb78-191" tabindex="-1"></a>                               b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb78-192"><a href="appendix_b.html#cb78-192" tabindex="-1"></a>                               b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb78-193"><a href="appendix_b.html#cb78-193" tabindex="-1"></a>                             ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-194"><a href="appendix_b.html#cb78-194" tabindex="-1"></a>                                 b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-195"><a href="appendix_b.html#cb78-195" tabindex="-1"></a>                                 b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-196"><a href="appendix_b.html#cb78-196" tabindex="-1"></a>                                 b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb78-197"><a href="appendix_b.html#cb78-197" tabindex="-1"></a>                                 b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-198"><a href="appendix_b.html#cb78-198" tabindex="-1"></a>                                 b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb78-199"><a href="appendix_b.html#cb78-199" tabindex="-1"></a>                                 b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb78-200"><a href="appendix_b.html#cb78-200" tabindex="-1"></a>                             ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-201"><a href="appendix_b.html#cb78-201" tabindex="-1"></a>                                 b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-202"><a href="appendix_b.html#cb78-202" tabindex="-1"></a>                                 b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-203"><a href="appendix_b.html#cb78-203" tabindex="-1"></a>                                 b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb78-204"><a href="appendix_b.html#cb78-204" tabindex="-1"></a>                                 b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-205"><a href="appendix_b.html#cb78-205" tabindex="-1"></a>                                 b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb78-206"><a href="appendix_b.html#cb78-206" tabindex="-1"></a>                                 b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">+</span> </span>
<span id="cb78-207"><a href="appendix_b.html#cb78-207" tabindex="-1"></a>                             ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-208"><a href="appendix_b.html#cb78-208" tabindex="-1"></a>                                 b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-209"><a href="appendix_b.html#cb78-209" tabindex="-1"></a>                                 b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-210"><a href="appendix_b.html#cb78-210" tabindex="-1"></a>                                 b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb78-211"><a href="appendix_b.html#cb78-211" tabindex="-1"></a>                                 b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-212"><a href="appendix_b.html#cb78-212" tabindex="-1"></a>                                 b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb78-213"><a href="appendix_b.html#cb78-213" tabindex="-1"></a>                                 b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb78-214"><a href="appendix_b.html#cb78-214" tabindex="-1"></a>      ( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-215"><a href="appendix_b.html#cb78-215" tabindex="-1"></a>          b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-216"><a href="appendix_b.html#cb78-216" tabindex="-1"></a>          b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-217"><a href="appendix_b.html#cb78-217" tabindex="-1"></a>          b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-218"><a href="appendix_b.html#cb78-218" tabindex="-1"></a>          b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> ) <span class="sc">*</span> </span>
<span id="cb78-219"><a href="appendix_b.html#cb78-219" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-220"><a href="appendix_b.html#cb78-220" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-221"><a href="appendix_b.html#cb78-221" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb78-222"><a href="appendix_b.html#cb78-222" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb78-223"><a href="appendix_b.html#cb78-223" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-224"><a href="appendix_b.html#cb78-224" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb78-225"><a href="appendix_b.html#cb78-225" tabindex="-1"></a>    </span>
<span id="cb78-226"><a href="appendix_b.html#cb78-226" tabindex="-1"></a>    <span class="co"># INTmed </span></span>
<span id="cb78-227"><a href="appendix_b.html#cb78-227" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.intmed&quot;</span>] <span class="ot">&lt;-</span> ( ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-228"><a href="appendix_b.html#cb78-228" tabindex="-1"></a>                               b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-229"><a href="appendix_b.html#cb78-229" tabindex="-1"></a>                               b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-230"><a href="appendix_b.html#cb78-230" tabindex="-1"></a>                               b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb78-231"><a href="appendix_b.html#cb78-231" tabindex="-1"></a>                               b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-232"><a href="appendix_b.html#cb78-232" tabindex="-1"></a>                               b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb78-233"><a href="appendix_b.html#cb78-233" tabindex="-1"></a>                               b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb78-234"><a href="appendix_b.html#cb78-234" tabindex="-1"></a>                             ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-235"><a href="appendix_b.html#cb78-235" tabindex="-1"></a>                                 b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-236"><a href="appendix_b.html#cb78-236" tabindex="-1"></a>                                 b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-237"><a href="appendix_b.html#cb78-237" tabindex="-1"></a>                                 b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb78-238"><a href="appendix_b.html#cb78-238" tabindex="-1"></a>                                 b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-239"><a href="appendix_b.html#cb78-239" tabindex="-1"></a>                                 b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb78-240"><a href="appendix_b.html#cb78-240" tabindex="-1"></a>                                 b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb78-241"><a href="appendix_b.html#cb78-241" tabindex="-1"></a>                             ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-242"><a href="appendix_b.html#cb78-242" tabindex="-1"></a>                                 b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-243"><a href="appendix_b.html#cb78-243" tabindex="-1"></a>                                 b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-244"><a href="appendix_b.html#cb78-244" tabindex="-1"></a>                                 b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb78-245"><a href="appendix_b.html#cb78-245" tabindex="-1"></a>                                 b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-246"><a href="appendix_b.html#cb78-246" tabindex="-1"></a>                                 b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb78-247"><a href="appendix_b.html#cb78-247" tabindex="-1"></a>                                 b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">+</span> </span>
<span id="cb78-248"><a href="appendix_b.html#cb78-248" tabindex="-1"></a>                             ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-249"><a href="appendix_b.html#cb78-249" tabindex="-1"></a>                                 b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-250"><a href="appendix_b.html#cb78-250" tabindex="-1"></a>                                 b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-251"><a href="appendix_b.html#cb78-251" tabindex="-1"></a>                                 b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb78-252"><a href="appendix_b.html#cb78-252" tabindex="-1"></a>                                 b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-253"><a href="appendix_b.html#cb78-253" tabindex="-1"></a>                                 b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb78-254"><a href="appendix_b.html#cb78-254" tabindex="-1"></a>                                 b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb78-255"><a href="appendix_b.html#cb78-255" tabindex="-1"></a>      ( ( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-256"><a href="appendix_b.html#cb78-256" tabindex="-1"></a>            b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-257"><a href="appendix_b.html#cb78-257" tabindex="-1"></a>            b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-258"><a href="appendix_b.html#cb78-258" tabindex="-1"></a>            b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-259"><a href="appendix_b.html#cb78-259" tabindex="-1"></a>            b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> ) <span class="sc">-</span> </span>
<span id="cb78-260"><a href="appendix_b.html#cb78-260" tabindex="-1"></a>          ( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-261"><a href="appendix_b.html#cb78-261" tabindex="-1"></a>              b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-262"><a href="appendix_b.html#cb78-262" tabindex="-1"></a>              b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-263"><a href="appendix_b.html#cb78-263" tabindex="-1"></a>              b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-264"><a href="appendix_b.html#cb78-264" tabindex="-1"></a>              b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )) <span class="sc">*</span> </span>
<span id="cb78-265"><a href="appendix_b.html#cb78-265" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-266"><a href="appendix_b.html#cb78-266" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-267"><a href="appendix_b.html#cb78-267" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb78-268"><a href="appendix_b.html#cb78-268" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb78-269"><a href="appendix_b.html#cb78-269" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-270"><a href="appendix_b.html#cb78-270" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb78-271"><a href="appendix_b.html#cb78-271" tabindex="-1"></a>    </span>
<span id="cb78-272"><a href="appendix_b.html#cb78-272" tabindex="-1"></a>    <span class="co"># PIE </span></span>
<span id="cb78-273"><a href="appendix_b.html#cb78-273" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.pie&quot;</span>] <span class="ot">&lt;-</span> ( ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-274"><a href="appendix_b.html#cb78-274" tabindex="-1"></a>                            b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-275"><a href="appendix_b.html#cb78-275" tabindex="-1"></a>                            b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-276"><a href="appendix_b.html#cb78-276" tabindex="-1"></a>                            b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb78-277"><a href="appendix_b.html#cb78-277" tabindex="-1"></a>                            b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-278"><a href="appendix_b.html#cb78-278" tabindex="-1"></a>                            b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb78-279"><a href="appendix_b.html#cb78-279" tabindex="-1"></a>                            b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">-</span> </span>
<span id="cb78-280"><a href="appendix_b.html#cb78-280" tabindex="-1"></a>                          ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-281"><a href="appendix_b.html#cb78-281" tabindex="-1"></a>                              b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-282"><a href="appendix_b.html#cb78-282" tabindex="-1"></a>                              b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-283"><a href="appendix_b.html#cb78-283" tabindex="-1"></a>                              b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb78-284"><a href="appendix_b.html#cb78-284" tabindex="-1"></a>                              b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-285"><a href="appendix_b.html#cb78-285" tabindex="-1"></a>                              b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb78-286"><a href="appendix_b.html#cb78-286" tabindex="-1"></a>                              b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) ) <span class="sc">*</span></span>
<span id="cb78-287"><a href="appendix_b.html#cb78-287" tabindex="-1"></a>      ( ( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-288"><a href="appendix_b.html#cb78-288" tabindex="-1"></a>            b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-289"><a href="appendix_b.html#cb78-289" tabindex="-1"></a>            b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-290"><a href="appendix_b.html#cb78-290" tabindex="-1"></a>            b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-291"><a href="appendix_b.html#cb78-291" tabindex="-1"></a>            b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> ) <span class="sc">-</span> </span>
<span id="cb78-292"><a href="appendix_b.html#cb78-292" tabindex="-1"></a>          ( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-293"><a href="appendix_b.html#cb78-293" tabindex="-1"></a>              b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-294"><a href="appendix_b.html#cb78-294" tabindex="-1"></a>              b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb78-295"><a href="appendix_b.html#cb78-295" tabindex="-1"></a>              b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb78-296"><a href="appendix_b.html#cb78-296" tabindex="-1"></a>              b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )) <span class="sc">*</span> </span>
<span id="cb78-297"><a href="appendix_b.html#cb78-297" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-298"><a href="appendix_b.html#cb78-298" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-299"><a href="appendix_b.html#cb78-299" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb78-300"><a href="appendix_b.html#cb78-300" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb78-301"><a href="appendix_b.html#cb78-301" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb78-302"><a href="appendix_b.html#cb78-302" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb78-303"><a href="appendix_b.html#cb78-303" tabindex="-1"></a>    }</span>
<span id="cb78-304"><a href="appendix_b.html#cb78-304" tabindex="-1"></a>  </span>
<span id="cb78-305"><a href="appendix_b.html#cb78-305" tabindex="-1"></a>  CDE.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.cde&quot;</span>])</span>
<span id="cb78-306"><a href="appendix_b.html#cb78-306" tabindex="-1"></a>  INTref.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.intref&quot;</span>])</span>
<span id="cb78-307"><a href="appendix_b.html#cb78-307" tabindex="-1"></a>  INTmed.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.intmed&quot;</span>])</span>
<span id="cb78-308"><a href="appendix_b.html#cb78-308" tabindex="-1"></a>  PIE.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.pie&quot;</span>])</span>
<span id="cb78-309"><a href="appendix_b.html#cb78-309" tabindex="-1"></a>  </span>
<span id="cb78-310"><a href="appendix_b.html#cb78-310" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">CDE.death =</span> CDE.death, <span class="at">INTref.death =</span> INTref.death, </span>
<span id="cb78-311"><a href="appendix_b.html#cb78-311" tabindex="-1"></a>              <span class="at">INTmed.death =</span> INTmed.death, <span class="at">PIE.death =</span> PIE.death,</span>
<span id="cb78-312"><a href="appendix_b.html#cb78-312" tabindex="-1"></a>              <span class="at">CDE.qol =</span> CDE.qol, <span class="at">INTref.qol =</span> INTref.qol, </span>
<span id="cb78-313"><a href="appendix_b.html#cb78-313" tabindex="-1"></a>              <span class="at">INTmed.qol =</span> INTmed.qol, <span class="at">PIE.qol =</span> PIE.qol))</span>
<span id="cb78-314"><a href="appendix_b.html#cb78-314" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="appendix_b.html#cb79-1" tabindex="-1"></a>true<span class="fl">.4</span>way.no.inter <span class="ot">&lt;-</span> <span class="fu">true.4way.decomp</span>(<span class="at">interaction =</span> <span class="dv">0</span>)</span>
<span id="cb79-2"><a href="appendix_b.html#cb79-2" tabindex="-1"></a></span>
<span id="cb79-3"><a href="appendix_b.html#cb79-3" tabindex="-1"></a>true<span class="fl">.4</span>way.with.inter <span class="ot">&lt;-</span> <span class="fu">true.4way.decomp</span>(<span class="at">interaction =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>The <span class="math inline">\(\text{CDE}=\mathbb{E}\left(Y_{1,0} \right) - \mathbb{E}\left(Y_{0,0}\right)\)</span>, <span class="math inline">\(\text{RIE}=\left((Y_{1,1} - Y_{1,0} - Y_{0,1} + Y_{0,0}) \times M_0\right)\)</span>, <span class="math inline">\(\text{MIE}= \mathbb{E}\left((Y_{1,1} - Y_{1,0} - Y_{0,1} + Y_{0,0}) \times (M_1 - M_0)\right)\)</span> and <span class="math inline">\(\text{PNIE}=\mathbb{E}\left(Y_{0,M_1}\right) - \mathbb{E}\left(Y_{0,M_0}\right)\)</span> are respectively:</p>
<ul>
<li>0.05, 0.000, 0.000 and 0.008 for death without interaction,</li>
<li>0.05, 0.00855, 0.003 and 0.008 for death with interaction,</li>
<li>-4, 0, 0 and -0.9 for quality of life without interaction,</li>
<li>-4, -1.425, -0.5 and -0.9 for quality of life with interaction.</li>
</ul>
</div>
<div id="marginal-randomized-direct-and-indirect-effects" class="section level3 hasAnchor" number="11.1.7">
<h3><span class="header-section-number">11.1.7</span> Marginal randomized direct and indirect effects<a href="appendix_b.html#marginal-randomized-direct-and-indirect-effects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following function <code>true.marg.random</code> can be used to run the calculation for the marginal randomized natural direct (marginal MRDE) and indirect effects (marginal MRIE).</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="appendix_b.html#cb80-1" tabindex="-1"></a>true.marg.random <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">interaction =</span> <span class="cn">NULL</span>) {</span>
<span id="cb80-2"><a href="appendix_b.html#cb80-2" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">param.causal.model.1</span>(<span class="at">A.M.interaction =</span> interaction)</span>
<span id="cb80-3"><a href="appendix_b.html#cb80-3" tabindex="-1"></a>  </span>
<span id="cb80-4"><a href="appendix_b.html#cb80-4" tabindex="-1"></a>  <span class="co"># marginal distribution of M</span></span>
<span id="cb80-5"><a href="appendix_b.html#cb80-5" tabindex="-1"></a>  M.S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">5</span>))</span>
<span id="cb80-6"><a href="appendix_b.html#cb80-6" tabindex="-1"></a>  <span class="fu">colnames</span>(M.S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;sum&quot;</span>)</span>
<span id="cb80-7"><a href="appendix_b.html#cb80-7" tabindex="-1"></a>  </span>
<span id="cb80-8"><a href="appendix_b.html#cb80-8" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">32</span>) {</span>
<span id="cb80-9"><a href="appendix_b.html#cb80-9" tabindex="-1"></a>    M.S[n,<span class="st">&quot;sum&quot;</span>] <span class="ot">&lt;-</span> (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span>                                                              </span>
<span id="cb80-10"><a href="appendix_b.html#cb80-10" tabindex="-1"></a>                         b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb80-11"><a href="appendix_b.html#cb80-11" tabindex="-1"></a>                         b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb80-12"><a href="appendix_b.html#cb80-12" tabindex="-1"></a>                         b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb80-13"><a href="appendix_b.html#cb80-13" tabindex="-1"></a>                         b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;A&quot;</span>])<span class="sc">^</span>( M.S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb80-14"><a href="appendix_b.html#cb80-14" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb80-15"><a href="appendix_b.html#cb80-15" tabindex="-1"></a>                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb80-16"><a href="appendix_b.html#cb80-16" tabindex="-1"></a>                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb80-17"><a href="appendix_b.html#cb80-17" tabindex="-1"></a>                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb80-18"><a href="appendix_b.html#cb80-18" tabindex="-1"></a>                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;A&quot;</span>]) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> M.S[n,<span class="st">&quot;M&quot;</span>] )) </span>
<span id="cb80-19"><a href="appendix_b.html#cb80-19" tabindex="-1"></a>    }</span>
<span id="cb80-20"><a href="appendix_b.html#cb80-20" tabindex="-1"></a>  </span>
<span id="cb80-21"><a href="appendix_b.html#cb80-21" tabindex="-1"></a>  M0.A0.L0_00.L1_0 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb80-22"><a href="appendix_b.html#cb80-22" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-23"><a href="appendix_b.html#cb80-23" tabindex="-1"></a>  M0.A0.L0_01.L1_0 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb80-24"><a href="appendix_b.html#cb80-24" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-25"><a href="appendix_b.html#cb80-25" tabindex="-1"></a>  M0.A0.L0_10.L1_0 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb80-26"><a href="appendix_b.html#cb80-26" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-27"><a href="appendix_b.html#cb80-27" tabindex="-1"></a>  M0.A0.L0_11.L1_0 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb80-28"><a href="appendix_b.html#cb80-28" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-29"><a href="appendix_b.html#cb80-29" tabindex="-1"></a>  M0.A0.L0_00.L1_1 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb80-30"><a href="appendix_b.html#cb80-30" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-31"><a href="appendix_b.html#cb80-31" tabindex="-1"></a>  M0.A0.L0_01.L1_1 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb80-32"><a href="appendix_b.html#cb80-32" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-33"><a href="appendix_b.html#cb80-33" tabindex="-1"></a>  M0.A0.L0_10.L1_1 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb80-34"><a href="appendix_b.html#cb80-34" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-35"><a href="appendix_b.html#cb80-35" tabindex="-1"></a>  M0.A0.L0_11.L1_1 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb80-36"><a href="appendix_b.html#cb80-36" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-37"><a href="appendix_b.html#cb80-37" tabindex="-1"></a>  </span>
<span id="cb80-38"><a href="appendix_b.html#cb80-38" tabindex="-1"></a>  M1.A0.L0_00.L1_0 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb80-39"><a href="appendix_b.html#cb80-39" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-40"><a href="appendix_b.html#cb80-40" tabindex="-1"></a>  M1.A0.L0_01.L1_0 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb80-41"><a href="appendix_b.html#cb80-41" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-42"><a href="appendix_b.html#cb80-42" tabindex="-1"></a>  M1.A0.L0_10.L1_0 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb80-43"><a href="appendix_b.html#cb80-43" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-44"><a href="appendix_b.html#cb80-44" tabindex="-1"></a>  M1.A0.L0_11.L1_0 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb80-45"><a href="appendix_b.html#cb80-45" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-46"><a href="appendix_b.html#cb80-46" tabindex="-1"></a>  M1.A0.L0_00.L1_1 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb80-47"><a href="appendix_b.html#cb80-47" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-48"><a href="appendix_b.html#cb80-48" tabindex="-1"></a>  M1.A0.L0_01.L1_1 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb80-49"><a href="appendix_b.html#cb80-49" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-50"><a href="appendix_b.html#cb80-50" tabindex="-1"></a>  M1.A0.L0_10.L1_1 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb80-51"><a href="appendix_b.html#cb80-51" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-52"><a href="appendix_b.html#cb80-52" tabindex="-1"></a>  M1.A0.L0_11.L1_1 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb80-53"><a href="appendix_b.html#cb80-53" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-54"><a href="appendix_b.html#cb80-54" tabindex="-1"></a>  </span>
<span id="cb80-55"><a href="appendix_b.html#cb80-55" tabindex="-1"></a>  M0.A1.L0_00.L1_0 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb80-56"><a href="appendix_b.html#cb80-56" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-57"><a href="appendix_b.html#cb80-57" tabindex="-1"></a>  M0.A1.L0_01.L1_0 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb80-58"><a href="appendix_b.html#cb80-58" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-59"><a href="appendix_b.html#cb80-59" tabindex="-1"></a>  M0.A1.L0_10.L1_0 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb80-60"><a href="appendix_b.html#cb80-60" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-61"><a href="appendix_b.html#cb80-61" tabindex="-1"></a>  M0.A1.L0_11.L1_0 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb80-62"><a href="appendix_b.html#cb80-62" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-63"><a href="appendix_b.html#cb80-63" tabindex="-1"></a>  M0.A1.L0_00.L1_1 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb80-64"><a href="appendix_b.html#cb80-64" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-65"><a href="appendix_b.html#cb80-65" tabindex="-1"></a>  M0.A1.L0_01.L1_1 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb80-66"><a href="appendix_b.html#cb80-66" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-67"><a href="appendix_b.html#cb80-67" tabindex="-1"></a>  M0.A1.L0_10.L1_1 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb80-68"><a href="appendix_b.html#cb80-68" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-69"><a href="appendix_b.html#cb80-69" tabindex="-1"></a>  M0.A1.L0_11.L1_1 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb80-70"><a href="appendix_b.html#cb80-70" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-71"><a href="appendix_b.html#cb80-71" tabindex="-1"></a>  </span>
<span id="cb80-72"><a href="appendix_b.html#cb80-72" tabindex="-1"></a>  M1.A1.L0_00.L1_0 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb80-73"><a href="appendix_b.html#cb80-73" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-74"><a href="appendix_b.html#cb80-74" tabindex="-1"></a>  M1.A1.L0_01.L1_0 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb80-75"><a href="appendix_b.html#cb80-75" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-76"><a href="appendix_b.html#cb80-76" tabindex="-1"></a>  M1.A1.L0_10.L1_0 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb80-77"><a href="appendix_b.html#cb80-77" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-78"><a href="appendix_b.html#cb80-78" tabindex="-1"></a>  M1.A1.L0_11.L1_0 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb80-79"><a href="appendix_b.html#cb80-79" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-80"><a href="appendix_b.html#cb80-80" tabindex="-1"></a>  M1.A1.L0_00.L1_1 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb80-81"><a href="appendix_b.html#cb80-81" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-82"><a href="appendix_b.html#cb80-82" tabindex="-1"></a>  M1.A1.L0_01.L1_1 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb80-83"><a href="appendix_b.html#cb80-83" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-84"><a href="appendix_b.html#cb80-84" tabindex="-1"></a>  M1.A1.L0_10.L1_1 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb80-85"><a href="appendix_b.html#cb80-85" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-86"><a href="appendix_b.html#cb80-86" tabindex="-1"></a>  M1.A1.L0_11.L1_1 <span class="ot">&lt;-</span> M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb80-87"><a href="appendix_b.html#cb80-87" tabindex="-1"></a>                            M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>]</span>
<span id="cb80-88"><a href="appendix_b.html#cb80-88" tabindex="-1"></a>  </span>
<span id="cb80-89"><a href="appendix_b.html#cb80-89" tabindex="-1"></a>  <span class="co"># binary outcome (death)</span></span>
<span id="cb80-90"><a href="appendix_b.html#cb80-90" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), </span>
<span id="cb80-91"><a href="appendix_b.html#cb80-91" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb80-92"><a href="appendix_b.html#cb80-92" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum.psi11&quot;</span>, <span class="st">&quot;sum.psi10&quot;</span>, <span class="st">&quot;sum.psi00&quot;</span>)</span>
<span id="cb80-93"><a href="appendix_b.html#cb80-93" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb80-94"><a href="appendix_b.html#cb80-94" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi11&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span>                                            <span class="co"># A=1</span></span>
<span id="cb80-95"><a href="appendix_b.html#cb80-95" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb80-96"><a href="appendix_b.html#cb80-96" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb80-97"><a href="appendix_b.html#cb80-97" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb80-98"><a href="appendix_b.html#cb80-98" tabindex="-1"></a>                             b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb80-99"><a href="appendix_b.html#cb80-99" tabindex="-1"></a>                             b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb80-100"><a href="appendix_b.html#cb80-100" tabindex="-1"></a>                             b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb80-101"><a href="appendix_b.html#cb80-101" tabindex="-1"></a>      ((M1.A1.L0_00.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> <span class="co"># A&#39;=1             </span></span>
<span id="cb80-102"><a href="appendix_b.html#cb80-102" tabindex="-1"></a>          M1.A1.L0_01.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-103"><a href="appendix_b.html#cb80-103" tabindex="-1"></a>          M1.A1.L0_10.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb80-104"><a href="appendix_b.html#cb80-104" tabindex="-1"></a>          M1.A1.L0_11.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-105"><a href="appendix_b.html#cb80-105" tabindex="-1"></a>          M1.A1.L0_00.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-106"><a href="appendix_b.html#cb80-106" tabindex="-1"></a>          M1.A1.L0_01.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-107"><a href="appendix_b.html#cb80-107" tabindex="-1"></a>          M1.A1.L0_10.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-108"><a href="appendix_b.html#cb80-108" tabindex="-1"></a>          M1.A1.L0_11.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span></span>
<span id="cb80-109"><a href="appendix_b.html#cb80-109" tabindex="-1"></a>          (S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb80-110"><a href="appendix_b.html#cb80-110" tabindex="-1"></a>      ((M0.A1.L0_00.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span>                </span>
<span id="cb80-111"><a href="appendix_b.html#cb80-111" tabindex="-1"></a>          M0.A1.L0_01.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-112"><a href="appendix_b.html#cb80-112" tabindex="-1"></a>          M0.A1.L0_10.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb80-113"><a href="appendix_b.html#cb80-113" tabindex="-1"></a>          M0.A1.L0_11.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-114"><a href="appendix_b.html#cb80-114" tabindex="-1"></a>          M0.A1.L0_00.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-115"><a href="appendix_b.html#cb80-115" tabindex="-1"></a>          M0.A1.L0_01.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-116"><a href="appendix_b.html#cb80-116" tabindex="-1"></a>          M0.A1.L0_10.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-117"><a href="appendix_b.html#cb80-117" tabindex="-1"></a>          M0.A1.L0_11.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span></span>
<span id="cb80-118"><a href="appendix_b.html#cb80-118" tabindex="-1"></a>          (S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb80-119"><a href="appendix_b.html#cb80-119" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(M.S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb80-120"><a href="appendix_b.html#cb80-120" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> M.S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb80-121"><a href="appendix_b.html#cb80-121" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb80-122"><a href="appendix_b.html#cb80-122" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb80-123"><a href="appendix_b.html#cb80-123" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb80-124"><a href="appendix_b.html#cb80-124" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb80-125"><a href="appendix_b.html#cb80-125" tabindex="-1"></a>    </span>
<span id="cb80-126"><a href="appendix_b.html#cb80-126" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi10&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span>                                            <span class="co"># A=1</span></span>
<span id="cb80-127"><a href="appendix_b.html#cb80-127" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb80-128"><a href="appendix_b.html#cb80-128" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb80-129"><a href="appendix_b.html#cb80-129" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb80-130"><a href="appendix_b.html#cb80-130" tabindex="-1"></a>                             b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb80-131"><a href="appendix_b.html#cb80-131" tabindex="-1"></a>                             b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb80-132"><a href="appendix_b.html#cb80-132" tabindex="-1"></a>                             b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb80-133"><a href="appendix_b.html#cb80-133" tabindex="-1"></a>      ((M1.A0.L0_00.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> <span class="co"># A&#39;=0</span></span>
<span id="cb80-134"><a href="appendix_b.html#cb80-134" tabindex="-1"></a>          M1.A0.L0_01.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-135"><a href="appendix_b.html#cb80-135" tabindex="-1"></a>          M1.A0.L0_10.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb80-136"><a href="appendix_b.html#cb80-136" tabindex="-1"></a>          M1.A0.L0_11.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-137"><a href="appendix_b.html#cb80-137" tabindex="-1"></a>          M1.A0.L0_00.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-138"><a href="appendix_b.html#cb80-138" tabindex="-1"></a>          M1.A0.L0_01.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-139"><a href="appendix_b.html#cb80-139" tabindex="-1"></a>          M1.A0.L0_10.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-140"><a href="appendix_b.html#cb80-140" tabindex="-1"></a>          M1.A0.L0_11.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span></span>
<span id="cb80-141"><a href="appendix_b.html#cb80-141" tabindex="-1"></a>          (S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb80-142"><a href="appendix_b.html#cb80-142" tabindex="-1"></a>      ((M0.A0.L0_00.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span>               </span>
<span id="cb80-143"><a href="appendix_b.html#cb80-143" tabindex="-1"></a>          M0.A0.L0_01.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-144"><a href="appendix_b.html#cb80-144" tabindex="-1"></a>          M0.A0.L0_10.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb80-145"><a href="appendix_b.html#cb80-145" tabindex="-1"></a>          M0.A0.L0_11.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-146"><a href="appendix_b.html#cb80-146" tabindex="-1"></a>          M0.A0.L0_00.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-147"><a href="appendix_b.html#cb80-147" tabindex="-1"></a>          M0.A0.L0_01.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-148"><a href="appendix_b.html#cb80-148" tabindex="-1"></a>          M0.A0.L0_10.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-149"><a href="appendix_b.html#cb80-149" tabindex="-1"></a>          M0.A0.L0_11.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span></span>
<span id="cb80-150"><a href="appendix_b.html#cb80-150" tabindex="-1"></a>          (S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb80-151"><a href="appendix_b.html#cb80-151" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(M.S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb80-152"><a href="appendix_b.html#cb80-152" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> M.S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb80-153"><a href="appendix_b.html#cb80-153" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb80-154"><a href="appendix_b.html#cb80-154" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb80-155"><a href="appendix_b.html#cb80-155" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb80-156"><a href="appendix_b.html#cb80-156" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb80-157"><a href="appendix_b.html#cb80-157" tabindex="-1"></a>    </span>
<span id="cb80-158"><a href="appendix_b.html#cb80-158" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi00&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span>                                            <span class="co"># A=0</span></span>
<span id="cb80-159"><a href="appendix_b.html#cb80-159" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb80-160"><a href="appendix_b.html#cb80-160" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb80-161"><a href="appendix_b.html#cb80-161" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb80-162"><a href="appendix_b.html#cb80-162" tabindex="-1"></a>                             b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb80-163"><a href="appendix_b.html#cb80-163" tabindex="-1"></a>                             b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb80-164"><a href="appendix_b.html#cb80-164" tabindex="-1"></a>                             b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb80-165"><a href="appendix_b.html#cb80-165" tabindex="-1"></a>      ((M1.A0.L0_00.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> <span class="co"># A&#39;=0</span></span>
<span id="cb80-166"><a href="appendix_b.html#cb80-166" tabindex="-1"></a>          M1.A0.L0_01.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-167"><a href="appendix_b.html#cb80-167" tabindex="-1"></a>          M1.A0.L0_10.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb80-168"><a href="appendix_b.html#cb80-168" tabindex="-1"></a>          M1.A0.L0_11.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-169"><a href="appendix_b.html#cb80-169" tabindex="-1"></a>          M1.A0.L0_00.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-170"><a href="appendix_b.html#cb80-170" tabindex="-1"></a>          M1.A0.L0_01.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-171"><a href="appendix_b.html#cb80-171" tabindex="-1"></a>          M1.A0.L0_10.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-172"><a href="appendix_b.html#cb80-172" tabindex="-1"></a>          M1.A0.L0_11.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span></span>
<span id="cb80-173"><a href="appendix_b.html#cb80-173" tabindex="-1"></a>          (S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb80-174"><a href="appendix_b.html#cb80-174" tabindex="-1"></a>      ((M0.A0.L0_00.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span>               </span>
<span id="cb80-175"><a href="appendix_b.html#cb80-175" tabindex="-1"></a>          M0.A0.L0_01.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-176"><a href="appendix_b.html#cb80-176" tabindex="-1"></a>          M0.A0.L0_10.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb80-177"><a href="appendix_b.html#cb80-177" tabindex="-1"></a>          M0.A0.L0_11.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-178"><a href="appendix_b.html#cb80-178" tabindex="-1"></a>          M0.A0.L0_00.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-179"><a href="appendix_b.html#cb80-179" tabindex="-1"></a>          M0.A0.L0_01.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-180"><a href="appendix_b.html#cb80-180" tabindex="-1"></a>          M0.A0.L0_10.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-181"><a href="appendix_b.html#cb80-181" tabindex="-1"></a>          M0.A0.L0_11.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span></span>
<span id="cb80-182"><a href="appendix_b.html#cb80-182" tabindex="-1"></a>          (S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb80-183"><a href="appendix_b.html#cb80-183" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(M.S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb80-184"><a href="appendix_b.html#cb80-184" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> M.S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb80-185"><a href="appendix_b.html#cb80-185" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb80-186"><a href="appendix_b.html#cb80-186" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb80-187"><a href="appendix_b.html#cb80-187" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb80-188"><a href="appendix_b.html#cb80-188" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb80-189"><a href="appendix_b.html#cb80-189" tabindex="-1"></a>    }</span>
<span id="cb80-190"><a href="appendix_b.html#cb80-190" tabindex="-1"></a>  </span>
<span id="cb80-191"><a href="appendix_b.html#cb80-191" tabindex="-1"></a>  mrNDE.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi10&quot;</span>]) <span class="sc">-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi00&quot;</span>])</span>
<span id="cb80-192"><a href="appendix_b.html#cb80-192" tabindex="-1"></a>  mrNIE.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi11&quot;</span>]) <span class="sc">-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi10&quot;</span>])</span>
<span id="cb80-193"><a href="appendix_b.html#cb80-193" tabindex="-1"></a>  </span>
<span id="cb80-194"><a href="appendix_b.html#cb80-194" tabindex="-1"></a>  <span class="co"># quantitative outcome (QoL)</span></span>
<span id="cb80-195"><a href="appendix_b.html#cb80-195" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), </span>
<span id="cb80-196"><a href="appendix_b.html#cb80-196" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb80-197"><a href="appendix_b.html#cb80-197" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum.psi11&quot;</span>, <span class="st">&quot;sum.psi10&quot;</span>, </span>
<span id="cb80-198"><a href="appendix_b.html#cb80-198" tabindex="-1"></a>                      <span class="st">&quot;sum.psi00&quot;</span>)</span>
<span id="cb80-199"><a href="appendix_b.html#cb80-199" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb80-200"><a href="appendix_b.html#cb80-200" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi11&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span>                                          <span class="co"># A=1</span></span>
<span id="cb80-201"><a href="appendix_b.html#cb80-201" tabindex="-1"></a>                             b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb80-202"><a href="appendix_b.html#cb80-202" tabindex="-1"></a>                             b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb80-203"><a href="appendix_b.html#cb80-203" tabindex="-1"></a>                             b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb80-204"><a href="appendix_b.html#cb80-204" tabindex="-1"></a>                             b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb80-205"><a href="appendix_b.html#cb80-205" tabindex="-1"></a>                             b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb80-206"><a href="appendix_b.html#cb80-206" tabindex="-1"></a>                             b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb80-207"><a href="appendix_b.html#cb80-207" tabindex="-1"></a>      ((M1.A1.L0_00.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> <span class="co"># A&#39;=1</span></span>
<span id="cb80-208"><a href="appendix_b.html#cb80-208" tabindex="-1"></a>          M1.A1.L0_01.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-209"><a href="appendix_b.html#cb80-209" tabindex="-1"></a>          M1.A1.L0_10.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb80-210"><a href="appendix_b.html#cb80-210" tabindex="-1"></a>          M1.A1.L0_11.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-211"><a href="appendix_b.html#cb80-211" tabindex="-1"></a>          M1.A1.L0_00.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-212"><a href="appendix_b.html#cb80-212" tabindex="-1"></a>          M1.A1.L0_01.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-213"><a href="appendix_b.html#cb80-213" tabindex="-1"></a>          M1.A1.L0_10.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-214"><a href="appendix_b.html#cb80-214" tabindex="-1"></a>          M1.A1.L0_11.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span></span>
<span id="cb80-215"><a href="appendix_b.html#cb80-215" tabindex="-1"></a>          (S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb80-216"><a href="appendix_b.html#cb80-216" tabindex="-1"></a>      ((M0.A1.L0_00.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span>                </span>
<span id="cb80-217"><a href="appendix_b.html#cb80-217" tabindex="-1"></a>          M0.A1.L0_01.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-218"><a href="appendix_b.html#cb80-218" tabindex="-1"></a>          M0.A1.L0_10.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb80-219"><a href="appendix_b.html#cb80-219" tabindex="-1"></a>          M0.A1.L0_11.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-220"><a href="appendix_b.html#cb80-220" tabindex="-1"></a>          M0.A1.L0_00.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-221"><a href="appendix_b.html#cb80-221" tabindex="-1"></a>          M0.A1.L0_01.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-222"><a href="appendix_b.html#cb80-222" tabindex="-1"></a>          M0.A1.L0_10.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-223"><a href="appendix_b.html#cb80-223" tabindex="-1"></a>          M0.A1.L0_11.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span></span>
<span id="cb80-224"><a href="appendix_b.html#cb80-224" tabindex="-1"></a>          (S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb80-225"><a href="appendix_b.html#cb80-225" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(M.S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb80-226"><a href="appendix_b.html#cb80-226" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> M.S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb80-227"><a href="appendix_b.html#cb80-227" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb80-228"><a href="appendix_b.html#cb80-228" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb80-229"><a href="appendix_b.html#cb80-229" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb80-230"><a href="appendix_b.html#cb80-230" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb80-231"><a href="appendix_b.html#cb80-231" tabindex="-1"></a>    </span>
<span id="cb80-232"><a href="appendix_b.html#cb80-232" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi10&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span>                                          <span class="co"># A=1</span></span>
<span id="cb80-233"><a href="appendix_b.html#cb80-233" tabindex="-1"></a>                             b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb80-234"><a href="appendix_b.html#cb80-234" tabindex="-1"></a>                             b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb80-235"><a href="appendix_b.html#cb80-235" tabindex="-1"></a>                             b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb80-236"><a href="appendix_b.html#cb80-236" tabindex="-1"></a>                             b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb80-237"><a href="appendix_b.html#cb80-237" tabindex="-1"></a>                             b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb80-238"><a href="appendix_b.html#cb80-238" tabindex="-1"></a>                             b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb80-239"><a href="appendix_b.html#cb80-239" tabindex="-1"></a>      ((M1.A0.L0_00.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> <span class="co"># A&#39;=0</span></span>
<span id="cb80-240"><a href="appendix_b.html#cb80-240" tabindex="-1"></a>          M1.A0.L0_01.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-241"><a href="appendix_b.html#cb80-241" tabindex="-1"></a>          M1.A0.L0_10.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb80-242"><a href="appendix_b.html#cb80-242" tabindex="-1"></a>          M1.A0.L0_11.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-243"><a href="appendix_b.html#cb80-243" tabindex="-1"></a>          M1.A0.L0_00.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-244"><a href="appendix_b.html#cb80-244" tabindex="-1"></a>          M1.A0.L0_01.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-245"><a href="appendix_b.html#cb80-245" tabindex="-1"></a>          M1.A0.L0_10.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-246"><a href="appendix_b.html#cb80-246" tabindex="-1"></a>          M1.A0.L0_11.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span></span>
<span id="cb80-247"><a href="appendix_b.html#cb80-247" tabindex="-1"></a>          (S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb80-248"><a href="appendix_b.html#cb80-248" tabindex="-1"></a>      ((M0.A0.L0_00.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span>               </span>
<span id="cb80-249"><a href="appendix_b.html#cb80-249" tabindex="-1"></a>          M0.A0.L0_01.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-250"><a href="appendix_b.html#cb80-250" tabindex="-1"></a>          M0.A0.L0_10.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb80-251"><a href="appendix_b.html#cb80-251" tabindex="-1"></a>          M0.A0.L0_11.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-252"><a href="appendix_b.html#cb80-252" tabindex="-1"></a>          M0.A0.L0_00.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-253"><a href="appendix_b.html#cb80-253" tabindex="-1"></a>          M0.A0.L0_01.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-254"><a href="appendix_b.html#cb80-254" tabindex="-1"></a>          M0.A0.L0_10.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-255"><a href="appendix_b.html#cb80-255" tabindex="-1"></a>          M0.A0.L0_11.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span></span>
<span id="cb80-256"><a href="appendix_b.html#cb80-256" tabindex="-1"></a>          (S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb80-257"><a href="appendix_b.html#cb80-257" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(M.S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb80-258"><a href="appendix_b.html#cb80-258" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> M.S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb80-259"><a href="appendix_b.html#cb80-259" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb80-260"><a href="appendix_b.html#cb80-260" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb80-261"><a href="appendix_b.html#cb80-261" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb80-262"><a href="appendix_b.html#cb80-262" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb80-263"><a href="appendix_b.html#cb80-263" tabindex="-1"></a>    </span>
<span id="cb80-264"><a href="appendix_b.html#cb80-264" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi00&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span>                                          <span class="co"># A=0</span></span>
<span id="cb80-265"><a href="appendix_b.html#cb80-265" tabindex="-1"></a>                             b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb80-266"><a href="appendix_b.html#cb80-266" tabindex="-1"></a>                             b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb80-267"><a href="appendix_b.html#cb80-267" tabindex="-1"></a>                             b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb80-268"><a href="appendix_b.html#cb80-268" tabindex="-1"></a>                             b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb80-269"><a href="appendix_b.html#cb80-269" tabindex="-1"></a>                             b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb80-270"><a href="appendix_b.html#cb80-270" tabindex="-1"></a>                             b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb80-271"><a href="appendix_b.html#cb80-271" tabindex="-1"></a>      ((M1.A0.L0_00.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> <span class="co"># A&#39;=0</span></span>
<span id="cb80-272"><a href="appendix_b.html#cb80-272" tabindex="-1"></a>          M1.A0.L0_01.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-273"><a href="appendix_b.html#cb80-273" tabindex="-1"></a>          M1.A0.L0_10.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb80-274"><a href="appendix_b.html#cb80-274" tabindex="-1"></a>          M1.A0.L0_11.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-275"><a href="appendix_b.html#cb80-275" tabindex="-1"></a>          M1.A0.L0_00.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-276"><a href="appendix_b.html#cb80-276" tabindex="-1"></a>          M1.A0.L0_01.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-277"><a href="appendix_b.html#cb80-277" tabindex="-1"></a>          M1.A0.L0_10.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-278"><a href="appendix_b.html#cb80-278" tabindex="-1"></a>          M1.A0.L0_11.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span></span>
<span id="cb80-279"><a href="appendix_b.html#cb80-279" tabindex="-1"></a>          (S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb80-280"><a href="appendix_b.html#cb80-280" tabindex="-1"></a>      ((M0.A0.L0_00.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span>               </span>
<span id="cb80-281"><a href="appendix_b.html#cb80-281" tabindex="-1"></a>          M0.A0.L0_01.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-282"><a href="appendix_b.html#cb80-282" tabindex="-1"></a>          M0.A0.L0_10.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb80-283"><a href="appendix_b.html#cb80-283" tabindex="-1"></a>          M0.A0.L0_11.L1_0<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb80-284"><a href="appendix_b.html#cb80-284" tabindex="-1"></a>          M0.A0.L0_00.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-285"><a href="appendix_b.html#cb80-285" tabindex="-1"></a>          M0.A0.L0_01.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-286"><a href="appendix_b.html#cb80-286" tabindex="-1"></a>          M0.A0.L0_10.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb80-287"><a href="appendix_b.html#cb80-287" tabindex="-1"></a>          M0.A0.L0_11.L1_1<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span></span>
<span id="cb80-288"><a href="appendix_b.html#cb80-288" tabindex="-1"></a>          (S[n,<span class="st">&quot;L1&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb80-289"><a href="appendix_b.html#cb80-289" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(M.S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb80-290"><a href="appendix_b.html#cb80-290" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> M.S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb80-291"><a href="appendix_b.html#cb80-291" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb80-292"><a href="appendix_b.html#cb80-292" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb80-293"><a href="appendix_b.html#cb80-293" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb80-294"><a href="appendix_b.html#cb80-294" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb80-295"><a href="appendix_b.html#cb80-295" tabindex="-1"></a>    }</span>
<span id="cb80-296"><a href="appendix_b.html#cb80-296" tabindex="-1"></a>  </span>
<span id="cb80-297"><a href="appendix_b.html#cb80-297" tabindex="-1"></a>  mrNDE.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi10&quot;</span>]) <span class="sc">-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi00&quot;</span>])</span>
<span id="cb80-298"><a href="appendix_b.html#cb80-298" tabindex="-1"></a>  mrNIE.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi11&quot;</span>]) <span class="sc">-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi10&quot;</span>])</span>
<span id="cb80-299"><a href="appendix_b.html#cb80-299" tabindex="-1"></a>  </span>
<span id="cb80-300"><a href="appendix_b.html#cb80-300" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mrNDE.death =</span> mrNDE.death, <span class="at">mrNIE.death =</span> mrNIE.death, </span>
<span id="cb80-301"><a href="appendix_b.html#cb80-301" tabindex="-1"></a>              <span class="at">mrNDE.qol =</span> mrNDE.qol, <span class="at">mrNIE.qol =</span> mrNIE.qol))</span>
<span id="cb80-302"><a href="appendix_b.html#cb80-302" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="appendix_b.html#cb81-1" tabindex="-1"></a>true.marg.random.no.inter <span class="ot">&lt;-</span> <span class="fu">true.marg.random</span>(<span class="at">interaction =</span> <span class="dv">0</span>)</span>
<span id="cb81-2"><a href="appendix_b.html#cb81-2" tabindex="-1"></a></span>
<span id="cb81-3"><a href="appendix_b.html#cb81-3" tabindex="-1"></a>true.marg.random.with.inter <span class="ot">&lt;-</span> <span class="fu">true.marg.random</span>(<span class="at">interaction =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>The marginal randomized direct effect <span class="math inline">\(\text{MRDE}=\mathbb{E}\left(Y_{1,G_{0|L(0)}}\right) - \mathbb{E}\left(Y_{0,G_{0|L(0)}}\right)\)</span> and the marginal randomized indirect effect <span class="math inline">\(\text{MRIE}=\mathbb{E}\left(Y_{1,G_{1|L(0)}}\right) - \mathbb{E}\left(Y_{1,G_{0|L(0)}}\right)\)</span> are respectively:</p>
<ul>
<li>0.05 and 0.008 for death without interaction,</li>
<li>0.05855 and 0.011 for death with interaction,</li>
<li>-4 and -0.9 for quality of life without interaction,</li>
<li>-5.425 and -1.4 for quality of life with interaction.</li>
</ul>
</div>
<div id="conditional-randomized-direct-and-indirect-effects" class="section level3 hasAnchor" number="11.1.8">
<h3><span class="header-section-number">11.1.8</span> Conditional randomized direct and indirect effects<a href="appendix_b.html#conditional-randomized-direct-and-indirect-effects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following function <code>true.cond.random</code> can be used to run the calculation for the conditional randomized natural direct (CRDE) and indirect effects (CRIE).</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="appendix_b.html#cb82-1" tabindex="-1"></a>true.cond.random <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">interaction =</span> <span class="cn">NULL</span>) {</span>
<span id="cb82-2"><a href="appendix_b.html#cb82-2" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">param.causal.model.1</span>(<span class="at">A.M.interaction =</span> interaction)</span>
<span id="cb82-3"><a href="appendix_b.html#cb82-3" tabindex="-1"></a>  </span>
<span id="cb82-4"><a href="appendix_b.html#cb82-4" tabindex="-1"></a>  <span class="co"># binary outcome (death)</span></span>
<span id="cb82-5"><a href="appendix_b.html#cb82-5" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), </span>
<span id="cb82-6"><a href="appendix_b.html#cb82-6" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb82-7"><a href="appendix_b.html#cb82-7" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum.psi11&quot;</span>, <span class="st">&quot;sum.psi10&quot;</span>, </span>
<span id="cb82-8"><a href="appendix_b.html#cb82-8" tabindex="-1"></a>                      <span class="st">&quot;sum.psi00&quot;</span>)</span>
<span id="cb82-9"><a href="appendix_b.html#cb82-9" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb82-10"><a href="appendix_b.html#cb82-10" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi11&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span>                                           <span class="co"># A=1</span></span>
<span id="cb82-11"><a href="appendix_b.html#cb82-11" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-12"><a href="appendix_b.html#cb82-12" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-13"><a href="appendix_b.html#cb82-13" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb82-14"><a href="appendix_b.html#cb82-14" tabindex="-1"></a>                             b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-15"><a href="appendix_b.html#cb82-15" tabindex="-1"></a>                             b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-16"><a href="appendix_b.html#cb82-16" tabindex="-1"></a>                             b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb82-17"><a href="appendix_b.html#cb82-17" tabindex="-1"></a>      (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span>                                                             <span class="co"># A&#39;=1</span></span>
<span id="cb82-18"><a href="appendix_b.html#cb82-18" tabindex="-1"></a>           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-19"><a href="appendix_b.html#cb82-19" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-20"><a href="appendix_b.html#cb82-20" tabindex="-1"></a>           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-21"><a href="appendix_b.html#cb82-21" tabindex="-1"></a>           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb82-22"><a href="appendix_b.html#cb82-22" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-23"><a href="appendix_b.html#cb82-23" tabindex="-1"></a>                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-24"><a href="appendix_b.html#cb82-24" tabindex="-1"></a>                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-25"><a href="appendix_b.html#cb82-25" tabindex="-1"></a>                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-26"><a href="appendix_b.html#cb82-26" tabindex="-1"></a>                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> ) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb82-27"><a href="appendix_b.html#cb82-27" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb82-28"><a href="appendix_b.html#cb82-28" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb82-29"><a href="appendix_b.html#cb82-29" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb82-30"><a href="appendix_b.html#cb82-30" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb82-31"><a href="appendix_b.html#cb82-31" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb82-32"><a href="appendix_b.html#cb82-32" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb82-33"><a href="appendix_b.html#cb82-33" tabindex="-1"></a>    </span>
<span id="cb82-34"><a href="appendix_b.html#cb82-34" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi10&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span>                                           <span class="co"># A=1</span></span>
<span id="cb82-35"><a href="appendix_b.html#cb82-35" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-36"><a href="appendix_b.html#cb82-36" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-37"><a href="appendix_b.html#cb82-37" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb82-38"><a href="appendix_b.html#cb82-38" tabindex="-1"></a>                             b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-39"><a href="appendix_b.html#cb82-39" tabindex="-1"></a>                             b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-40"><a href="appendix_b.html#cb82-40" tabindex="-1"></a>                             b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb82-41"><a href="appendix_b.html#cb82-41" tabindex="-1"></a>      (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span>                                                             <span class="co"># A&#39;=0</span></span>
<span id="cb82-42"><a href="appendix_b.html#cb82-42" tabindex="-1"></a>           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-43"><a href="appendix_b.html#cb82-43" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-44"><a href="appendix_b.html#cb82-44" tabindex="-1"></a>           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-45"><a href="appendix_b.html#cb82-45" tabindex="-1"></a>           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb82-46"><a href="appendix_b.html#cb82-46" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-47"><a href="appendix_b.html#cb82-47" tabindex="-1"></a>                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-48"><a href="appendix_b.html#cb82-48" tabindex="-1"></a>                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-49"><a href="appendix_b.html#cb82-49" tabindex="-1"></a>                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-50"><a href="appendix_b.html#cb82-50" tabindex="-1"></a>                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> ) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb82-51"><a href="appendix_b.html#cb82-51" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb82-52"><a href="appendix_b.html#cb82-52" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb82-53"><a href="appendix_b.html#cb82-53" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb82-54"><a href="appendix_b.html#cb82-54" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb82-55"><a href="appendix_b.html#cb82-55" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb82-56"><a href="appendix_b.html#cb82-56" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb82-57"><a href="appendix_b.html#cb82-57" tabindex="-1"></a>    </span>
<span id="cb82-58"><a href="appendix_b.html#cb82-58" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi00&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span>                                           <span class="co"># A=0</span></span>
<span id="cb82-59"><a href="appendix_b.html#cb82-59" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-60"><a href="appendix_b.html#cb82-60" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-61"><a href="appendix_b.html#cb82-61" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb82-62"><a href="appendix_b.html#cb82-62" tabindex="-1"></a>                             b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-63"><a href="appendix_b.html#cb82-63" tabindex="-1"></a>                             b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-64"><a href="appendix_b.html#cb82-64" tabindex="-1"></a>                             b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb82-65"><a href="appendix_b.html#cb82-65" tabindex="-1"></a>      (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span>                                                             <span class="co"># A&#39;=0</span></span>
<span id="cb82-66"><a href="appendix_b.html#cb82-66" tabindex="-1"></a>           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-67"><a href="appendix_b.html#cb82-67" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-68"><a href="appendix_b.html#cb82-68" tabindex="-1"></a>           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-69"><a href="appendix_b.html#cb82-69" tabindex="-1"></a>           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb82-70"><a href="appendix_b.html#cb82-70" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-71"><a href="appendix_b.html#cb82-71" tabindex="-1"></a>                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-72"><a href="appendix_b.html#cb82-72" tabindex="-1"></a>                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-73"><a href="appendix_b.html#cb82-73" tabindex="-1"></a>                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-74"><a href="appendix_b.html#cb82-74" tabindex="-1"></a>                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> ) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb82-75"><a href="appendix_b.html#cb82-75" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb82-76"><a href="appendix_b.html#cb82-76" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb82-77"><a href="appendix_b.html#cb82-77" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb82-78"><a href="appendix_b.html#cb82-78" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb82-79"><a href="appendix_b.html#cb82-79" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb82-80"><a href="appendix_b.html#cb82-80" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>]))</span>
<span id="cb82-81"><a href="appendix_b.html#cb82-81" tabindex="-1"></a>    }</span>
<span id="cb82-82"><a href="appendix_b.html#cb82-82" tabindex="-1"></a>  </span>
<span id="cb82-83"><a href="appendix_b.html#cb82-83" tabindex="-1"></a>  crNDE.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi10&quot;</span>]) <span class="sc">-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi00&quot;</span>])</span>
<span id="cb82-84"><a href="appendix_b.html#cb82-84" tabindex="-1"></a>  crNIE.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi11&quot;</span>]) <span class="sc">-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi10&quot;</span>])</span>
<span id="cb82-85"><a href="appendix_b.html#cb82-85" tabindex="-1"></a>  </span>
<span id="cb82-86"><a href="appendix_b.html#cb82-86" tabindex="-1"></a>  <span class="co"># quantitative outcome (QoL)</span></span>
<span id="cb82-87"><a href="appendix_b.html#cb82-87" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), </span>
<span id="cb82-88"><a href="appendix_b.html#cb82-88" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb82-89"><a href="appendix_b.html#cb82-89" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum.psi11&quot;</span>, <span class="st">&quot;sum.psi10&quot;</span>, </span>
<span id="cb82-90"><a href="appendix_b.html#cb82-90" tabindex="-1"></a>                      <span class="st">&quot;sum.psi00&quot;</span>)</span>
<span id="cb82-91"><a href="appendix_b.html#cb82-91" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb82-92"><a href="appendix_b.html#cb82-92" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi11&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span>                                          <span class="co"># A=1</span></span>
<span id="cb82-93"><a href="appendix_b.html#cb82-93" tabindex="-1"></a>                             b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-94"><a href="appendix_b.html#cb82-94" tabindex="-1"></a>                             b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-95"><a href="appendix_b.html#cb82-95" tabindex="-1"></a>                             b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb82-96"><a href="appendix_b.html#cb82-96" tabindex="-1"></a>                             b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-97"><a href="appendix_b.html#cb82-97" tabindex="-1"></a>                             b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-98"><a href="appendix_b.html#cb82-98" tabindex="-1"></a>                             b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb82-99"><a href="appendix_b.html#cb82-99" tabindex="-1"></a>      (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span>                                                             <span class="co"># A&#39;=1</span></span>
<span id="cb82-100"><a href="appendix_b.html#cb82-100" tabindex="-1"></a>           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-101"><a href="appendix_b.html#cb82-101" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-102"><a href="appendix_b.html#cb82-102" tabindex="-1"></a>           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-103"><a href="appendix_b.html#cb82-103" tabindex="-1"></a>           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb82-104"><a href="appendix_b.html#cb82-104" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-105"><a href="appendix_b.html#cb82-105" tabindex="-1"></a>                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-106"><a href="appendix_b.html#cb82-106" tabindex="-1"></a>                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-107"><a href="appendix_b.html#cb82-107" tabindex="-1"></a>                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-108"><a href="appendix_b.html#cb82-108" tabindex="-1"></a>                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> ) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb82-109"><a href="appendix_b.html#cb82-109" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb82-110"><a href="appendix_b.html#cb82-110" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb82-111"><a href="appendix_b.html#cb82-111" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb82-112"><a href="appendix_b.html#cb82-112" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb82-113"><a href="appendix_b.html#cb82-113" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb82-114"><a href="appendix_b.html#cb82-114" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb82-115"><a href="appendix_b.html#cb82-115" tabindex="-1"></a>    </span>
<span id="cb82-116"><a href="appendix_b.html#cb82-116" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi10&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span>                                          <span class="co"># A=1</span></span>
<span id="cb82-117"><a href="appendix_b.html#cb82-117" tabindex="-1"></a>                             b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-118"><a href="appendix_b.html#cb82-118" tabindex="-1"></a>                             b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-119"><a href="appendix_b.html#cb82-119" tabindex="-1"></a>                             b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb82-120"><a href="appendix_b.html#cb82-120" tabindex="-1"></a>                             b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-121"><a href="appendix_b.html#cb82-121" tabindex="-1"></a>                             b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-122"><a href="appendix_b.html#cb82-122" tabindex="-1"></a>                             b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb82-123"><a href="appendix_b.html#cb82-123" tabindex="-1"></a>      (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span>                                                             <span class="co"># A&#39;=0</span></span>
<span id="cb82-124"><a href="appendix_b.html#cb82-124" tabindex="-1"></a>           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-125"><a href="appendix_b.html#cb82-125" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-126"><a href="appendix_b.html#cb82-126" tabindex="-1"></a>           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-127"><a href="appendix_b.html#cb82-127" tabindex="-1"></a>           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb82-128"><a href="appendix_b.html#cb82-128" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-129"><a href="appendix_b.html#cb82-129" tabindex="-1"></a>                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-130"><a href="appendix_b.html#cb82-130" tabindex="-1"></a>                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-131"><a href="appendix_b.html#cb82-131" tabindex="-1"></a>                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-132"><a href="appendix_b.html#cb82-132" tabindex="-1"></a>                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> ) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb82-133"><a href="appendix_b.html#cb82-133" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb82-134"><a href="appendix_b.html#cb82-134" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb82-135"><a href="appendix_b.html#cb82-135" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb82-136"><a href="appendix_b.html#cb82-136" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb82-137"><a href="appendix_b.html#cb82-137" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb82-138"><a href="appendix_b.html#cb82-138" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb82-139"><a href="appendix_b.html#cb82-139" tabindex="-1"></a>    </span>
<span id="cb82-140"><a href="appendix_b.html#cb82-140" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi00&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span>                                          <span class="co"># A=0</span></span>
<span id="cb82-141"><a href="appendix_b.html#cb82-141" tabindex="-1"></a>                             b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-142"><a href="appendix_b.html#cb82-142" tabindex="-1"></a>                             b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-143"><a href="appendix_b.html#cb82-143" tabindex="-1"></a>                             b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb82-144"><a href="appendix_b.html#cb82-144" tabindex="-1"></a>                             b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-145"><a href="appendix_b.html#cb82-145" tabindex="-1"></a>                             b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-146"><a href="appendix_b.html#cb82-146" tabindex="-1"></a>                             b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb82-147"><a href="appendix_b.html#cb82-147" tabindex="-1"></a>      (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span>                                                             <span class="co"># A&#39;=0</span></span>
<span id="cb82-148"><a href="appendix_b.html#cb82-148" tabindex="-1"></a>           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-149"><a href="appendix_b.html#cb82-149" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-150"><a href="appendix_b.html#cb82-150" tabindex="-1"></a>           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-151"><a href="appendix_b.html#cb82-151" tabindex="-1"></a>           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb82-152"><a href="appendix_b.html#cb82-152" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-153"><a href="appendix_b.html#cb82-153" tabindex="-1"></a>                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-154"><a href="appendix_b.html#cb82-154" tabindex="-1"></a>                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb82-155"><a href="appendix_b.html#cb82-155" tabindex="-1"></a>                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb82-156"><a href="appendix_b.html#cb82-156" tabindex="-1"></a>                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> ) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb82-157"><a href="appendix_b.html#cb82-157" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb82-158"><a href="appendix_b.html#cb82-158" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L1&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>])) <span class="sc">*</span></span>
<span id="cb82-159"><a href="appendix_b.html#cb82-159" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb82-160"><a href="appendix_b.html#cb82-160" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb82-161"><a href="appendix_b.html#cb82-161" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb82-162"><a href="appendix_b.html#cb82-162" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb82-163"><a href="appendix_b.html#cb82-163" tabindex="-1"></a>    }</span>
<span id="cb82-164"><a href="appendix_b.html#cb82-164" tabindex="-1"></a>  </span>
<span id="cb82-165"><a href="appendix_b.html#cb82-165" tabindex="-1"></a>  crNDE.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi10&quot;</span>]) <span class="sc">-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi00&quot;</span>])</span>
<span id="cb82-166"><a href="appendix_b.html#cb82-166" tabindex="-1"></a>  crNIE.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi11&quot;</span>]) <span class="sc">-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi10&quot;</span>])</span>
<span id="cb82-167"><a href="appendix_b.html#cb82-167" tabindex="-1"></a>  </span>
<span id="cb82-168"><a href="appendix_b.html#cb82-168" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">crNDE.death =</span> crNDE.death, <span class="at">crNIE.death =</span> crNIE.death, </span>
<span id="cb82-169"><a href="appendix_b.html#cb82-169" tabindex="-1"></a>              <span class="at">crNDE.qol =</span> crNDE.qol, <span class="at">crNIE.qol =</span> crNIE.qol))</span>
<span id="cb82-170"><a href="appendix_b.html#cb82-170" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="appendix_b.html#cb83-1" tabindex="-1"></a>true.cond.random.no.inter <span class="ot">&lt;-</span> <span class="fu">true.cond.random</span>(<span class="at">interaction =</span> <span class="dv">0</span>)</span>
<span id="cb83-2"><a href="appendix_b.html#cb83-2" tabindex="-1"></a></span>
<span id="cb83-3"><a href="appendix_b.html#cb83-3" tabindex="-1"></a>true.cond.random.with.inter <span class="ot">&lt;-</span> <span class="fu">true.cond.random</span>(<span class="at">interaction =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>The conditional randomized direct effect <span class="math inline">\(\text{CRDE}=\mathbb{E}\left(Y_{1,\Gamma_{0\mid L(0),L(1)}}\right) - \mathbb{E}\left(Y_{0,\Gamma_{0\mid L(0),L(1)}}\right)\)</span> and conditional randomized indirect effect <span class="math inline">\(\text{CRIE}=\mathbb{E}\left(Y_{1,\Gamma_{1\mid L(0),L(1)}}\right) - \mathbb{E}\left(Y_{1,\Gamma_{0\mid L(0),L(1)}}\right)\)</span> are respectively:</p>
<ul>
<li>0.05 and 0.008 for death without interaction,</li>
<li>0.05855 and 0.011 for death with interaction,</li>
<li>-4 and -0.9 for quality of life without interaction,</li>
<li>-5.425 and -1.4 for quality of life with interaction.</li>
</ul>
<table>
<caption>True values without time varying confounders</caption>
<colgroup>
<col width="22%" />
<col width="40%" />
<col width="36%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Effects</th>
<th align="center">Without <span class="math inline">\(A*M\)</span> interaction</th>
<th align="center">with <span class="math inline">\(A*M\)</span> interaction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Binary outcome</strong></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">Average total effect (ATE)</td>
<td align="center">0.058</td>
<td align="center">0.06955</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">Controlled direct effect (CDE)</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">- CDE, setting do(M=0)</td>
<td align="center">0.05</td>
<td align="center">0.05</td>
</tr>
<tr class="even">
<td align="left">- CDE, setting do(M=1)</td>
<td align="center">0.05</td>
<td align="center">0.08</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">Pure NDE and Total NIE</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">- PNDE</td>
<td align="center">0.05</td>
<td align="center">0.05855</td>
</tr>
<tr class="even">
<td align="left">- TNIE</td>
<td align="center">0.008</td>
<td align="center">0.011</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">Total NDE and Pure NIE</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">- TNDE</td>
<td align="center">0.05</td>
<td align="center">0.06155</td>
</tr>
<tr class="even">
<td align="left">- PNIE</td>
<td align="center">0.008</td>
<td align="center">0.008</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">3-way decomposition</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">- PDE</td>
<td align="center">0.05</td>
<td align="center">0.05855</td>
</tr>
<tr class="even">
<td align="left">- PIE</td>
<td align="center">0.008</td>
<td align="center">0.008</td>
</tr>
<tr class="odd">
<td align="left">- MI</td>
<td align="center">0.000</td>
<td align="center">0.003</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">4-way decomposition</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">- CDE</td>
<td align="center">0.05</td>
<td align="center">0.05</td>
</tr>
<tr class="odd">
<td align="left">- INTref</td>
<td align="center">0.000</td>
<td align="center">0.00855</td>
</tr>
<tr class="even">
<td align="left">- INTmed</td>
<td align="center">0.000</td>
<td align="center">0.003</td>
</tr>
<tr class="odd">
<td align="left">- PIE</td>
<td align="center">0.008</td>
<td align="center">0.008</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">Marginal randomized</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">- marginal rNDE</td>
<td align="center">0.05</td>
<td align="center">0.05855</td>
</tr>
<tr class="odd">
<td align="left">- marginal rNIE</td>
<td align="center">0.008</td>
<td align="center">0.011</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">Conditional randomized</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">- conditional rNDE</td>
<td align="center">0.05</td>
<td align="center">0.05855</td>
</tr>
<tr class="odd">
<td align="left">- conditional rNIE</td>
<td align="center">0.008</td>
<td align="center">0.011</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left"><strong>Quantitative outcome</strong></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">Average total effect (ATE)</td>
<td align="center">-4.9</td>
<td align="center">-6.825</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">Controlled direct effect (CDE)</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">- CDE, setting do(M=0)</td>
<td align="center">-4</td>
<td align="center">-4</td>
</tr>
<tr class="even">
<td align="left">- CDE, setting do(M=1)</td>
<td align="center">-4</td>
<td align="center">-9</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">Pure NDE and Total NIE</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">- PNDE</td>
<td align="center">-4</td>
<td align="center">-5.425</td>
</tr>
<tr class="even">
<td align="left">- TNIE</td>
<td align="center">-0.9</td>
<td align="center">-1.4</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">Total NDE and Pure NIE</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">- TNDE</td>
<td align="center">-4</td>
<td align="center">-5.925</td>
</tr>
<tr class="even">
<td align="left">- PNIE</td>
<td align="center">-0.9</td>
<td align="center">-0.9</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">3-way decomposition</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">- PDE</td>
<td align="center">-4</td>
<td align="center">-5.425</td>
</tr>
<tr class="even">
<td align="left">- PIE</td>
<td align="center">-0.9</td>
<td align="center">-0.9</td>
</tr>
<tr class="odd">
<td align="left">- MI</td>
<td align="center">0</td>
<td align="center">-0.5</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">4-way decomposition</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">- CDE</td>
<td align="center">-4</td>
<td align="center">-4</td>
</tr>
<tr class="odd">
<td align="left">- INTref</td>
<td align="center">0.000</td>
<td align="center">-1.425</td>
</tr>
<tr class="even">
<td align="left">- INTmed</td>
<td align="center">0.000</td>
<td align="center">-0.5</td>
</tr>
<tr class="odd">
<td align="left">- PIE</td>
<td align="center">-0.9</td>
<td align="center">-0.9</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">Marginal randomized</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">- marginal rNDE</td>
<td align="center">-4</td>
<td align="center">-5.425</td>
</tr>
<tr class="odd">
<td align="left">- marginal rNIE</td>
<td align="center">-0.9</td>
<td align="center">-1.4</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">Conditional randomized</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">- conditional rNDE</td>
<td align="center">-4</td>
<td align="center">-5.425</td>
</tr>
<tr class="odd">
<td align="left">- conditional rNIE</td>
<td align="center">-0.9</td>
<td align="center">-1.4</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="true-causal-quantities-with-mediator-outcome-confounder-affected-by-the-exposure" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> True causal quantities with mediator-outcome confounder affected by the exposure<a href="appendix_b.html#true-causal-quantities-with-mediator-outcome-confounder-affected-by-the-exposure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="average-total-effects-ate-1" class="section level3 hasAnchor" number="11.2.1">
<h3><span class="header-section-number">11.2.1</span> Average total effects (ATE)<a href="appendix_b.html#average-total-effects-ate-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following function <code>true.ATE.tv.conf</code> can be used to run the calculation for the average total effects (ATE).</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="appendix_b.html#cb84-1" tabindex="-1"></a>true.ATE.time.var.conf <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">interaction =</span> <span class="cn">NULL</span>) {</span>
<span id="cb84-2"><a href="appendix_b.html#cb84-2" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">param.causal.model.2</span>(<span class="at">A.M.interaction =</span> interaction)</span>
<span id="cb84-3"><a href="appendix_b.html#cb84-3" tabindex="-1"></a>  </span>
<span id="cb84-4"><a href="appendix_b.html#cb84-4" tabindex="-1"></a>  <span class="co"># binary outcome (death)</span></span>
<span id="cb84-5"><a href="appendix_b.html#cb84-5" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb84-6"><a href="appendix_b.html#cb84-6" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum&quot;</span>)</span>
<span id="cb84-7"><a href="appendix_b.html#cb84-7" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb84-8"><a href="appendix_b.html#cb84-8" tabindex="-1"></a>    S[n,<span class="st">&quot;sum&quot;</span>] <span class="ot">&lt;-</span> ( ( ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-9"><a href="appendix_b.html#cb84-9" tabindex="-1"></a>                      b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-10"><a href="appendix_b.html#cb84-10" tabindex="-1"></a>                      b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-11"><a href="appendix_b.html#cb84-11" tabindex="-1"></a>                      b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb84-12"><a href="appendix_b.html#cb84-12" tabindex="-1"></a>                      b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-13"><a href="appendix_b.html#cb84-13" tabindex="-1"></a>                      b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-14"><a href="appendix_b.html#cb84-14" tabindex="-1"></a>                      b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb84-15"><a href="appendix_b.html#cb84-15" tabindex="-1"></a>                    (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-16"><a href="appendix_b.html#cb84-16" tabindex="-1"></a>                           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-17"><a href="appendix_b.html#cb84-17" tabindex="-1"></a>                           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-18"><a href="appendix_b.html#cb84-18" tabindex="-1"></a>                           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-19"><a href="appendix_b.html#cb84-19" tabindex="-1"></a>                           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb84-20"><a href="appendix_b.html#cb84-20" tabindex="-1"></a>                    (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-21"><a href="appendix_b.html#cb84-21" tabindex="-1"></a>                              b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-22"><a href="appendix_b.html#cb84-22" tabindex="-1"></a>                              b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-23"><a href="appendix_b.html#cb84-23" tabindex="-1"></a>                              b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-24"><a href="appendix_b.html#cb84-24" tabindex="-1"></a>                              b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb84-25"><a href="appendix_b.html#cb84-25" tabindex="-1"></a>                        (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-26"><a href="appendix_b.html#cb84-26" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb84-27"><a href="appendix_b.html#cb84-27" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-28"><a href="appendix_b.html#cb84-28" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb84-29"><a href="appendix_b.html#cb84-29" tabindex="-1"></a>                        (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-30"><a href="appendix_b.html#cb84-30" tabindex="-1"></a>                                   b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb84-31"><a href="appendix_b.html#cb84-31" tabindex="-1"></a>                                   b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-32"><a href="appendix_b.html#cb84-32" tabindex="-1"></a>                                   b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] )) ) <span class="sc">-</span> </span>
<span id="cb84-33"><a href="appendix_b.html#cb84-33" tabindex="-1"></a>                    ( ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-34"><a href="appendix_b.html#cb84-34" tabindex="-1"></a>                          b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-35"><a href="appendix_b.html#cb84-35" tabindex="-1"></a>                          b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-36"><a href="appendix_b.html#cb84-36" tabindex="-1"></a>                          b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb84-37"><a href="appendix_b.html#cb84-37" tabindex="-1"></a>                          b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-38"><a href="appendix_b.html#cb84-38" tabindex="-1"></a>                          b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-39"><a href="appendix_b.html#cb84-39" tabindex="-1"></a>                          b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb84-40"><a href="appendix_b.html#cb84-40" tabindex="-1"></a>                        (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-41"><a href="appendix_b.html#cb84-41" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-42"><a href="appendix_b.html#cb84-42" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-43"><a href="appendix_b.html#cb84-43" tabindex="-1"></a>                             b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-44"><a href="appendix_b.html#cb84-44" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb84-45"><a href="appendix_b.html#cb84-45" tabindex="-1"></a>                        (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-46"><a href="appendix_b.html#cb84-46" tabindex="-1"></a>                                  b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-47"><a href="appendix_b.html#cb84-47" tabindex="-1"></a>                                  b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-48"><a href="appendix_b.html#cb84-48" tabindex="-1"></a>                                  b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-49"><a href="appendix_b.html#cb84-49" tabindex="-1"></a>                                  b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb84-50"><a href="appendix_b.html#cb84-50" tabindex="-1"></a>                        (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-51"><a href="appendix_b.html#cb84-51" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb84-52"><a href="appendix_b.html#cb84-52" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-53"><a href="appendix_b.html#cb84-53" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb84-54"><a href="appendix_b.html#cb84-54" tabindex="-1"></a>                        (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-55"><a href="appendix_b.html#cb84-55" tabindex="-1"></a>                                   b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb84-56"><a href="appendix_b.html#cb84-56" tabindex="-1"></a>                                   b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-57"><a href="appendix_b.html#cb84-57" tabindex="-1"></a>                                   b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] )) ) ) <span class="sc">*</span></span>
<span id="cb84-58"><a href="appendix_b.html#cb84-58" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb84-59"><a href="appendix_b.html#cb84-59" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb84-60"><a href="appendix_b.html#cb84-60" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb84-61"><a href="appendix_b.html#cb84-61" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb84-62"><a href="appendix_b.html#cb84-62" tabindex="-1"></a>    }</span>
<span id="cb84-63"><a href="appendix_b.html#cb84-63" tabindex="-1"></a>  </span>
<span id="cb84-64"><a href="appendix_b.html#cb84-64" tabindex="-1"></a>  ATE.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb84-65"><a href="appendix_b.html#cb84-65" tabindex="-1"></a>  </span>
<span id="cb84-66"><a href="appendix_b.html#cb84-66" tabindex="-1"></a>  <span class="co"># quantitative outcome (QoL)</span></span>
<span id="cb84-67"><a href="appendix_b.html#cb84-67" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb84-68"><a href="appendix_b.html#cb84-68" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum&quot;</span>)</span>
<span id="cb84-69"><a href="appendix_b.html#cb84-69" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb84-70"><a href="appendix_b.html#cb84-70" tabindex="-1"></a>    S[n,<span class="st">&quot;sum&quot;</span>] <span class="ot">&lt;-</span> ( ( ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-71"><a href="appendix_b.html#cb84-71" tabindex="-1"></a>                          b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-72"><a href="appendix_b.html#cb84-72" tabindex="-1"></a>                          b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-73"><a href="appendix_b.html#cb84-73" tabindex="-1"></a>                          b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb84-74"><a href="appendix_b.html#cb84-74" tabindex="-1"></a>                          b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-75"><a href="appendix_b.html#cb84-75" tabindex="-1"></a>                          b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-76"><a href="appendix_b.html#cb84-76" tabindex="-1"></a>                          b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb84-77"><a href="appendix_b.html#cb84-77" tabindex="-1"></a>                        (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-78"><a href="appendix_b.html#cb84-78" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-79"><a href="appendix_b.html#cb84-79" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-80"><a href="appendix_b.html#cb84-80" tabindex="-1"></a>                             b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-81"><a href="appendix_b.html#cb84-81" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb84-82"><a href="appendix_b.html#cb84-82" tabindex="-1"></a>                        (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-83"><a href="appendix_b.html#cb84-83" tabindex="-1"></a>                                  b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-84"><a href="appendix_b.html#cb84-84" tabindex="-1"></a>                                  b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-85"><a href="appendix_b.html#cb84-85" tabindex="-1"></a>                                  b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-86"><a href="appendix_b.html#cb84-86" tabindex="-1"></a>                                  b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb84-87"><a href="appendix_b.html#cb84-87" tabindex="-1"></a>                        (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-88"><a href="appendix_b.html#cb84-88" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb84-89"><a href="appendix_b.html#cb84-89" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-90"><a href="appendix_b.html#cb84-90" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb84-91"><a href="appendix_b.html#cb84-91" tabindex="-1"></a>                        (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-92"><a href="appendix_b.html#cb84-92" tabindex="-1"></a>                                   b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb84-93"><a href="appendix_b.html#cb84-93" tabindex="-1"></a>                                   b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-94"><a href="appendix_b.html#cb84-94" tabindex="-1"></a>                                   b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] )) ) <span class="sc">-</span> </span>
<span id="cb84-95"><a href="appendix_b.html#cb84-95" tabindex="-1"></a>                      ( ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-96"><a href="appendix_b.html#cb84-96" tabindex="-1"></a>                            b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-97"><a href="appendix_b.html#cb84-97" tabindex="-1"></a>                            b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-98"><a href="appendix_b.html#cb84-98" tabindex="-1"></a>                            b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span></span>
<span id="cb84-99"><a href="appendix_b.html#cb84-99" tabindex="-1"></a>                            b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-100"><a href="appendix_b.html#cb84-100" tabindex="-1"></a>                            b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-101"><a href="appendix_b.html#cb84-101" tabindex="-1"></a>                            b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb84-102"><a href="appendix_b.html#cb84-102" tabindex="-1"></a>                          (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-103"><a href="appendix_b.html#cb84-103" tabindex="-1"></a>                               b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-104"><a href="appendix_b.html#cb84-104" tabindex="-1"></a>                               b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-105"><a href="appendix_b.html#cb84-105" tabindex="-1"></a>                               b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-106"><a href="appendix_b.html#cb84-106" tabindex="-1"></a>                               b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb84-107"><a href="appendix_b.html#cb84-107" tabindex="-1"></a>                          (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-108"><a href="appendix_b.html#cb84-108" tabindex="-1"></a>                                    b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-109"><a href="appendix_b.html#cb84-109" tabindex="-1"></a>                                    b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb84-110"><a href="appendix_b.html#cb84-110" tabindex="-1"></a>                                    b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-111"><a href="appendix_b.html#cb84-111" tabindex="-1"></a>                                    b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) ) <span class="sc">*</span></span>
<span id="cb84-112"><a href="appendix_b.html#cb84-112" tabindex="-1"></a>                        (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-113"><a href="appendix_b.html#cb84-113" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb84-114"><a href="appendix_b.html#cb84-114" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-115"><a href="appendix_b.html#cb84-115" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb84-116"><a href="appendix_b.html#cb84-116" tabindex="-1"></a>                        (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-117"><a href="appendix_b.html#cb84-117" tabindex="-1"></a>                                   b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb84-118"><a href="appendix_b.html#cb84-118" tabindex="-1"></a>                                   b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb84-119"><a href="appendix_b.html#cb84-119" tabindex="-1"></a>                                   b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] )) ) <span class="sc">*</span></span>
<span id="cb84-120"><a href="appendix_b.html#cb84-120" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb84-121"><a href="appendix_b.html#cb84-121" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb84-122"><a href="appendix_b.html#cb84-122" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb84-123"><a href="appendix_b.html#cb84-123" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb84-124"><a href="appendix_b.html#cb84-124" tabindex="-1"></a>    }</span>
<span id="cb84-125"><a href="appendix_b.html#cb84-125" tabindex="-1"></a>  </span>
<span id="cb84-126"><a href="appendix_b.html#cb84-126" tabindex="-1"></a>  ATE.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb84-127"><a href="appendix_b.html#cb84-127" tabindex="-1"></a>  </span>
<span id="cb84-128"><a href="appendix_b.html#cb84-128" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">ATE.death =</span> ATE.death, <span class="at">ATE.qol =</span> ATE.qol))</span>
<span id="cb84-129"><a href="appendix_b.html#cb84-129" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="appendix_b.html#cb85-1" tabindex="-1"></a>true.ATE2.no.inter <span class="ot">&lt;-</span> <span class="fu">true.ATE.time.var.conf</span>(<span class="at">interaction =</span> <span class="dv">0</span>)</span>
<span id="cb85-2"><a href="appendix_b.html#cb85-2" tabindex="-1"></a></span>
<span id="cb85-3"><a href="appendix_b.html#cb85-3" tabindex="-1"></a>true.ATE2.with.inter <span class="ot">&lt;-</span> <span class="fu">true.ATE.time.var.conf</span>(<span class="at">interaction =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>The average total effects <span class="math inline">\(\text{ATE} = \mathbb{E}(Y_1) - \mathbb{E}(Y_0)\)</span> are:</p>
<ul>
<li>0.0752 for death and -6.26 for quality of life without interaction</li>
<li>0.089282 for death and -8.607 for quality of life with interaction</li>
</ul>
</div>
<div id="controlled-direct-effects-cde-1" class="section level3 hasAnchor" number="11.2.2">
<h3><span class="header-section-number">11.2.2</span> Controlled direct effects (CDE)<a href="appendix_b.html#controlled-direct-effects-cde-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following function <code>true.CDE.time.var</code> can be used to run the calculation for controlled direct effects (CDE).</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="appendix_b.html#cb86-1" tabindex="-1"></a>true.CDE.time.var <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">interaction =</span> <span class="cn">NULL</span>) {</span>
<span id="cb86-2"><a href="appendix_b.html#cb86-2" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">param.causal.model.2</span>(<span class="at">A.M.interaction =</span> interaction)</span>
<span id="cb86-3"><a href="appendix_b.html#cb86-3" tabindex="-1"></a>  </span>
<span id="cb86-4"><a href="appendix_b.html#cb86-4" tabindex="-1"></a>  <span class="co"># binary outcome (death)</span></span>
<span id="cb86-5"><a href="appendix_b.html#cb86-5" tabindex="-1"></a>  <span class="co"># we estimate both CDE, fixing do(M) = 0 et do(M) = 1 and using the </span></span>
<span id="cb86-6"><a href="appendix_b.html#cb86-6" tabindex="-1"></a>  <span class="co"># corresponding lines in the S matrix</span></span>
<span id="cb86-7"><a href="appendix_b.html#cb86-7" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb86-8"><a href="appendix_b.html#cb86-8" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum&quot;</span>)</span>
<span id="cb86-9"><a href="appendix_b.html#cb86-9" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb86-10"><a href="appendix_b.html#cb86-10" tabindex="-1"></a>    S[n,<span class="st">&quot;sum&quot;</span>] <span class="ot">&lt;-</span> ( (( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb86-11"><a href="appendix_b.html#cb86-11" tabindex="-1"></a>                        b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb86-12"><a href="appendix_b.html#cb86-12" tabindex="-1"></a>                        b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb86-13"><a href="appendix_b.html#cb86-13" tabindex="-1"></a>                        b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb86-14"><a href="appendix_b.html#cb86-14" tabindex="-1"></a>                        b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-15"><a href="appendix_b.html#cb86-15" tabindex="-1"></a>                        b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-16"><a href="appendix_b.html#cb86-16" tabindex="-1"></a>                        b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb86-17"><a href="appendix_b.html#cb86-17" tabindex="-1"></a>                      (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-18"><a href="appendix_b.html#cb86-18" tabindex="-1"></a>                           b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb86-19"><a href="appendix_b.html#cb86-19" tabindex="-1"></a>                           b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-20"><a href="appendix_b.html#cb86-20" tabindex="-1"></a>                           b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb86-21"><a href="appendix_b.html#cb86-21" tabindex="-1"></a>                      (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-22"><a href="appendix_b.html#cb86-22" tabindex="-1"></a>                                 b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb86-23"><a href="appendix_b.html#cb86-23" tabindex="-1"></a>                                 b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-24"><a href="appendix_b.html#cb86-24" tabindex="-1"></a>                                 b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] )) ) <span class="sc">-</span> </span>
<span id="cb86-25"><a href="appendix_b.html#cb86-25" tabindex="-1"></a>                      (( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb86-26"><a href="appendix_b.html#cb86-26" tabindex="-1"></a>                          b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb86-27"><a href="appendix_b.html#cb86-27" tabindex="-1"></a>                          b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb86-28"><a href="appendix_b.html#cb86-28" tabindex="-1"></a>                          b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb86-29"><a href="appendix_b.html#cb86-29" tabindex="-1"></a>                          b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-30"><a href="appendix_b.html#cb86-30" tabindex="-1"></a>                          b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-31"><a href="appendix_b.html#cb86-31" tabindex="-1"></a>                          b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb86-32"><a href="appendix_b.html#cb86-32" tabindex="-1"></a>                      (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-33"><a href="appendix_b.html#cb86-33" tabindex="-1"></a>                           b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb86-34"><a href="appendix_b.html#cb86-34" tabindex="-1"></a>                           b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-35"><a href="appendix_b.html#cb86-35" tabindex="-1"></a>                           b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb86-36"><a href="appendix_b.html#cb86-36" tabindex="-1"></a>                      (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-37"><a href="appendix_b.html#cb86-37" tabindex="-1"></a>                                 b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb86-38"><a href="appendix_b.html#cb86-38" tabindex="-1"></a>                                 b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-39"><a href="appendix_b.html#cb86-39" tabindex="-1"></a>                                 b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] )) ) ) <span class="sc">*</span></span>
<span id="cb86-40"><a href="appendix_b.html#cb86-40" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb86-41"><a href="appendix_b.html#cb86-41" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb86-42"><a href="appendix_b.html#cb86-42" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb86-43"><a href="appendix_b.html#cb86-43" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb86-44"><a href="appendix_b.html#cb86-44" tabindex="-1"></a>    }</span>
<span id="cb86-45"><a href="appendix_b.html#cb86-45" tabindex="-1"></a>  </span>
<span id="cb86-46"><a href="appendix_b.html#cb86-46" tabindex="-1"></a>  CDE.M0.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb86-47"><a href="appendix_b.html#cb86-47" tabindex="-1"></a>  CDE.M1.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[<span class="dv">9</span><span class="sc">:</span><span class="dv">16</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb86-48"><a href="appendix_b.html#cb86-48" tabindex="-1"></a>  </span>
<span id="cb86-49"><a href="appendix_b.html#cb86-49" tabindex="-1"></a>  <span class="co"># quantitative outcome (QoL)</span></span>
<span id="cb86-50"><a href="appendix_b.html#cb86-50" tabindex="-1"></a>  <span class="co"># we estimate both CDE, fixing do(M) = 0 et do(M) = 1 and using the </span></span>
<span id="cb86-51"><a href="appendix_b.html#cb86-51" tabindex="-1"></a>  <span class="co"># corresponding lines in the S matrix</span></span>
<span id="cb86-52"><a href="appendix_b.html#cb86-52" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb86-53"><a href="appendix_b.html#cb86-53" tabindex="-1"></a>    S[n,<span class="st">&quot;sum&quot;</span>] <span class="ot">&lt;-</span> ( (( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb86-54"><a href="appendix_b.html#cb86-54" tabindex="-1"></a>                        b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb86-55"><a href="appendix_b.html#cb86-55" tabindex="-1"></a>                        b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb86-56"><a href="appendix_b.html#cb86-56" tabindex="-1"></a>                        b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb86-57"><a href="appendix_b.html#cb86-57" tabindex="-1"></a>                        b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-58"><a href="appendix_b.html#cb86-58" tabindex="-1"></a>                        b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-59"><a href="appendix_b.html#cb86-59" tabindex="-1"></a>                        b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb86-60"><a href="appendix_b.html#cb86-60" tabindex="-1"></a>                      (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-61"><a href="appendix_b.html#cb86-61" tabindex="-1"></a>                           b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb86-62"><a href="appendix_b.html#cb86-62" tabindex="-1"></a>                           b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-63"><a href="appendix_b.html#cb86-63" tabindex="-1"></a>                           b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb86-64"><a href="appendix_b.html#cb86-64" tabindex="-1"></a>                      (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-65"><a href="appendix_b.html#cb86-65" tabindex="-1"></a>                                 b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb86-66"><a href="appendix_b.html#cb86-66" tabindex="-1"></a>                                 b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-67"><a href="appendix_b.html#cb86-67" tabindex="-1"></a>                                 b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] ))) <span class="sc">-</span> </span>
<span id="cb86-68"><a href="appendix_b.html#cb86-68" tabindex="-1"></a>                      (( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span> </span>
<span id="cb86-69"><a href="appendix_b.html#cb86-69" tabindex="-1"></a>                          b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb86-70"><a href="appendix_b.html#cb86-70" tabindex="-1"></a>                          b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb86-71"><a href="appendix_b.html#cb86-71" tabindex="-1"></a>                          b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb86-72"><a href="appendix_b.html#cb86-72" tabindex="-1"></a>                          b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-73"><a href="appendix_b.html#cb86-73" tabindex="-1"></a>                          b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-74"><a href="appendix_b.html#cb86-74" tabindex="-1"></a>                          b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb86-75"><a href="appendix_b.html#cb86-75" tabindex="-1"></a>                      (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-76"><a href="appendix_b.html#cb86-76" tabindex="-1"></a>                           b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb86-77"><a href="appendix_b.html#cb86-77" tabindex="-1"></a>                           b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-78"><a href="appendix_b.html#cb86-78" tabindex="-1"></a>                           b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb86-79"><a href="appendix_b.html#cb86-79" tabindex="-1"></a>                      (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-80"><a href="appendix_b.html#cb86-80" tabindex="-1"></a>                                 b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb86-81"><a href="appendix_b.html#cb86-81" tabindex="-1"></a>                                 b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb86-82"><a href="appendix_b.html#cb86-82" tabindex="-1"></a>                                 b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] )) ) ) <span class="sc">*</span></span>
<span id="cb86-83"><a href="appendix_b.html#cb86-83" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb86-84"><a href="appendix_b.html#cb86-84" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb86-85"><a href="appendix_b.html#cb86-85" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb86-86"><a href="appendix_b.html#cb86-86" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb86-87"><a href="appendix_b.html#cb86-87" tabindex="-1"></a>    }</span>
<span id="cb86-88"><a href="appendix_b.html#cb86-88" tabindex="-1"></a>  </span>
<span id="cb86-89"><a href="appendix_b.html#cb86-89" tabindex="-1"></a>  CDE.M0.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb86-90"><a href="appendix_b.html#cb86-90" tabindex="-1"></a>  CDE.M1.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[<span class="dv">9</span><span class="sc">:</span><span class="dv">16</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb86-91"><a href="appendix_b.html#cb86-91" tabindex="-1"></a>  </span>
<span id="cb86-92"><a href="appendix_b.html#cb86-92" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">CDE.M0.death =</span> CDE.M0.death, <span class="at">CDE.M1.death =</span> CDE.M1.death, </span>
<span id="cb86-93"><a href="appendix_b.html#cb86-93" tabindex="-1"></a>              <span class="at">CDE.M0.qol =</span> CDE.M0.qol, <span class="at">CDE.M1.qol =</span> CDE.M1.qol))</span>
<span id="cb86-94"><a href="appendix_b.html#cb86-94" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="appendix_b.html#cb87-1" tabindex="-1"></a>true.CDE2.no.inter <span class="ot">&lt;-</span> <span class="fu">true.CDE.time.var</span>(<span class="at">interaction =</span> <span class="dv">0</span>)</span>
<span id="cb87-2"><a href="appendix_b.html#cb87-2" tabindex="-1"></a></span>
<span id="cb87-3"><a href="appendix_b.html#cb87-3" tabindex="-1"></a>true.CDE2.with.inter <span class="ot">&lt;-</span> <span class="fu">true.CDE.time.var</span>(<span class="at">interaction =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>Setting <span class="math inline">\(do(M=0)\)</span>, the controlled direct effects <span class="math inline">\(\text{CDE}_{M=0} = \mathbb{E}\left(Y_{1,0} \right) - \mathbb{E}\left(Y_{0,0} \right)\)</span> are:</p>
<ul>
<li>0.064 for death and -5 for quality of life without interaction</li>
<li>0.064 for death and -5 for quality of life with interaction</li>
</ul>
<p>Setting <span class="math inline">\(do(M=1)\)</span>, the controlled direct effects <span class="math inline">\(\text{CDE}_{M=1} = \mathbb{E}\left(Y_{1,1} \right) - \mathbb{E}\left(Y_{0,1} \right)\)</span> are:</p>
<ul>
<li>0.064 for death and -5 for quality of life without interaction</li>
<li>0.094 for death and -10 for quality of life with interaction</li>
</ul>
</div>
<div id="marginal-randomized-direct-and-indirect-effects-1" class="section level3 hasAnchor" number="11.2.3">
<h3><span class="header-section-number">11.2.3</span> Marginal randomized direct and indirect effects<a href="appendix_b.html#marginal-randomized-direct-and-indirect-effects-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following function <code>true.marg.random.time.var</code> can be used to run the calculation for the marginal randomized natural direct (marginal MRDE) and indirect effects (marginal MRIE).</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="appendix_b.html#cb88-1" tabindex="-1"></a>true.marg.random.time.var <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">interaction =</span> <span class="cn">NULL</span>) {</span>
<span id="cb88-2"><a href="appendix_b.html#cb88-2" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">param.causal.model.2</span>(<span class="at">A.M.interaction =</span> interaction)</span>
<span id="cb88-3"><a href="appendix_b.html#cb88-3" tabindex="-1"></a>  </span>
<span id="cb88-4"><a href="appendix_b.html#cb88-4" tabindex="-1"></a>  <span class="co"># marginal distribution of M</span></span>
<span id="cb88-5"><a href="appendix_b.html#cb88-5" tabindex="-1"></a>  M.S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">5</span>))</span>
<span id="cb88-6"><a href="appendix_b.html#cb88-6" tabindex="-1"></a>  <span class="fu">colnames</span>(M.S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;A&quot;</span>,<span class="st">&quot;sum&quot;</span>)</span>
<span id="cb88-7"><a href="appendix_b.html#cb88-7" tabindex="-1"></a>  </span>
<span id="cb88-8"><a href="appendix_b.html#cb88-8" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">32</span>) {</span>
<span id="cb88-9"><a href="appendix_b.html#cb88-9" tabindex="-1"></a>    M.S[n,<span class="st">&quot;sum&quot;</span>] <span class="ot">&lt;-</span> (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span>                                                              </span>
<span id="cb88-10"><a href="appendix_b.html#cb88-10" tabindex="-1"></a>                         b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb88-11"><a href="appendix_b.html#cb88-11" tabindex="-1"></a>                         b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb88-12"><a href="appendix_b.html#cb88-12" tabindex="-1"></a>                         b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-13"><a href="appendix_b.html#cb88-13" tabindex="-1"></a>                         b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;A&quot;</span>])<span class="sc">^</span>( M.S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-14"><a href="appendix_b.html#cb88-14" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb88-15"><a href="appendix_b.html#cb88-15" tabindex="-1"></a>                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb88-16"><a href="appendix_b.html#cb88-16" tabindex="-1"></a>                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb88-17"><a href="appendix_b.html#cb88-17" tabindex="-1"></a>                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-18"><a href="appendix_b.html#cb88-18" tabindex="-1"></a>                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;A&quot;</span>]) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> M.S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-19"><a href="appendix_b.html#cb88-19" tabindex="-1"></a>      (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span>                                                           </span>
<span id="cb88-20"><a href="appendix_b.html#cb88-20" tabindex="-1"></a>           b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb88-21"><a href="appendix_b.html#cb88-21" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-22"><a href="appendix_b.html#cb88-22" tabindex="-1"></a>           b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;A&quot;</span>])<span class="sc">^</span>( M.S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-23"><a href="appendix_b.html#cb88-23" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-24"><a href="appendix_b.html#cb88-24" tabindex="-1"></a>                 b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb88-25"><a href="appendix_b.html#cb88-25" tabindex="-1"></a>                 b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-26"><a href="appendix_b.html#cb88-26" tabindex="-1"></a>                 b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> M.S[n,<span class="st">&quot;A&quot;</span>]))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> M.S[n,<span class="st">&quot;L1&quot;</span>] )) </span>
<span id="cb88-27"><a href="appendix_b.html#cb88-27" tabindex="-1"></a>    }</span>
<span id="cb88-28"><a href="appendix_b.html#cb88-28" tabindex="-1"></a>  </span>
<span id="cb88-29"><a href="appendix_b.html#cb88-29" tabindex="-1"></a>  M0.A0.L00 <span class="ot">&lt;-</span> <span class="fu">sum</span>(M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb88-30"><a href="appendix_b.html#cb88-30" tabindex="-1"></a>                         M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb88-31"><a href="appendix_b.html#cb88-31" tabindex="-1"></a>  M0.A0.L01 <span class="ot">&lt;-</span> <span class="fu">sum</span>(M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb88-32"><a href="appendix_b.html#cb88-32" tabindex="-1"></a>                         M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb88-33"><a href="appendix_b.html#cb88-33" tabindex="-1"></a>  M0.A0.L10 <span class="ot">&lt;-</span> <span class="fu">sum</span>(M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb88-34"><a href="appendix_b.html#cb88-34" tabindex="-1"></a>                         M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb88-35"><a href="appendix_b.html#cb88-35" tabindex="-1"></a>  M0.A0.L11 <span class="ot">&lt;-</span> <span class="fu">sum</span>(M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb88-36"><a href="appendix_b.html#cb88-36" tabindex="-1"></a>                         M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb88-37"><a href="appendix_b.html#cb88-37" tabindex="-1"></a>  </span>
<span id="cb88-38"><a href="appendix_b.html#cb88-38" tabindex="-1"></a>  M1.A0.L00 <span class="ot">&lt;-</span> <span class="fu">sum</span>(M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb88-39"><a href="appendix_b.html#cb88-39" tabindex="-1"></a>                         M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb88-40"><a href="appendix_b.html#cb88-40" tabindex="-1"></a>  M1.A0.L01 <span class="ot">&lt;-</span> <span class="fu">sum</span>(M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb88-41"><a href="appendix_b.html#cb88-41" tabindex="-1"></a>                         M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb88-42"><a href="appendix_b.html#cb88-42" tabindex="-1"></a>  M1.A0.L10 <span class="ot">&lt;-</span> <span class="fu">sum</span>(M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb88-43"><a href="appendix_b.html#cb88-43" tabindex="-1"></a>                         M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb88-44"><a href="appendix_b.html#cb88-44" tabindex="-1"></a>  M1.A0.L11 <span class="ot">&lt;-</span> <span class="fu">sum</span>(M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb88-45"><a href="appendix_b.html#cb88-45" tabindex="-1"></a>                         M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb88-46"><a href="appendix_b.html#cb88-46" tabindex="-1"></a></span>
<span id="cb88-47"><a href="appendix_b.html#cb88-47" tabindex="-1"></a>  M0.A1.L00 <span class="ot">&lt;-</span> <span class="fu">sum</span>(M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb88-48"><a href="appendix_b.html#cb88-48" tabindex="-1"></a>                         M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb88-49"><a href="appendix_b.html#cb88-49" tabindex="-1"></a>  M0.A1.L01 <span class="ot">&lt;-</span> <span class="fu">sum</span>(M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb88-50"><a href="appendix_b.html#cb88-50" tabindex="-1"></a>                         M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb88-51"><a href="appendix_b.html#cb88-51" tabindex="-1"></a>  M0.A1.L10 <span class="ot">&lt;-</span> <span class="fu">sum</span>(M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb88-52"><a href="appendix_b.html#cb88-52" tabindex="-1"></a>                         M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb88-53"><a href="appendix_b.html#cb88-53" tabindex="-1"></a>  M0.A1.L11 <span class="ot">&lt;-</span> <span class="fu">sum</span>(M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb88-54"><a href="appendix_b.html#cb88-54" tabindex="-1"></a>                         M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb88-55"><a href="appendix_b.html#cb88-55" tabindex="-1"></a>  </span>
<span id="cb88-56"><a href="appendix_b.html#cb88-56" tabindex="-1"></a>  M1.A1.L00 <span class="ot">&lt;-</span> <span class="fu">sum</span>(M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb88-57"><a href="appendix_b.html#cb88-57" tabindex="-1"></a>                         M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb88-58"><a href="appendix_b.html#cb88-58" tabindex="-1"></a>  M1.A1.L01 <span class="ot">&lt;-</span> <span class="fu">sum</span>(M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span> <span class="sc">&amp;</span> </span>
<span id="cb88-59"><a href="appendix_b.html#cb88-59" tabindex="-1"></a>                         M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb88-60"><a href="appendix_b.html#cb88-60" tabindex="-1"></a>  M1.A1.L10 <span class="ot">&lt;-</span> <span class="fu">sum</span>(M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb88-61"><a href="appendix_b.html#cb88-61" tabindex="-1"></a>                         M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb88-62"><a href="appendix_b.html#cb88-62" tabindex="-1"></a>  M1.A1.L11 <span class="ot">&lt;-</span> <span class="fu">sum</span>(M.S[M.S[,<span class="st">&quot;M&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;A&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> M.S[,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> </span>
<span id="cb88-63"><a href="appendix_b.html#cb88-63" tabindex="-1"></a>                         M.S[,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>,<span class="st">&quot;sum&quot;</span>])</span>
<span id="cb88-64"><a href="appendix_b.html#cb88-64" tabindex="-1"></a>  </span>
<span id="cb88-65"><a href="appendix_b.html#cb88-65" tabindex="-1"></a>  <span class="co"># binary outcome (death)</span></span>
<span id="cb88-66"><a href="appendix_b.html#cb88-66" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), </span>
<span id="cb88-67"><a href="appendix_b.html#cb88-67" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb88-68"><a href="appendix_b.html#cb88-68" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum.psi11&quot;</span>, </span>
<span id="cb88-69"><a href="appendix_b.html#cb88-69" tabindex="-1"></a>                      <span class="st">&quot;sum.psi10&quot;</span>, <span class="st">&quot;sum.psi00&quot;</span>)</span>
<span id="cb88-70"><a href="appendix_b.html#cb88-70" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb88-71"><a href="appendix_b.html#cb88-71" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi11&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span>                                           <span class="co"># A=1</span></span>
<span id="cb88-72"><a href="appendix_b.html#cb88-72" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb88-73"><a href="appendix_b.html#cb88-73" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb88-74"><a href="appendix_b.html#cb88-74" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb88-75"><a href="appendix_b.html#cb88-75" tabindex="-1"></a>                             b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-76"><a href="appendix_b.html#cb88-76" tabindex="-1"></a>                             b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-77"><a href="appendix_b.html#cb88-77" tabindex="-1"></a>                             b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb88-78"><a href="appendix_b.html#cb88-78" tabindex="-1"></a>          ((M1.A1.L00<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span>                <span class="co"># A&#39;=1</span></span>
<span id="cb88-79"><a href="appendix_b.html#cb88-79" tabindex="-1"></a>              M1.A1.L01<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb88-80"><a href="appendix_b.html#cb88-80" tabindex="-1"></a>              M1.A1.L10<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb88-81"><a href="appendix_b.html#cb88-81" tabindex="-1"></a>              M1.A1.L11<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-82"><a href="appendix_b.html#cb88-82" tabindex="-1"></a>      ((M0.A1.L00<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span>                </span>
<span id="cb88-83"><a href="appendix_b.html#cb88-83" tabindex="-1"></a>          M0.A1.L01<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb88-84"><a href="appendix_b.html#cb88-84" tabindex="-1"></a>          M0.A1.L10<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb88-85"><a href="appendix_b.html#cb88-85" tabindex="-1"></a>          M0.A1.L11<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-86"><a href="appendix_b.html#cb88-86" tabindex="-1"></a>      (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span>                                                            <span class="co"># A=1</span></span>
<span id="cb88-87"><a href="appendix_b.html#cb88-87" tabindex="-1"></a>           b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb88-88"><a href="appendix_b.html#cb88-88" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-89"><a href="appendix_b.html#cb88-89" tabindex="-1"></a>           b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-90"><a href="appendix_b.html#cb88-90" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-91"><a href="appendix_b.html#cb88-91" tabindex="-1"></a>                 b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb88-92"><a href="appendix_b.html#cb88-92" tabindex="-1"></a>                 b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-93"><a href="appendix_b.html#cb88-93" tabindex="-1"></a>                 b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-94"><a href="appendix_b.html#cb88-94" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb88-95"><a href="appendix_b.html#cb88-95" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb88-96"><a href="appendix_b.html#cb88-96" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb88-97"><a href="appendix_b.html#cb88-97" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb88-98"><a href="appendix_b.html#cb88-98" tabindex="-1"></a>    </span>
<span id="cb88-99"><a href="appendix_b.html#cb88-99" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi10&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span>                                           <span class="co"># A=1</span></span>
<span id="cb88-100"><a href="appendix_b.html#cb88-100" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb88-101"><a href="appendix_b.html#cb88-101" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb88-102"><a href="appendix_b.html#cb88-102" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb88-103"><a href="appendix_b.html#cb88-103" tabindex="-1"></a>                             b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-104"><a href="appendix_b.html#cb88-104" tabindex="-1"></a>                             b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-105"><a href="appendix_b.html#cb88-105" tabindex="-1"></a>                             b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb88-106"><a href="appendix_b.html#cb88-106" tabindex="-1"></a>      ((M1.A0.L00<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span>                    <span class="co"># A&#39;=0</span></span>
<span id="cb88-107"><a href="appendix_b.html#cb88-107" tabindex="-1"></a>          M1.A0.L01<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb88-108"><a href="appendix_b.html#cb88-108" tabindex="-1"></a>          M1.A0.L10<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb88-109"><a href="appendix_b.html#cb88-109" tabindex="-1"></a>          M1.A0.L11<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-110"><a href="appendix_b.html#cb88-110" tabindex="-1"></a>      ((M0.A0.L00<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span>                </span>
<span id="cb88-111"><a href="appendix_b.html#cb88-111" tabindex="-1"></a>          M0.A0.L01<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb88-112"><a href="appendix_b.html#cb88-112" tabindex="-1"></a>          M0.A0.L10<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb88-113"><a href="appendix_b.html#cb88-113" tabindex="-1"></a>          M0.A0.L11<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-114"><a href="appendix_b.html#cb88-114" tabindex="-1"></a>      (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span>                                                            <span class="co"># A=1</span></span>
<span id="cb88-115"><a href="appendix_b.html#cb88-115" tabindex="-1"></a>           b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb88-116"><a href="appendix_b.html#cb88-116" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-117"><a href="appendix_b.html#cb88-117" tabindex="-1"></a>           b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-118"><a href="appendix_b.html#cb88-118" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-119"><a href="appendix_b.html#cb88-119" tabindex="-1"></a>                 b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb88-120"><a href="appendix_b.html#cb88-120" tabindex="-1"></a>                 b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-121"><a href="appendix_b.html#cb88-121" tabindex="-1"></a>                 b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-122"><a href="appendix_b.html#cb88-122" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb88-123"><a href="appendix_b.html#cb88-123" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb88-124"><a href="appendix_b.html#cb88-124" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb88-125"><a href="appendix_b.html#cb88-125" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb88-126"><a href="appendix_b.html#cb88-126" tabindex="-1"></a>    </span>
<span id="cb88-127"><a href="appendix_b.html#cb88-127" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi00&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span>                                           <span class="co"># A=0</span></span>
<span id="cb88-128"><a href="appendix_b.html#cb88-128" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb88-129"><a href="appendix_b.html#cb88-129" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb88-130"><a href="appendix_b.html#cb88-130" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb88-131"><a href="appendix_b.html#cb88-131" tabindex="-1"></a>                             b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-132"><a href="appendix_b.html#cb88-132" tabindex="-1"></a>                             b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-133"><a href="appendix_b.html#cb88-133" tabindex="-1"></a>                             b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb88-134"><a href="appendix_b.html#cb88-134" tabindex="-1"></a>      ((M1.A0.L00<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span>                    <span class="co"># A&#39;=0</span></span>
<span id="cb88-135"><a href="appendix_b.html#cb88-135" tabindex="-1"></a>          M1.A0.L01<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb88-136"><a href="appendix_b.html#cb88-136" tabindex="-1"></a>          M1.A0.L10<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb88-137"><a href="appendix_b.html#cb88-137" tabindex="-1"></a>          M1.A0.L11<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-138"><a href="appendix_b.html#cb88-138" tabindex="-1"></a>      ((M0.A0.L00<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span>                </span>
<span id="cb88-139"><a href="appendix_b.html#cb88-139" tabindex="-1"></a>          M0.A0.L01<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb88-140"><a href="appendix_b.html#cb88-140" tabindex="-1"></a>          M0.A0.L10<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb88-141"><a href="appendix_b.html#cb88-141" tabindex="-1"></a>          M0.A0.L11<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-142"><a href="appendix_b.html#cb88-142" tabindex="-1"></a>      (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span>                                                            <span class="co"># A=0</span></span>
<span id="cb88-143"><a href="appendix_b.html#cb88-143" tabindex="-1"></a>           b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb88-144"><a href="appendix_b.html#cb88-144" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-145"><a href="appendix_b.html#cb88-145" tabindex="-1"></a>           b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-146"><a href="appendix_b.html#cb88-146" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-147"><a href="appendix_b.html#cb88-147" tabindex="-1"></a>                 b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb88-148"><a href="appendix_b.html#cb88-148" tabindex="-1"></a>                 b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-149"><a href="appendix_b.html#cb88-149" tabindex="-1"></a>                 b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-150"><a href="appendix_b.html#cb88-150" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb88-151"><a href="appendix_b.html#cb88-151" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb88-152"><a href="appendix_b.html#cb88-152" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb88-153"><a href="appendix_b.html#cb88-153" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb88-154"><a href="appendix_b.html#cb88-154" tabindex="-1"></a>    }</span>
<span id="cb88-155"><a href="appendix_b.html#cb88-155" tabindex="-1"></a>  </span>
<span id="cb88-156"><a href="appendix_b.html#cb88-156" tabindex="-1"></a>  mrNDE.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi10&quot;</span>]) <span class="sc">-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi00&quot;</span>])</span>
<span id="cb88-157"><a href="appendix_b.html#cb88-157" tabindex="-1"></a>  mrNIE.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi11&quot;</span>]) <span class="sc">-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi10&quot;</span>])</span>
<span id="cb88-158"><a href="appendix_b.html#cb88-158" tabindex="-1"></a>  </span>
<span id="cb88-159"><a href="appendix_b.html#cb88-159" tabindex="-1"></a>  <span class="co"># quantitative outcome (QoL)</span></span>
<span id="cb88-160"><a href="appendix_b.html#cb88-160" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), </span>
<span id="cb88-161"><a href="appendix_b.html#cb88-161" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb88-162"><a href="appendix_b.html#cb88-162" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum.psi11&quot;</span>, <span class="st">&quot;sum.psi10&quot;</span>, </span>
<span id="cb88-163"><a href="appendix_b.html#cb88-163" tabindex="-1"></a>                      <span class="st">&quot;sum.psi00&quot;</span>)</span>
<span id="cb88-164"><a href="appendix_b.html#cb88-164" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb88-165"><a href="appendix_b.html#cb88-165" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi11&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span>                                          <span class="co"># A=1</span></span>
<span id="cb88-166"><a href="appendix_b.html#cb88-166" tabindex="-1"></a>                             b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb88-167"><a href="appendix_b.html#cb88-167" tabindex="-1"></a>                             b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb88-168"><a href="appendix_b.html#cb88-168" tabindex="-1"></a>                             b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb88-169"><a href="appendix_b.html#cb88-169" tabindex="-1"></a>                             b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-170"><a href="appendix_b.html#cb88-170" tabindex="-1"></a>                             b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-171"><a href="appendix_b.html#cb88-171" tabindex="-1"></a>                             b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb88-172"><a href="appendix_b.html#cb88-172" tabindex="-1"></a>      ((M1.A1.L00<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span>                    <span class="co"># A&#39;=1</span></span>
<span id="cb88-173"><a href="appendix_b.html#cb88-173" tabindex="-1"></a>          M1.A1.L01<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb88-174"><a href="appendix_b.html#cb88-174" tabindex="-1"></a>          M1.A1.L10<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb88-175"><a href="appendix_b.html#cb88-175" tabindex="-1"></a>          M1.A1.L11<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-176"><a href="appendix_b.html#cb88-176" tabindex="-1"></a>      ((M0.A1.L00<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span>                </span>
<span id="cb88-177"><a href="appendix_b.html#cb88-177" tabindex="-1"></a>          M0.A1.L01<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb88-178"><a href="appendix_b.html#cb88-178" tabindex="-1"></a>          M0.A1.L10<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb88-179"><a href="appendix_b.html#cb88-179" tabindex="-1"></a>          M0.A1.L11<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-180"><a href="appendix_b.html#cb88-180" tabindex="-1"></a>      (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span>                                                            <span class="co"># A=1</span></span>
<span id="cb88-181"><a href="appendix_b.html#cb88-181" tabindex="-1"></a>           b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb88-182"><a href="appendix_b.html#cb88-182" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-183"><a href="appendix_b.html#cb88-183" tabindex="-1"></a>           b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-184"><a href="appendix_b.html#cb88-184" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-185"><a href="appendix_b.html#cb88-185" tabindex="-1"></a>                 b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb88-186"><a href="appendix_b.html#cb88-186" tabindex="-1"></a>                 b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-187"><a href="appendix_b.html#cb88-187" tabindex="-1"></a>                 b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-188"><a href="appendix_b.html#cb88-188" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb88-189"><a href="appendix_b.html#cb88-189" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb88-190"><a href="appendix_b.html#cb88-190" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb88-191"><a href="appendix_b.html#cb88-191" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb88-192"><a href="appendix_b.html#cb88-192" tabindex="-1"></a>    </span>
<span id="cb88-193"><a href="appendix_b.html#cb88-193" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi10&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span>                                          <span class="co"># A=1</span></span>
<span id="cb88-194"><a href="appendix_b.html#cb88-194" tabindex="-1"></a>                             b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb88-195"><a href="appendix_b.html#cb88-195" tabindex="-1"></a>                             b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb88-196"><a href="appendix_b.html#cb88-196" tabindex="-1"></a>                             b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span></span>
<span id="cb88-197"><a href="appendix_b.html#cb88-197" tabindex="-1"></a>                             b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-198"><a href="appendix_b.html#cb88-198" tabindex="-1"></a>                             b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-199"><a href="appendix_b.html#cb88-199" tabindex="-1"></a>                             b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb88-200"><a href="appendix_b.html#cb88-200" tabindex="-1"></a>      ((M1.A0.L00<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span>                    <span class="co"># A&#39;=0</span></span>
<span id="cb88-201"><a href="appendix_b.html#cb88-201" tabindex="-1"></a>          M1.A0.L01<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb88-202"><a href="appendix_b.html#cb88-202" tabindex="-1"></a>          M1.A0.L10<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb88-203"><a href="appendix_b.html#cb88-203" tabindex="-1"></a>          M1.A0.L11<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-204"><a href="appendix_b.html#cb88-204" tabindex="-1"></a>      ((M0.A0.L00<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span>                </span>
<span id="cb88-205"><a href="appendix_b.html#cb88-205" tabindex="-1"></a>          M0.A0.L01<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb88-206"><a href="appendix_b.html#cb88-206" tabindex="-1"></a>          M0.A0.L10<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb88-207"><a href="appendix_b.html#cb88-207" tabindex="-1"></a>          M0.A0.L11<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-208"><a href="appendix_b.html#cb88-208" tabindex="-1"></a>      (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span>                                                            <span class="co"># A=1</span></span>
<span id="cb88-209"><a href="appendix_b.html#cb88-209" tabindex="-1"></a>           b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb88-210"><a href="appendix_b.html#cb88-210" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-211"><a href="appendix_b.html#cb88-211" tabindex="-1"></a>           b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-212"><a href="appendix_b.html#cb88-212" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-213"><a href="appendix_b.html#cb88-213" tabindex="-1"></a>                 b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb88-214"><a href="appendix_b.html#cb88-214" tabindex="-1"></a>                 b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-215"><a href="appendix_b.html#cb88-215" tabindex="-1"></a>                 b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-216"><a href="appendix_b.html#cb88-216" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb88-217"><a href="appendix_b.html#cb88-217" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb88-218"><a href="appendix_b.html#cb88-218" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb88-219"><a href="appendix_b.html#cb88-219" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb88-220"><a href="appendix_b.html#cb88-220" tabindex="-1"></a>    </span>
<span id="cb88-221"><a href="appendix_b.html#cb88-221" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi00&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span>                                          <span class="co"># A=0</span></span>
<span id="cb88-222"><a href="appendix_b.html#cb88-222" tabindex="-1"></a>                             b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb88-223"><a href="appendix_b.html#cb88-223" tabindex="-1"></a>                             b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb88-224"><a href="appendix_b.html#cb88-224" tabindex="-1"></a>                             b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb88-225"><a href="appendix_b.html#cb88-225" tabindex="-1"></a>                             b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-226"><a href="appendix_b.html#cb88-226" tabindex="-1"></a>                             b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-227"><a href="appendix_b.html#cb88-227" tabindex="-1"></a>                             b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb88-228"><a href="appendix_b.html#cb88-228" tabindex="-1"></a>      ((M1.A0.L00<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span>                    <span class="co"># A&#39;=0</span></span>
<span id="cb88-229"><a href="appendix_b.html#cb88-229" tabindex="-1"></a>          M1.A0.L01<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb88-230"><a href="appendix_b.html#cb88-230" tabindex="-1"></a>          M1.A0.L10<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb88-231"><a href="appendix_b.html#cb88-231" tabindex="-1"></a>          M1.A0.L11<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-232"><a href="appendix_b.html#cb88-232" tabindex="-1"></a>      ((M0.A0.L00<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span>                </span>
<span id="cb88-233"><a href="appendix_b.html#cb88-233" tabindex="-1"></a>          M0.A0.L01<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">0</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb88-234"><a href="appendix_b.html#cb88-234" tabindex="-1"></a>          M0.A0.L10<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb88-235"><a href="appendix_b.html#cb88-235" tabindex="-1"></a>          M0.A0.L11<span class="sc">*</span>(S[n,<span class="st">&quot;male&quot;</span>]<span class="sc">==</span><span class="dv">1</span>)<span class="sc">*</span>(S[n,<span class="st">&quot;soc_env&quot;</span>]<span class="sc">==</span><span class="dv">1</span>) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-236"><a href="appendix_b.html#cb88-236" tabindex="-1"></a>      (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span>                                                            <span class="co"># A=0</span></span>
<span id="cb88-237"><a href="appendix_b.html#cb88-237" tabindex="-1"></a>           b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb88-238"><a href="appendix_b.html#cb88-238" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-239"><a href="appendix_b.html#cb88-239" tabindex="-1"></a>           b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-240"><a href="appendix_b.html#cb88-240" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-241"><a href="appendix_b.html#cb88-241" tabindex="-1"></a>                 b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb88-242"><a href="appendix_b.html#cb88-242" tabindex="-1"></a>                 b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb88-243"><a href="appendix_b.html#cb88-243" tabindex="-1"></a>                 b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb88-244"><a href="appendix_b.html#cb88-244" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb88-245"><a href="appendix_b.html#cb88-245" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb88-246"><a href="appendix_b.html#cb88-246" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb88-247"><a href="appendix_b.html#cb88-247" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb88-248"><a href="appendix_b.html#cb88-248" tabindex="-1"></a>    }</span>
<span id="cb88-249"><a href="appendix_b.html#cb88-249" tabindex="-1"></a>  </span>
<span id="cb88-250"><a href="appendix_b.html#cb88-250" tabindex="-1"></a>  mrNDE.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi10&quot;</span>]) <span class="sc">-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi00&quot;</span>])</span>
<span id="cb88-251"><a href="appendix_b.html#cb88-251" tabindex="-1"></a>  mrNIE.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi11&quot;</span>]) <span class="sc">-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi10&quot;</span>])</span>
<span id="cb88-252"><a href="appendix_b.html#cb88-252" tabindex="-1"></a>  </span>
<span id="cb88-253"><a href="appendix_b.html#cb88-253" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">mrNDE.death =</span> mrNDE.death, <span class="at">mrNIE.death =</span> mrNIE.death, </span>
<span id="cb88-254"><a href="appendix_b.html#cb88-254" tabindex="-1"></a>              <span class="at">mrNDE.qol =</span> mrNDE.qol, <span class="at">mrNIE.qol =</span> mrNIE.qol))</span>
<span id="cb88-255"><a href="appendix_b.html#cb88-255" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="appendix_b.html#cb89-1" tabindex="-1"></a>true.marg.random2.no.inter <span class="ot">&lt;-</span> <span class="fu">true.marg.random.time.var</span>(<span class="at">interaction =</span> <span class="dv">0</span>)</span>
<span id="cb89-2"><a href="appendix_b.html#cb89-2" tabindex="-1"></a></span>
<span id="cb89-3"><a href="appendix_b.html#cb89-3" tabindex="-1"></a>true.marg.random2.with.inter <span class="ot">&lt;-</span> <span class="fu">true.marg.random.time.var</span>(<span class="at">interaction =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>The marginal randomized direct effect <span class="math inline">\(\text{MRDE}=\mathbb{E}\left(Y_{1,G_{0|L(0)}}\right) - \mathbb{E}\left(Y_{0,G_{0|L(0)}}\right)\)</span> and the marginal randomized indirect effect <span class="math inline">\(\text{MRIE}=\mathbb{E}\left(Y_{1,G_{1|L(0)}}\right) - \mathbb{E}\left(Y_{1,G_{0|L(0)}}\right)\)</span> are respectively:</p>
<ul>
<li>0.064 and 0.0112 for death without interaction</li>
<li>0.073882 and 0.0154 for death with interaction</li>
<li>-5 and -1.26 for quality of life without interaction</li>
<li>-6.647 and -1.96 for quality of life with interaction</li>
</ul>
</div>
<div id="conditional-randomized-direct-and-indirect-effects-1" class="section level3 hasAnchor" number="11.2.4">
<h3><span class="header-section-number">11.2.4</span> Conditional randomized direct and indirect effects<a href="appendix_b.html#conditional-randomized-direct-and-indirect-effects-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The following function <code>true.cond.random.time.var</code> can be used to run the calculation for the conditional randomized natural direct (CRDE) and the conditional randomized indirect effects (CRIE).</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="appendix_b.html#cb90-1" tabindex="-1"></a>true.cond.random.time.var <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">interaction =</span> <span class="cn">NULL</span>) {</span>
<span id="cb90-2"><a href="appendix_b.html#cb90-2" tabindex="-1"></a>  b <span class="ot">&lt;-</span> <span class="fu">param.causal.model.2</span>(<span class="at">A.M.interaction =</span> interaction)</span>
<span id="cb90-3"><a href="appendix_b.html#cb90-3" tabindex="-1"></a>  </span>
<span id="cb90-4"><a href="appendix_b.html#cb90-4" tabindex="-1"></a>  <span class="co"># binary outcome (death)</span></span>
<span id="cb90-5"><a href="appendix_b.html#cb90-5" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), </span>
<span id="cb90-6"><a href="appendix_b.html#cb90-6" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb90-7"><a href="appendix_b.html#cb90-7" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum.psi11&quot;</span>, <span class="st">&quot;sum.psi10&quot;</span>, </span>
<span id="cb90-8"><a href="appendix_b.html#cb90-8" tabindex="-1"></a>                      <span class="st">&quot;sum.psi00&quot;</span>)</span>
<span id="cb90-9"><a href="appendix_b.html#cb90-9" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb90-10"><a href="appendix_b.html#cb90-10" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi11&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span>                                           <span class="co"># A=1</span></span>
<span id="cb90-11"><a href="appendix_b.html#cb90-11" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-12"><a href="appendix_b.html#cb90-12" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-13"><a href="appendix_b.html#cb90-13" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb90-14"><a href="appendix_b.html#cb90-14" tabindex="-1"></a>                             b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-15"><a href="appendix_b.html#cb90-15" tabindex="-1"></a>                             b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-16"><a href="appendix_b.html#cb90-16" tabindex="-1"></a>                             b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb90-17"><a href="appendix_b.html#cb90-17" tabindex="-1"></a>      (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span>                                                             <span class="co"># A&#39;=1</span></span>
<span id="cb90-18"><a href="appendix_b.html#cb90-18" tabindex="-1"></a>           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-19"><a href="appendix_b.html#cb90-19" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-20"><a href="appendix_b.html#cb90-20" tabindex="-1"></a>           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-21"><a href="appendix_b.html#cb90-21" tabindex="-1"></a>           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-22"><a href="appendix_b.html#cb90-22" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-23"><a href="appendix_b.html#cb90-23" tabindex="-1"></a>                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-24"><a href="appendix_b.html#cb90-24" tabindex="-1"></a>                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-25"><a href="appendix_b.html#cb90-25" tabindex="-1"></a>                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-26"><a href="appendix_b.html#cb90-26" tabindex="-1"></a>                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> ) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-27"><a href="appendix_b.html#cb90-27" tabindex="-1"></a>      (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span>                                                            <span class="co"># A=1</span></span>
<span id="cb90-28"><a href="appendix_b.html#cb90-28" tabindex="-1"></a>           b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb90-29"><a href="appendix_b.html#cb90-29" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-30"><a href="appendix_b.html#cb90-30" tabindex="-1"></a>           b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-31"><a href="appendix_b.html#cb90-31" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-32"><a href="appendix_b.html#cb90-32" tabindex="-1"></a>                 b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb90-33"><a href="appendix_b.html#cb90-33" tabindex="-1"></a>                 b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-34"><a href="appendix_b.html#cb90-34" tabindex="-1"></a>                 b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-35"><a href="appendix_b.html#cb90-35" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb90-36"><a href="appendix_b.html#cb90-36" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb90-37"><a href="appendix_b.html#cb90-37" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb90-38"><a href="appendix_b.html#cb90-38" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb90-39"><a href="appendix_b.html#cb90-39" tabindex="-1"></a>    </span>
<span id="cb90-40"><a href="appendix_b.html#cb90-40" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi10&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span>                                           <span class="co"># A=1</span></span>
<span id="cb90-41"><a href="appendix_b.html#cb90-41" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-42"><a href="appendix_b.html#cb90-42" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-43"><a href="appendix_b.html#cb90-43" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb90-44"><a href="appendix_b.html#cb90-44" tabindex="-1"></a>                             b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-45"><a href="appendix_b.html#cb90-45" tabindex="-1"></a>                             b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-46"><a href="appendix_b.html#cb90-46" tabindex="-1"></a>                             b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb90-47"><a href="appendix_b.html#cb90-47" tabindex="-1"></a>      (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span>                                                             <span class="co"># A&#39;=0</span></span>
<span id="cb90-48"><a href="appendix_b.html#cb90-48" tabindex="-1"></a>           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-49"><a href="appendix_b.html#cb90-49" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-50"><a href="appendix_b.html#cb90-50" tabindex="-1"></a>           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-51"><a href="appendix_b.html#cb90-51" tabindex="-1"></a>           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-52"><a href="appendix_b.html#cb90-52" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-53"><a href="appendix_b.html#cb90-53" tabindex="-1"></a>                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-54"><a href="appendix_b.html#cb90-54" tabindex="-1"></a>                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-55"><a href="appendix_b.html#cb90-55" tabindex="-1"></a>                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-56"><a href="appendix_b.html#cb90-56" tabindex="-1"></a>                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> ) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-57"><a href="appendix_b.html#cb90-57" tabindex="-1"></a>      (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span>                                                            <span class="co"># A=1</span></span>
<span id="cb90-58"><a href="appendix_b.html#cb90-58" tabindex="-1"></a>           b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb90-59"><a href="appendix_b.html#cb90-59" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-60"><a href="appendix_b.html#cb90-60" tabindex="-1"></a>           b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-61"><a href="appendix_b.html#cb90-61" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-62"><a href="appendix_b.html#cb90-62" tabindex="-1"></a>                 b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb90-63"><a href="appendix_b.html#cb90-63" tabindex="-1"></a>                 b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-64"><a href="appendix_b.html#cb90-64" tabindex="-1"></a>                 b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-65"><a href="appendix_b.html#cb90-65" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb90-66"><a href="appendix_b.html#cb90-66" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb90-67"><a href="appendix_b.html#cb90-67" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb90-68"><a href="appendix_b.html#cb90-68" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb90-69"><a href="appendix_b.html#cb90-69" tabindex="-1"></a>    </span>
<span id="cb90-70"><a href="appendix_b.html#cb90-70" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi00&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;b_Y&quot;</span>] <span class="sc">+</span>                                           <span class="co"># A=0</span></span>
<span id="cb90-71"><a href="appendix_b.html#cb90-71" tabindex="-1"></a>                             b[<span class="st">&quot;b_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-72"><a href="appendix_b.html#cb90-72" tabindex="-1"></a>                             b[<span class="st">&quot;b_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-73"><a href="appendix_b.html#cb90-73" tabindex="-1"></a>                             b[<span class="st">&quot;b_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb90-74"><a href="appendix_b.html#cb90-74" tabindex="-1"></a>                             b[<span class="st">&quot;b_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-75"><a href="appendix_b.html#cb90-75" tabindex="-1"></a>                             b[<span class="st">&quot;b_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-76"><a href="appendix_b.html#cb90-76" tabindex="-1"></a>                             b[<span class="st">&quot;b_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb90-77"><a href="appendix_b.html#cb90-77" tabindex="-1"></a>      (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span>                                                             <span class="co"># A&#39;=0</span></span>
<span id="cb90-78"><a href="appendix_b.html#cb90-78" tabindex="-1"></a>           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-79"><a href="appendix_b.html#cb90-79" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-80"><a href="appendix_b.html#cb90-80" tabindex="-1"></a>           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-81"><a href="appendix_b.html#cb90-81" tabindex="-1"></a>           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-82"><a href="appendix_b.html#cb90-82" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-83"><a href="appendix_b.html#cb90-83" tabindex="-1"></a>                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-84"><a href="appendix_b.html#cb90-84" tabindex="-1"></a>                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-85"><a href="appendix_b.html#cb90-85" tabindex="-1"></a>                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-86"><a href="appendix_b.html#cb90-86" tabindex="-1"></a>                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> ) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-87"><a href="appendix_b.html#cb90-87" tabindex="-1"></a>      (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span>                                                            <span class="co"># A=0</span></span>
<span id="cb90-88"><a href="appendix_b.html#cb90-88" tabindex="-1"></a>           b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb90-89"><a href="appendix_b.html#cb90-89" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-90"><a href="appendix_b.html#cb90-90" tabindex="-1"></a>           b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-91"><a href="appendix_b.html#cb90-91" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-92"><a href="appendix_b.html#cb90-92" tabindex="-1"></a>                 b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb90-93"><a href="appendix_b.html#cb90-93" tabindex="-1"></a>                 b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-94"><a href="appendix_b.html#cb90-94" tabindex="-1"></a>                 b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-95"><a href="appendix_b.html#cb90-95" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb90-96"><a href="appendix_b.html#cb90-96" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb90-97"><a href="appendix_b.html#cb90-97" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb90-98"><a href="appendix_b.html#cb90-98" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>]))</span>
<span id="cb90-99"><a href="appendix_b.html#cb90-99" tabindex="-1"></a>    }</span>
<span id="cb90-100"><a href="appendix_b.html#cb90-100" tabindex="-1"></a>  </span>
<span id="cb90-101"><a href="appendix_b.html#cb90-101" tabindex="-1"></a>  crNDE.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi10&quot;</span>]) <span class="sc">-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi00&quot;</span>])</span>
<span id="cb90-102"><a href="appendix_b.html#cb90-102" tabindex="-1"></a>  crNIE.death <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi11&quot;</span>]) <span class="sc">-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi10&quot;</span>])</span>
<span id="cb90-103"><a href="appendix_b.html#cb90-103" tabindex="-1"></a>  </span>
<span id="cb90-104"><a href="appendix_b.html#cb90-104" tabindex="-1"></a>  <span class="co"># quantitative outcome (QoL)</span></span>
<span id="cb90-105"><a href="appendix_b.html#cb90-105" tabindex="-1"></a>  S <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">expand.grid</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), </span>
<span id="cb90-106"><a href="appendix_b.html#cb90-106" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>), <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="at">n=</span><span class="dv">2</span><span class="sc">^</span><span class="dv">4</span>))</span>
<span id="cb90-107"><a href="appendix_b.html#cb90-107" tabindex="-1"></a>  <span class="fu">colnames</span>(S) <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;male&quot;</span>,<span class="st">&quot;soc_env&quot;</span>,<span class="st">&quot;L1&quot;</span>,<span class="st">&quot;M&quot;</span>,<span class="st">&quot;sum.psi11&quot;</span>, <span class="st">&quot;sum.psi10&quot;</span>, </span>
<span id="cb90-108"><a href="appendix_b.html#cb90-108" tabindex="-1"></a>                      <span class="st">&quot;sum.psi00&quot;</span>)</span>
<span id="cb90-109"><a href="appendix_b.html#cb90-109" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>) {</span>
<span id="cb90-110"><a href="appendix_b.html#cb90-110" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi11&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span>                                          <span class="co"># A=1</span></span>
<span id="cb90-111"><a href="appendix_b.html#cb90-111" tabindex="-1"></a>                             b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-112"><a href="appendix_b.html#cb90-112" tabindex="-1"></a>                             b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-113"><a href="appendix_b.html#cb90-113" tabindex="-1"></a>                             b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb90-114"><a href="appendix_b.html#cb90-114" tabindex="-1"></a>                             b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-115"><a href="appendix_b.html#cb90-115" tabindex="-1"></a>                             b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-116"><a href="appendix_b.html#cb90-116" tabindex="-1"></a>                             b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb90-117"><a href="appendix_b.html#cb90-117" tabindex="-1"></a>      (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span>                                                             <span class="co"># A&#39;=1</span></span>
<span id="cb90-118"><a href="appendix_b.html#cb90-118" tabindex="-1"></a>           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-119"><a href="appendix_b.html#cb90-119" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-120"><a href="appendix_b.html#cb90-120" tabindex="-1"></a>           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-121"><a href="appendix_b.html#cb90-121" tabindex="-1"></a>           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-122"><a href="appendix_b.html#cb90-122" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-123"><a href="appendix_b.html#cb90-123" tabindex="-1"></a>                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-124"><a href="appendix_b.html#cb90-124" tabindex="-1"></a>                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-125"><a href="appendix_b.html#cb90-125" tabindex="-1"></a>                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-126"><a href="appendix_b.html#cb90-126" tabindex="-1"></a>                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> ) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-127"><a href="appendix_b.html#cb90-127" tabindex="-1"></a>      (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span>                                                            <span class="co"># A=1</span></span>
<span id="cb90-128"><a href="appendix_b.html#cb90-128" tabindex="-1"></a>           b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb90-129"><a href="appendix_b.html#cb90-129" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-130"><a href="appendix_b.html#cb90-130" tabindex="-1"></a>           b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-131"><a href="appendix_b.html#cb90-131" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-132"><a href="appendix_b.html#cb90-132" tabindex="-1"></a>                 b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb90-133"><a href="appendix_b.html#cb90-133" tabindex="-1"></a>                 b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-134"><a href="appendix_b.html#cb90-134" tabindex="-1"></a>                 b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-135"><a href="appendix_b.html#cb90-135" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb90-136"><a href="appendix_b.html#cb90-136" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb90-137"><a href="appendix_b.html#cb90-137" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb90-138"><a href="appendix_b.html#cb90-138" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb90-139"><a href="appendix_b.html#cb90-139" tabindex="-1"></a>    </span>
<span id="cb90-140"><a href="appendix_b.html#cb90-140" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi10&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span>                                          <span class="co"># A=1</span></span>
<span id="cb90-141"><a href="appendix_b.html#cb90-141" tabindex="-1"></a>                             b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-142"><a href="appendix_b.html#cb90-142" tabindex="-1"></a>                             b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-143"><a href="appendix_b.html#cb90-143" tabindex="-1"></a>                             b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">+</span> </span>
<span id="cb90-144"><a href="appendix_b.html#cb90-144" tabindex="-1"></a>                             b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-145"><a href="appendix_b.html#cb90-145" tabindex="-1"></a>                             b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-146"><a href="appendix_b.html#cb90-146" tabindex="-1"></a>                             b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">1</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb90-147"><a href="appendix_b.html#cb90-147" tabindex="-1"></a>      (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span>                                                             <span class="co"># A&#39;=0</span></span>
<span id="cb90-148"><a href="appendix_b.html#cb90-148" tabindex="-1"></a>           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-149"><a href="appendix_b.html#cb90-149" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-150"><a href="appendix_b.html#cb90-150" tabindex="-1"></a>           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-151"><a href="appendix_b.html#cb90-151" tabindex="-1"></a>           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-152"><a href="appendix_b.html#cb90-152" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-153"><a href="appendix_b.html#cb90-153" tabindex="-1"></a>                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-154"><a href="appendix_b.html#cb90-154" tabindex="-1"></a>                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-155"><a href="appendix_b.html#cb90-155" tabindex="-1"></a>                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-156"><a href="appendix_b.html#cb90-156" tabindex="-1"></a>                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> ) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-157"><a href="appendix_b.html#cb90-157" tabindex="-1"></a>      (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span>                                                            <span class="co"># A=1</span></span>
<span id="cb90-158"><a href="appendix_b.html#cb90-158" tabindex="-1"></a>           b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb90-159"><a href="appendix_b.html#cb90-159" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-160"><a href="appendix_b.html#cb90-160" tabindex="-1"></a>           b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-161"><a href="appendix_b.html#cb90-161" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-162"><a href="appendix_b.html#cb90-162" tabindex="-1"></a>                 b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb90-163"><a href="appendix_b.html#cb90-163" tabindex="-1"></a>                 b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-164"><a href="appendix_b.html#cb90-164" tabindex="-1"></a>                 b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">1</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-165"><a href="appendix_b.html#cb90-165" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb90-166"><a href="appendix_b.html#cb90-166" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb90-167"><a href="appendix_b.html#cb90-167" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb90-168"><a href="appendix_b.html#cb90-168" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb90-169"><a href="appendix_b.html#cb90-169" tabindex="-1"></a>    </span>
<span id="cb90-170"><a href="appendix_b.html#cb90-170" tabindex="-1"></a>    S[n,<span class="st">&quot;sum.psi00&quot;</span>] <span class="ot">&lt;-</span>  ( b[<span class="st">&quot;mu_Y&quot;</span>] <span class="sc">+</span>                                          <span class="co"># A=0</span></span>
<span id="cb90-171"><a href="appendix_b.html#cb90-171" tabindex="-1"></a>                             b[<span class="st">&quot;c_male_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-172"><a href="appendix_b.html#cb90-172" tabindex="-1"></a>                             b[<span class="st">&quot;c_soc_env_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-173"><a href="appendix_b.html#cb90-173" tabindex="-1"></a>                             b[<span class="st">&quot;c_A_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> </span>
<span id="cb90-174"><a href="appendix_b.html#cb90-174" tabindex="-1"></a>                             b[<span class="st">&quot;c_L1_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-175"><a href="appendix_b.html#cb90-175" tabindex="-1"></a>                             b[<span class="st">&quot;c_M_Y&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-176"><a href="appendix_b.html#cb90-176" tabindex="-1"></a>                             b[<span class="st">&quot;c_AM_Y&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> <span class="sc">*</span> S[n,<span class="st">&quot;M&quot;</span>] <span class="sc">*</span> b[<span class="st">&quot;A.M.inter&quot;</span>] ) <span class="sc">*</span></span>
<span id="cb90-177"><a href="appendix_b.html#cb90-177" tabindex="-1"></a>      (( b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span>                                                             <span class="co"># A&#39;=0</span></span>
<span id="cb90-178"><a href="appendix_b.html#cb90-178" tabindex="-1"></a>           b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-179"><a href="appendix_b.html#cb90-179" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-180"><a href="appendix_b.html#cb90-180" tabindex="-1"></a>           b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-181"><a href="appendix_b.html#cb90-181" tabindex="-1"></a>           b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> )<span class="sc">^</span>( S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-182"><a href="appendix_b.html#cb90-182" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> (b[<span class="st">&quot;b_M&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-183"><a href="appendix_b.html#cb90-183" tabindex="-1"></a>                b[<span class="st">&quot;b_male_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-184"><a href="appendix_b.html#cb90-184" tabindex="-1"></a>                b[<span class="st">&quot;b_soc_env_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span> </span>
<span id="cb90-185"><a href="appendix_b.html#cb90-185" tabindex="-1"></a>                b[<span class="st">&quot;b_L1_M&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-186"><a href="appendix_b.html#cb90-186" tabindex="-1"></a>                b[<span class="st">&quot;b_A_M&quot;</span>] <span class="sc">*</span> <span class="dv">0</span> ) )<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;M&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-187"><a href="appendix_b.html#cb90-187" tabindex="-1"></a>      (( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span>                                                            <span class="co"># A=0</span></span>
<span id="cb90-188"><a href="appendix_b.html#cb90-188" tabindex="-1"></a>           b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb90-189"><a href="appendix_b.html#cb90-189" tabindex="-1"></a>           b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-190"><a href="appendix_b.html#cb90-190" tabindex="-1"></a>           b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>)<span class="sc">^</span>( S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-191"><a href="appendix_b.html#cb90-191" tabindex="-1"></a>      (( <span class="dv">1</span> <span class="sc">-</span> ( b[<span class="st">&quot;b_L1&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-192"><a href="appendix_b.html#cb90-192" tabindex="-1"></a>                 b[<span class="st">&quot;b_male_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;male&quot;</span>] <span class="sc">+</span>  </span>
<span id="cb90-193"><a href="appendix_b.html#cb90-193" tabindex="-1"></a>                 b[<span class="st">&quot;b_soc_env_L1&quot;</span>] <span class="sc">*</span> S[n,<span class="st">&quot;soc_env&quot;</span>] <span class="sc">+</span></span>
<span id="cb90-194"><a href="appendix_b.html#cb90-194" tabindex="-1"></a>                 b[<span class="st">&quot;b_A_L1&quot;</span>] <span class="sc">*</span> <span class="dv">0</span>))<span class="sc">^</span>( <span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;L1&quot;</span>] )) <span class="sc">*</span></span>
<span id="cb90-195"><a href="appendix_b.html#cb90-195" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb90-196"><a href="appendix_b.html#cb90-196" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_male&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;male&quot;</span>])) <span class="sc">*</span> </span>
<span id="cb90-197"><a href="appendix_b.html#cb90-197" tabindex="-1"></a>      ((b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(S[n,<span class="st">&quot;soc_env&quot;</span>])) <span class="sc">*</span></span>
<span id="cb90-198"><a href="appendix_b.html#cb90-198" tabindex="-1"></a>      ((<span class="dv">1</span> <span class="sc">-</span> b[<span class="st">&quot;p_L0_soc_env&quot;</span>])<span class="sc">^</span>(<span class="dv">1</span> <span class="sc">-</span> S[n,<span class="st">&quot;soc_env&quot;</span>])) </span>
<span id="cb90-199"><a href="appendix_b.html#cb90-199" tabindex="-1"></a>    }</span>
<span id="cb90-200"><a href="appendix_b.html#cb90-200" tabindex="-1"></a>  </span>
<span id="cb90-201"><a href="appendix_b.html#cb90-201" tabindex="-1"></a>  crNDE.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi10&quot;</span>]) <span class="sc">-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi00&quot;</span>])</span>
<span id="cb90-202"><a href="appendix_b.html#cb90-202" tabindex="-1"></a>  crNIE.qol <span class="ot">&lt;-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi11&quot;</span>]) <span class="sc">-</span> <span class="fu">sum</span>(S[,<span class="st">&quot;sum.psi10&quot;</span>])</span>
<span id="cb90-203"><a href="appendix_b.html#cb90-203" tabindex="-1"></a>  </span>
<span id="cb90-204"><a href="appendix_b.html#cb90-204" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">crNDE.death =</span> crNDE.death, <span class="at">crNIE.death =</span> crNIE.death, </span>
<span id="cb90-205"><a href="appendix_b.html#cb90-205" tabindex="-1"></a>              <span class="at">crNDE.qol =</span> crNDE.qol, <span class="at">crNIE.qol =</span> crNIE.qol))</span>
<span id="cb90-206"><a href="appendix_b.html#cb90-206" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="appendix_b.html#cb91-1" tabindex="-1"></a>true.cond.random2.no.inter <span class="ot">&lt;-</span> <span class="fu">true.cond.random.time.var</span>(<span class="at">interaction =</span> <span class="dv">0</span>)</span>
<span id="cb91-2"><a href="appendix_b.html#cb91-2" tabindex="-1"></a></span>
<span id="cb91-3"><a href="appendix_b.html#cb91-3" tabindex="-1"></a>true.cond.random2.with.inter <span class="ot">&lt;-</span> <span class="fu">true.cond.random.time.var</span>(<span class="at">interaction =</span> <span class="dv">1</span>)</span></code></pre></div>
<p>The conditional randomized direct effect <span class="math inline">\(\text{CRDE}=\mathbb{E}\left(Y_{1,\Gamma_{0\mid L(0),L(1)}}\right) - \mathbb{E}\left(Y_{0,\Gamma_{0\mid L(0),L(1)}}\right)\)</span> and conditional randomized indirect effect <span class="math inline">\(\text{CRIE}=\mathbb{E}\left(Y_{1,\Gamma_{1\mid L(0),L(1)}}\right) - \mathbb{E}\left(Y_{1,\Gamma_{0\mid L(0),L(1)}}\right)\)</span> are respectively:</p>
<ul>
<li>0.0672 and 0.008 for death without interaction,</li>
<li>0.078282 and 0.011 for death with interaction,</li>
<li>-5.36 and -0.9 for quality of life without interaction,</li>
<li>-7.207 and -1.4 for quality of life with interaction.</li>
</ul>
<table>
<caption>True values with time varying confounders</caption>
<colgroup>
<col width="22%" />
<col width="40%" />
<col width="37%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Effects</th>
<th align="center">Without <span class="math inline">\(A*M\)</span> interaction</th>
<th align="center">with <span class="math inline">\(A*M\)</span> interaction</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><strong>Binary outcome</strong></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">Average total effect (ATE)</td>
<td align="center">0.0752</td>
<td align="center">0.089282</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">Controlled direct effect (CDE)</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">- CDE, setting do(M=0)</td>
<td align="center">0.064</td>
<td align="center">0.064</td>
</tr>
<tr class="even">
<td align="left">- CDE, setting do(M=1)</td>
<td align="center">0.064</td>
<td align="center">0.094</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">Marginal randomized</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">- marginal rNDE</td>
<td align="center">0.064</td>
<td align="center">0.073882</td>
</tr>
<tr class="even">
<td align="left">- marginal rNIE</td>
<td align="center">0.0112</td>
<td align="center">0.0154</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">Conditional randomized</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">- conditional rNDE</td>
<td align="center">0.0672</td>
<td align="center">0.078282</td>
</tr>
<tr class="even">
<td align="left">- conditional rNIE</td>
<td align="center">0.008</td>
<td align="center">0.011</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left"><strong>Quantitative outcome</strong></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">Average total effect (ATE)</td>
<td align="center">-6.26</td>
<td align="center">-8.607</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">Controlled direct effect (CDE)</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">- CDE, setting do(M=0)</td>
<td align="center">-5</td>
<td align="center">-5</td>
</tr>
<tr class="odd">
<td align="left">- CDE, setting do(M=1)</td>
<td align="center">-5</td>
<td align="center">-10</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">Marginal randomized</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">- marginal rNDE</td>
<td align="center">-5</td>
<td align="center">-6.647</td>
</tr>
<tr class="odd">
<td align="left">- marginal rNIE</td>
<td align="center">-1.26</td>
<td align="center">-1.96</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">Conditional randomized</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">- conditional rNDE</td>
<td align="center">-5.36</td>
<td align="center">-7.207</td>
</tr>
<tr class="odd">
<td align="left">- conditional rNIE</td>
<td align="center">-0.9</td>
<td align="center">-1.4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="appendix_a.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/benoitlepage/mediation_workshop/08-appendixB.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
